/*! For license information please see 308.389dab6a.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[308],{"./src/aspects/Conference/Manage/DashboardPage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Y:()=>DashboardPage});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js");var chakra_ui_color_mode_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),useTitle=__webpack_require__("./src/aspects/Hooks/useTitle.tsx"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx"),chakra_ui_breadcrumb_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+breadcrumb@1.3.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/breadcrumb/dist/chakra-ui-breadcrumb.esm.js")),react_router_dom=__webpack_require__("../node_modules/.pnpm/react-router-dom@5.3.0_react@17.0.2/node_modules/react-router-dom/esm/react-router-dom.js"),es=__webpack_require__("../node_modules/.pnpm/use-react-router-breadcrumbs@2.0.2_react-router@5.2.1+react@17.0.2/node_modules/use-react-router-breadcrumbs/dist/es/index.js"),AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function Breadcrumbs(){var conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,confTitle=(0,react.useMemo)((function(){var _ref,_conference$subconfer;return null!==(_ref=subconferenceId?null===(_conference$subconfer=conference.subconferences.find((function(x){return x.id===subconferenceId})))||void 0===_conference$subconfer?void 0:_conference$subconfer.shortName:void 0)&&void 0!==_ref?_ref:conference.shortName}),[conference.shortName,conference.subconferences,subconferenceId]),routes=(0,react.useMemo)((function(){return[{path:"/conference/:slug/manage",breadcrumb:"Manage "+confTitle},{path:"/c/:slug/manage",breadcrumb:"Manage "+confTitle},{path:"/conference/:slug/manage/export/youtube",breadcrumb:"YouTube"},{path:"/c/:slug/manage/export/youtube",breadcrumb:"YouTube"},{path:"/conference/:slug/manage/export/download-videos",breadcrumb:"Download videos"},{path:"/c/:slug/manage/export/download-videos",breadcrumb:"Download videos"}]}),[confTitle]),breadcrumbs=(0,es.Z)(routes,{excludePaths:["/","/conference","/c","/conference/:slug","/c/:slug"]});return(0,jsx_runtime.jsx)(chakra_ui_breadcrumb_esm.aG,{separator:">",children:breadcrumbs.map((function(breadcrumb){return(0,jsx_runtime.jsx)(chakra_ui_breadcrumb_esm.gN,{isCurrentPage:breadcrumb.key===breadcrumb.location.key,children:(0,jsx_runtime.jsx)(chakra_ui_breadcrumb_esm.At,{as:react_router_dom.rU,to:breadcrumb.key,children:breadcrumb.breadcrumb})},breadcrumb.key)}))})}function DashboardHeaderControls(_ref){var children=_ref.children;return children?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Ug,{spacing:4,mb:4,children}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}Breadcrumbs.displayName="Breadcrumbs";try{DashboardHeaderControls.displayName="DashboardHeaderControls",DashboardHeaderControls.__docgenInfo={description:"",displayName:"DashboardHeaderControls",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/DashboardHeaderControls.tsx#DashboardHeaderControls"]={docgenInfo:DashboardHeaderControls.__docgenInfo,name:"DashboardHeaderControls",path:"src/aspects/Conference/Manage/DashboardHeaderControls.tsx#DashboardHeaderControls"})}catch(__react_docgen_typescript_loader_error){}var SubconferenceSelector=__webpack_require__("./src/aspects/Conference/Manage/Subconferences/SubconferenceSelector.tsx");function DashboardPage(_ref){var title=_ref.title,children=_ref.children,controls=_ref.controls,_ref$stickyHeader=_ref.stickyHeader,stickyHeader=void 0===_ref$stickyHeader||_ref$stickyHeader,_ref$autoOverflow=_ref.autoOverflow,autoOverflow=void 0===_ref$autoOverflow||_ref$autoOverflow,conference=(0,useConference.fk)(),grayBg=(0,chakra_ui_color_mode_esm.ff)("gray.50","gray.900"),grayBorder=(0,chakra_ui_color_mode_esm.ff)("gray.300","gray.600"),titleEl=(0,useTitle.Z)(title.includes(conference.shortName)?title:title+" - "+conference.shortName);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{flexDir:"column",w:{base:"100%",xl:"80%"},px:[2,2,4],children:[titleEl,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{position:stickyHeader?"sticky":void 0,top:0,left:0,zIndex:1e5,bgColor:grayBg,pt:4,borderBottom:"1px solid",borderBottomColor:grayBorder,children:[(0,jsx_runtime.jsx)(Breadcrumbs,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{id:"page-heading",as:"h1",size:"xl",textAlign:"left",mt:4,mb:4,children:title}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.LZ,{}),(0,jsx_runtime.jsx)(SubconferenceSelector.B,{})]}),(0,jsx_runtime.jsx)(DashboardHeaderControls,{children:controls})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{flexDir:"column",mt:4,w:"100%",overflow:autoOverflow?"auto":void 0,children})]})}DashboardPage.displayName="DashboardPage";try{DashboardPage.displayName="DashboardPage",DashboardPage.__docgenInfo={description:"",displayName:"DashboardPage",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},stickyHeader:{defaultValue:{value:"true"},description:"",name:"stickyHeader",required:!1,type:{name:"boolean"}},autoOverflow:{defaultValue:{value:"true"},description:"",name:"autoOverflow",required:!1,type:{name:"boolean"}},controls:{defaultValue:null,description:"",name:"controls",required:!1,type:{name:"ReactChild[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/DashboardPage.tsx#DashboardPage"]={docgenInfo:DashboardPage.__docgenInfo,name:"DashboardPage",path:"src/aspects/Conference/Manage/DashboardPage.tsx#DashboardPage"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/Conference/Manage/Registrants/ManageRegistrants.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ManageRegistrants});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.unscopables.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-iso-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.values.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.some.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.starts-with.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.ends-with.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.split.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.promise.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.pad-start.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.url.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js");var _templateObject,chakra_ui_icons_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+icons@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icons/dist/chakra-ui-icons.esm.js"),chakra_ui_form_control_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+form-control@1.5.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/form-control/dist/chakra-ui-form-control.esm.js"),chakra_ui_button_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js"),chakra_ui_hooks_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+hooks@1.8.2_react@17.0.2/node_modules/@chakra-ui/hooks/dist/chakra-ui-hooks.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),chakra_ui_input_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+input@1.4.1_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/input/dist/chakra-ui-input.esm.js"),chakra_ui_tooltip_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tooltip@1.4.6_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/tooltip/dist/chakra-ui-tooltip.esm.js"),chakra_ui_select_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+select@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/select/dist/chakra-ui-select.esm.js"),chakra_ui_toast_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+toast@1.5.4_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/toast/dist/chakra-ui-toast.esm.js"),chakra_ui_menu_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+menu@1.8.6_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/menu/dist/chakra-ui-menu.esm.js"),esm=__webpack_require__("../packages/shared/assert/build/esm/index.js"),auth=__webpack_require__("../packages/shared/shared-types/build/esm/auth.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),papaparse_min=__webpack_require__("../node_modules/.pnpm/papaparse@5.3.1/node_modules/papaparse/papaparse.min.js"),papaparse_min_default=__webpack_require__.n(papaparse_min),es=__webpack_require__("../node_modules/.pnpm/ramda@0.28.0/node_modules/ramda/es/index.js"),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),urql_es=__webpack_require__("../node_modules/.pnpm/urql@2.1.3_graphql@15.7.2+react@17.0.2/node_modules/urql/dist/urql.es.js"),v4=__webpack_require__("../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/v4.js"),graphql=__webpack_require__("./src/generated/graphql.tsx"),FAIcon=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx"),LinkButton=__webpack_require__("./src/aspects/Chakra/LinkButton.tsx"),MultiSelect=__webpack_require__("./src/aspects/Chakra/MultiSelect.tsx"),CRUDComponents=__webpack_require__("./src/aspects/CRUDTable2/CRUDComponents.tsx"),CRUDTable2=__webpack_require__("./src/aspects/CRUDTable2/CRUDTable2.tsx"),AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),ExtractActualError=__webpack_require__("./src/aspects/GQL/ExtractActualError.ts"),make_context=__webpack_require__("./src/aspects/GQL/make-context.ts"),useQueryErrorToast=__webpack_require__("./src/aspects/GQL/useQueryErrorToast.tsx"),maybeCompare=__webpack_require__("./src/aspects/Utils/maybeCompare.tsx"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx"),DashboardPage=__webpack_require__("./src/aspects/Conference/Manage/DashboardPage.tsx"),chakra_ui_modal_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+modal@1.10.7_d24435ba52f1f88b08cc54a1f1d4e56f/node_modules/@chakra-ui/modal/dist/chakra-ui-modal.esm.js"),chakra_ui_tabs_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tabs@1.6.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/tabs/dist/chakra-ui-tabs.esm.js"),chakra_ui_textarea_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+textarea@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/textarea/dist/chakra-ui-textarea.esm.js"),index_esm=__webpack_require__("../node_modules/.pnpm/react-hook-form@7.29.0_react@17.0.2/node_modules/react-hook-form/dist/index.esm.mjs"),Markdown=__webpack_require__("./src/aspects/Chakra/Markdown.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendEmailModal(_ref){var _errors$subject,_errors$subject2,_errors$subject3,_errors$markdownBody,_errors$markdownBody2,_errors$subject4,isOpen=_ref.isOpen,onClose=_ref.onClose,registrants=_ref.registrants,send=_ref.send,conference=(0,useConference.fk)(),toast=(0,chakra_ui_toast_esm.pm)(),_useForm=(0,index_esm.cI)({defaultValues:{subject:conference.shortName+": Update",markdownBody:"Dear registrant,\n\nWe hope you enjoy "+conference.shortName+".\n\n\nYours sincerely,\n\nThe "+conference.shortName+" organisers"},mode:"onTouched"}),_useForm$formState=_useForm.formState,errors=_useForm$formState.errors,touchedFields=_useForm$formState.touchedFields,isSubmitting=_useForm$formState.isSubmitting,isValid=_useForm$formState.isValid,handleSubmit=_useForm.handleSubmit,register=_useForm.register,reset=_useForm.reset,watch=_useForm.watch,recipientsEl=(0,react.useMemo)((function(){return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{mt:4,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h3",textAlign:"left",size:"md",mb:2,children:"Recipients"}),0===registrants.length?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"No registrants selected."}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.aV,{spacing:2,maxH:"20vh",overflowY:"auto",children:registrants.map((function(registrant){return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:registrant.displayName})},registrant.id)}))})]})}),[registrants]),onSubmit=(0,react.useCallback)(function(){var _ref2=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(data){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,send(registrants.map((function(x){return x.id})),data.markdownBody,data.subject);case 3:onClose(),reset(),toast({status:"success",title:"Sent emails",description:"Successfully sent "+registrants.length+" "+(1===registrants.length?"email":"emails")+"."}),_context.next=12;break;case 8:_context.prev=8,_context.t0=_context.catch(0),console.error("Could not send custom emails",{err:_context.t0}),toast({status:"error",title:"Could not send emails",description:_context.t0.message});case 12:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function(_x){return _ref2.apply(this,arguments)}}(),[onClose,registrants,reset,send,toast]);return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen,onClose,size:"lg",children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsx)("form",{onSubmit:handleSubmit(onSubmit),children:(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{children:"Send custom email"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ol,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.fe,{children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{isInvalid:Boolean(errors.subject)&&Boolean(touchedFields.subject),isRequired:!0,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{mt:2,children:"Subject line"}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:"The subject line of the email."}),(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{mt:2,children:[(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,Object.assign({},register("subject",{required:!0,minLength:5}))),(0,jsx_runtime.jsx)(chakra_ui_input_esm.xH,{children:(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Xg,{})})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.J1,{children:["required"===(null===(_errors$subject=errors.subject)||void 0===_errors$subject?void 0:_errors$subject.type)&&"You must enter a subject line."," ","minLength"===(null===(_errors$subject2=errors.subject)||void 0===_errors$subject2?void 0:_errors$subject2.type)&&"Subject line must be at least 5 characters."," ",null===(_errors$subject3=errors.subject)||void 0===_errors$subject3?void 0:_errors$subject3.message]})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{isInvalid:Boolean(errors.markdownBody)&&Boolean(touchedFields.markdownBody),isRequired:!0,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{mt:2,children:"Email body"}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.Q6,{children:["You can use Markdown formatting in your email body."," ",(0,jsx_runtime.jsx)(chakra_ui_layout_esm.rU,{isExternal:!0,href:"https://www.markdowntutorial.com/",children:"Learn more"}),"."]}),(0,jsx_runtime.jsxs)(chakra_ui_tabs_esm.mQ,{size:"sm",variant:"enclosed",mt:2,children:[(0,jsx_runtime.jsxs)(chakra_ui_tabs_esm.td,{children:[(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.OK,{children:"Edit"}),(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.OK,{children:"Preview"})]}),(0,jsx_runtime.jsxs)(chakra_ui_tabs_esm.nP,{children:[(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.x4,{children:(0,jsx_runtime.jsx)(chakra_ui_textarea_esm.g,Object.assign({fontFamily:"monospace",lineHeight:"lg",minH:"xs"},register("markdownBody",{required:!0,maxLength:1e4}),{mt:2}))}),(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.x4,{children:(0,jsx_runtime.jsx)(Markdown.U,{children:watch("markdownBody")})})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.J1,{children:["required"===(null===(_errors$markdownBody=errors.markdownBody)||void 0===_errors$markdownBody?void 0:_errors$markdownBody.type)&&"You must write an email!"," ","maxLength"===(null===(_errors$markdownBody2=errors.markdownBody)||void 0===_errors$markdownBody2?void 0:_errors$markdownBody2.type)&&"Email body cannot exceed 10000 characters."," ",null===(_errors$subject4=errors.subject)||void 0===_errors$subject4?void 0:_errors$subject4.message]})]}),recipientsEl]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{type:"submit",isLoading:isSubmitting,isDisabled:!isValid||0===registrants.length,mt:4,colorScheme:"purple",children:["Send ",registrants.length," ",1===registrants.length?"email":"emails"]})})]})})]})}SendEmailModal.displayName="SendEmailModal";try{SendEmailModal.displayName="SendEmailModal",SendEmailModal.__docgenInfo={description:"",displayName:"SendEmailModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},registrants:{defaultValue:null,description:"",name:"registrants",required:!0,type:{name:"RegistrantPartsFragment[]"}},send:{defaultValue:null,description:"",name:"send",required:!0,type:{name:"(_registrantIds: string[], htmlBody: string, subject: string) => Promise<void>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Registrants/SendEmailModal.tsx#SendEmailModal"]={docgenInfo:SendEmailModal.__docgenInfo,name:"SendEmailModal",path:"src/aspects/Conference/Manage/Registrants/SendEmailModal.tsx#SendEmailModal"})}catch(__react_docgen_typescript_loader_error){}function ManageRegistrants_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ManageRegistrants_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ManageRegistrants_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ManageRegistrants_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ManageRegistrants(){var _extractActualError,_ref30,_ref31,_insertRegistrantResp,conference=(0,useConference.fk)(),_useAuthParameters=(0,AuthParameters.h)(),conferencePath=_useAuthParameters.conferencePath,subconferenceId=_useAuthParameters.subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext),["registrant_Group","conference_Subconference"])}),[subconferenceId]),_useSelectAllGroupsQu3=_slicedToArray((0,graphql.fkY)({requestPolicy:"network-only",variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0}},context}),1)[0],loadingAllGroups=_useSelectAllGroupsQu3.fetching,errorAllGroups=_useSelectAllGroupsQu3.error,allGroups=_useSelectAllGroupsQu3.data;(0,useQueryErrorToast.Z)(errorAllGroups,!1);var selectAllRegistrantsContext=(0,react.useMemo)((function(){var _makeContext2;return(0,make_context.f)(((_makeContext2={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext2),["registrant_Invitation","registrant_GroupRegistrant","registrant_SubconferenceMembership"])}),[subconferenceId]),_useSelectAllRegistra2=_slicedToArray((0,graphql.a5H)({requestPolicy:"network-only",variables:{conferenceId:conference.id},context:selectAllRegistrantsContext}),2),_useSelectAllRegistra3=_useSelectAllRegistra2[0],loadingAllRegistrants=_useSelectAllRegistra3.fetching,errorAllRegistrants=_useSelectAllRegistra3.error,allRegistrants=_useSelectAllRegistra3.data,refetchAllRegistrants=_useSelectAllRegistra2[1];(0,useQueryErrorToast.Z)(errorAllRegistrants,!1);var data=(0,react.useMemo)((function(){var _allRegistrants$regis;return _toConsumableArray(null!==(_allRegistrants$regis=null==allRegistrants?void 0:allRegistrants.registrant_Registrant)&&void 0!==_allRegistrants$regis?_allRegistrants$regis:[])}),[null==allRegistrants?void 0:allRegistrants.registrant_Registrant]),_useInsertRegistrantM2=_slicedToArray((0,graphql.b8d)(),2),insertRegistrantResponse=_useInsertRegistrantM2[0],insertRegistrant=_useInsertRegistrantM2[1],_useInsertRegistrantW2=_slicedToArray((0,graphql.yUr)(),2),insertRegistrantWithoutInviteResponse=_useInsertRegistrantW2[0],insertRegistrantWithoutInvite=_useInsertRegistrantW2[1],_useDeleteRegistrants2=_slicedToArray((0,graphql.j1$)(),2),deleteRegistrantsResponse=_useDeleteRegistrants2[0],deleteRegistrants=_useDeleteRegistrants2[1],_useUpdateRegistrantM2=_slicedToArray((0,graphql.nUg)(),2),updateRegistrantResponse=_useUpdateRegistrantM2[0],updateRegistrant=_useUpdateRegistrantM2[1],row=(0,react.useMemo)((function(){return{getKey:function getKey(record){return record.id},canSelect:function canSelect(_record){return!0},pages:{defaultToLast:!1},invalid:function invalid(record){var _record$displayName;return(null===(_record$displayName=record.displayName)||void 0===_record$displayName||!_record$displayName.length)&&{columnId:"name",reason:"Display name required"}}}}),[]),inviteStatusFilterOptions=(0,react.useMemo)((function(){return[{label:"Unsent",value:"unsent"},{label:"Sending",value:"processed"},{label:"Sent",value:"delivered"},{label:"Error",value:"error"}]}),[]),roleOptions=(0,react.useMemo)((function(){return Object.keys(graphql.OiL).map((function(x){var v=graphql.OiL[x];return{value:v,label:(0,CRUDComponents.oL)(v)}})).sort((function(x,y){return x.label.localeCompare(y.label)}))}),[]),columns=(0,react.useMemo)((function(){var _allGroups$registrant,_allRegistrants$confe,groupOptions=null!==(_allGroups$registrant=null==allGroups?void 0:allGroups.registrant_Group.map((function(group){return{value:group.id,label:group.name}})))&&void 0!==_allGroups$registrant?_allGroups$registrant:[],subconferenceOptions=null!==(_allRegistrants$confe=null==allRegistrants?void 0:allRegistrants.conference_Subconference.flatMap((function(group){return[{value:group.id+"¬"+graphql.OiL.Organizer,label:group.shortName+" (Organizer)"},{value:group.id+"¬"+graphql.OiL.Attendee,label:group.shortName+" (Attendee)"}]})))&&void 0!==_allRegistrants$confe?_allRegistrants$confe:[],result=[{id:"name",defaultSortDirection:CRUDTable2.S.Asc,header:function NameHeader(_ref){var isInCreate=_ref.isInCreate,onClick=_ref.onClick,sortDir=_ref.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Name"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Name",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return data.displayName},set:function set(record,value){record.displayName=value},sort:function sort(x,y){return x.localeCompare(y)},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){var _row$displayName;return""===(null!==(_row$displayName=row.displayName)&&void 0!==_row$displayName?_row$displayName:"")})):rows.filter((function(row){return row.displayName.toLowerCase().includes(filterValue.toLowerCase())}))},filterEl:CRUDComponents.Oe,cell:function NameCell(_ref2){var value=_ref2.value,_onChange=_ref2.onChange,onBlur=_ref2.onBlur,ref=_ref2.ref,_useClipboard=(0,chakra_ui_hooks_esm.VP)(null!=value?value:""),onCopy=_useClipboard.onCopy,hasCopied=_useClipboard.hasCopied;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{alignItems:"center",children:[(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!=value?value:"",onChange:function onChange(ev){return null==_onChange?void 0:_onChange(ev.target.value)},onBlur,border:"1px solid",borderColor:"rgba(255, 255, 255, 0.16)",ref,mr:2}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onCopy,size:"xs",ml:"auto",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:hasCopied?"check-circle":"clipboard"})})]})}},{id:"invitationStatus",header:function NameHeader(_ref3){var isInCreate=_ref3.isInCreate,onClick=_ref3.onClick,sortDir=_ref3.sortDir;return isInCreate?void 0:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Invite status",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return data.invitationStatus?data.invitationStatus:void 0},sort:function sort(x,y){return(0,maybeCompare.D)(null==x?void 0:x.status,null==y?void 0:y.status,(function(a,b){return a.localeCompare(b)}))},filterFn:function filterFn(rows,filterValue){return rows.filter((function(row){var _row$invitationStatus,status=null===(_row$invitationStatus=row.invitationStatus)||void 0===_row$invitationStatus?void 0:_row$invitationStatus.status;return(status=void 0===status?"unsent":"processing"===status||"processed"===status?"processed":"delivered"===status?"delivered":"error")===filterValue}))},filterEl:(0,CRUDComponents.fD)(inviteStatusFilterOptions),cell:function InvitationStatusCell(_ref4){var isInCreate=_ref4.isInCreate,value=_ref4.value;return isInCreate?void 0:value?"processing"===value.status||"processed"===value.status?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Sending in progress",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"paper-plane"})})}):"blocked"===value.status||"bounce"===value.status||"deferred"===value.status||"dropped"===value.status?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Error sending invitation email! Reason: "+value.status+"."+(value.errorMessage?" Message from server: "+value.errorMessage:""),children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"exclamation-circle"})})}):"delivered"===value.status?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Sent",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"check"})})}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Unrecognised status",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"bug"})})}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Unsent",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"times"})})})}},{id:"inviteAccepted",header:function NameHeader(_ref5){var isInCreate=_ref5.isInCreate,onClick=_ref5.onClick,sortDir=_ref5.sortDir;return isInCreate?void 0:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Invite accepted?",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return!!data.userId},sort:function sort(x,y){return x&&y?0:x?-1:y?1:0},filterFn:function filterFn(rows,filterValue){return rows.filter((function(row){return!!row.userId===filterValue}))},filterEl:CRUDComponents.DV,cell:function InvitationAcceptedCell(_ref6){var isInCreate=_ref6.isInCreate,value=_ref6.value;return isInCreate?void 0:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:value?"check":"times"})})}},{id:"invitedEmailAddress",header:function NameHeader(_ref7){var isInCreate=_ref7.isInCreate,onClick=_ref7.onClick,sortDir=_ref7.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Invitation address"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Invitation address",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _data$invitation$invi,_data$invitation;return null!==(_data$invitation$invi=null===(_data$invitation=data.invitation)||void 0===_data$invitation?void 0:_data$invitation.invitedEmailAddress)&&void 0!==_data$invitation$invi?_data$invitation$invi:""},set:function set(record,value){record.invitation?record.invitation.invitedEmailAddress=value:(esm.h.truthy(record.id),record.invitation={registrantId:record.id,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),invitedEmailAddress:value,inviteCode:"",id:""})},sort:function sort(x,y){return x.localeCompare(y)},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){var _row$invitation$invit,_row$invitation;return""===(null!==(_row$invitation$invit=null===(_row$invitation=row.invitation)||void 0===_row$invitation?void 0:_row$invitation.invitedEmailAddress)&&void 0!==_row$invitation$invit?_row$invitation$invit:"")})):rows.filter((function(row){var _row$invitation2,_row$invitation2$invi;return null===(_row$invitation2=row.invitation)||void 0===_row$invitation2||null===(_row$invitation2$invi=_row$invitation2.invitedEmailAddress)||void 0===_row$invitation2$invi?void 0:_row$invitation2$invi.toLowerCase().includes(filterValue.toLowerCase())}))},filterEl:CRUDComponents.Oe,cell:function InvitedEmailAddressCell(_ref8){var isInCreate=_ref8.isInCreate,value=_ref8.value,_onChange2=_ref8.onChange,onBlur=_ref8.onBlur,ref=_ref8.ref,_useClipboard2=(0,chakra_ui_hooks_esm.VP)(null!=value?value:""),onCopy=_useClipboard2.onCopy,hasCopied=_useClipboard2.hasCopied;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"email",value:null!=value?value:"",onChange:function onChange(ev){return null==_onChange2?void 0:_onChange2(ev.target.value)},onBlur,border:"1px solid",borderColor:"rgba(255, 255, 255, 0.16)",ref}):(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{alignItems:"center",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{px:2,children:value}),value?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onCopy,size:"xs",ml:"auto",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:hasCopied?"check-circle":"clipboard"})}):void 0]})}},{id:"inviteCode",header:function NameHeader(_ref9){return _ref9.isInCreate?void 0:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontSize:"xs",p:1,textAlign:"center",textTransform:"none",fontWeight:"normal",children:"Invite code"})},get:function get(data){var _data$invitation$invi2,_data$invitation2;return null!==(_data$invitation$invi2=null===(_data$invitation2=data.invitation)||void 0===_data$invitation2?void 0:_data$invitation2.inviteCode)&&void 0!==_data$invitation$invi2?_data$invitation$invi2:""},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){var _row$invitation$invit2,_row$invitation3;return""===(null!==(_row$invitation$invit2=null===(_row$invitation3=row.invitation)||void 0===_row$invitation3?void 0:_row$invitation3.inviteCode)&&void 0!==_row$invitation$invit2?_row$invitation$invit2:"")})):rows.filter((function(row){var _row$invitation4,_row$invitation5;return!(null===(_row$invitation4=row.invitation)||void 0===_row$invitation4||!_row$invitation4.inviteCode)&&(null===(_row$invitation5=row.invitation)||void 0===_row$invitation5?void 0:_row$invitation5.inviteCode.toLowerCase().includes(filterValue.toLowerCase()))}))},filterEl:CRUDComponents.Oe,cell:function InviteCodeCell(_ref10){var isInCreate=_ref10.isInCreate,value=_ref10.value,_useClipboard3=(0,chakra_ui_hooks_esm.VP)(null!=value?value:""),onCopy=_useClipboard3.onCopy,hasCopied=_useClipboard3.hasCopied;return isInCreate?void 0:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{alignItems:"center",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontFamily:"monospace",px:2,children:value}),value?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onCopy,size:"xs",ml:"auto",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:hasCopied?"check-circle":"clipboard"})}):void 0]})}},{id:"role",header:function RoleHeader(_ref11){var isInCreate=_ref11.isInCreate,onClick=_ref11.onClick,sortDir=_ref11.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Role"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Role",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return data.conferenceRole},set:function set(record,v){record.conferenceRole=v},filterFn:function filterFn(rows,v){return rows.filter((function(r){return r.conferenceRole===v}))},filterEl:(0,CRUDComponents.fD)(Object.values(graphql.OiL)),sort:function sort(x,y){return x.localeCompare(y)},cell:function RoomModeCell(_ref12){var value=_ref12.value,_onChange3=_ref12.onChange,onBlur=_ref12.onBlur,ref=_ref12.ref;return(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{value:null!=value?value:"",onChange:function onChange(ev){return null==_onChange3?void 0:_onChange3(ev.target.value)},onBlur,ref,maxW:400,children:roleOptions.map((function(option){return(0,jsx_runtime.jsx)("option",{value:option.value,children:option.label},option.value)}))})}},{id:"groups",header:function ContentHeader(_ref13){return _ref13.isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Groups"}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontSize:"xs",p:1,textAlign:"center",textTransform:"none",fontWeight:"normal",children:"Groups"})},get:function get(data){var _data$groupRegistrant,_data$groupRegistrant2;return null!==(_data$groupRegistrant=null===(_data$groupRegistrant2=data.groupRegistrants)||void 0===_data$groupRegistrant2?void 0:_data$groupRegistrant2.map((function(ga){var _groupOptions$find;return null!==(_groupOptions$find=groupOptions.find((function(group){return group.value===ga.groupId})))&&void 0!==_groupOptions$find?_groupOptions$find:{label:"<Unknown>",value:ga.groupId}})))&&void 0!==_data$groupRegistrant?_data$groupRegistrant:[]},set:function set(record,value){record.groupRegistrants=value.map((function(x){return{registrantId:record.id,groupId:x.value,id:void 0}}))},filterFn:function filterFn(rows,filterValue){return 0===filterValue.length?rows:rows.filter((function(row){return row.groupRegistrants.some((function(x){return filterValue.some((function(y){return y.value===x.groupId}))}))}))},filterEl:(0,CRUDComponents.VB)(groupOptions),cell:function ContentCell(_ref14){var value=_ref14.value,_onChange4=_ref14.onChange,onBlur=_ref14.onBlur;return(0,jsx_runtime.jsx)(MultiSelect.ZP,{name:"groups",options:groupOptions,value:null!=value?value:[],placeholder:"Select one or more groups",onChange:function onChange(ev){return null==_onChange4?void 0:_onChange4(ev)},onBlur,styles:{container:function container(base){return Object.assign({},base,{maxWidth:450})}}})}},{id:"subconferences",header:function ContentHeader(_ref15){return _ref15.isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Subconferences"}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontSize:"xs",p:1,textAlign:"center",textTransform:"none",fontWeight:"normal",children:"Subconferences"})},get:function get(data){var _data$subconferenceMe,_data$subconferenceMe2;return null!==(_data$subconferenceMe=null===(_data$subconferenceMe2=data.subconferenceMemberships)||void 0===_data$subconferenceMe2?void 0:_data$subconferenceMe2.map((function(ga){var _subconferenceOptions;return null!==(_subconferenceOptions=subconferenceOptions.find((function(subconference){return subconference.value.startsWith(ga.subconferenceId)&&subconference.value.endsWith(ga.role)})))&&void 0!==_subconferenceOptions?_subconferenceOptions:{label:"<Unknown>",value:ga.subconferenceId}})))&&void 0!==_data$subconferenceMe?_data$subconferenceMe:[]},set:function set(record,value){record.subconferenceMemberships=es.mNm((function(a){return a.value.split("¬")[0]}),es.HCG([function(a,b){return a.value.split("¬")[0].localeCompare(b.value.split("¬")[0])},function(a,b){return-a.value.split("¬")[1].localeCompare(b.value.split("¬")[1])}],value)).map((function(x){return{registrantId:record.id,subconferenceId:x.value.split("¬")[0],id:void 0,role:x.value.split("¬")[1]}}))},filterFn:function filterFn(rows,filterValue){return 0===filterValue.length?rows:rows.filter((function(row){return row.subconferenceMemberships.some((function(x){return filterValue.some((function(y){return y.value.startsWith(x.subconferenceId)}))&&filterValue.some((function(y){return y.value.endsWith(x.role)}))}))}))},filterEl:(0,CRUDComponents.VB)(subconferenceOptions),cell:function ContentCell(_ref16){var value=_ref16.value,_onChange5=_ref16.onChange,onBlur=_ref16.onBlur;return(0,jsx_runtime.jsx)(MultiSelect.ZP,{name:"subconferences",options:subconferenceOptions,value:null!=value?value:[],placeholder:"Select one or more subconferences",onChange:function onChange(ev){return null==_onChange5?void 0:_onChange5(ev)},onBlur,styles:{container:function container(base){return Object.assign({},base,{maxWidth:450})}}})}}];return result}),[null==allGroups?void 0:allGroups.registrant_Group,null==allRegistrants?void 0:allRegistrants.conference_Subconference,inviteStatusFilterOptions,roleOptions]),_useInsertInvitationE2=_slicedToArray((0,graphql.n4G)(),2),insertInvitationEmailJobsLoading=_useInsertInvitationE2[0].fetching,insertInvitationEmailJobsMutation=_useInsertInvitationE2[1],insertCustomEmailJobMutation=_slicedToArray((0,graphql.nyy)(),2)[1],_useState2=_slicedToArray((0,react.useState)([]),2),sendCustomEmailRegistrants=_useState2[0],setSendCustomEmailRegistrants=_useState2[1],sendCustomEmailModal=(0,chakra_ui_hooks_esm.qY)(),toast=(0,chakra_ui_toast_esm.pm)(),insert=(0,react.useMemo)((function(){return{ongoing:insertRegistrantResponse.fetching,generateDefaults:function generateDefaults(){return{id:(0,v4.Z)(),conferenceId:conference.id,conferenceRole:graphql.OiL.Attendee,groupRegistrants:[],subconferenceMemberships:[]}},makeWhole:function makeWhole(d){var _d$displayName;return null!==(_d$displayName=d.displayName)&&void 0!==_d$displayName&&_d$displayName.length?d:void 0},start:function start(record){var _record$invitation,_record$invitation2,_headers,_headers2;null!==(_record$invitation=record.invitation)&&void 0!==_record$invitation&&_record$invitation.invitedEmailAddress?insertRegistrant({registrant:{id:record.id,conferenceId:conference.id,displayName:record.displayName,conferenceRole:record.conferenceRole,groupRegistrants:{data:record.groupRegistrants.map((function(x){return{groupId:x.groupId}}))},subconferenceMemberships:{data:record.subconferenceMemberships.map((function(x){return{subconferenceId:x.subconferenceId,role:x.role}}))}},invitation:{registrantId:record.id,invitedEmailAddress:null===(_record$invitation2=record.invitation)||void 0===_record$invitation2?void 0:_record$invitation2.invitedEmailAddress}},{fetchOptions:{headers:(_headers={},_headers[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers)}}):insertRegistrantWithoutInvite({registrant:{id:record.id,conferenceId:conference.id,displayName:record.displayName,conferenceRole:record.conferenceRole,groupRegistrants:{data:record.groupRegistrants.map((function(x){return{groupId:x.groupId}}))},subconferenceMemberships:{data:record.subconferenceMemberships.map((function(x){return{subconferenceId:x.subconferenceId,role:x.role}}))}}},{fetchOptions:{headers:(_headers2={},_headers2[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers2)}})}}}),[conference.id,insertRegistrant,insertRegistrantResponse.fetching,insertRegistrantWithoutInvite,subconferenceId]),update=(0,react.useMemo)((function(){return{ongoing:updateRegistrantResponse.fetching,start:function start(record){var _headers3;updateRegistrant({registrantId:record.id,registrantUpdates:{displayName:record.displayName,conferenceRole:record.conferenceRole},upsertGroups:record.groupRegistrants.map((function(x){return{groupId:x.groupId,registrantId:x.registrantId}})),remainingGroupIds:record.groupRegistrants.map((function(x){return x.groupId})),upsertSubconferences:record.subconferenceMemberships.map((function(x){return{subconferenceId:x.subconferenceId,registrantId:x.registrantId,role:x.role}})),remainingSubconferenceIds:record.subconferenceMemberships.map((function(x){return x.subconferenceId}))},{fetchOptions:{headers:(_headers3={},_headers3[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers3)}})}}}),[subconferenceId,updateRegistrant,updateRegistrantResponse.fetching]),deleteP=(0,react.useMemo)((function(){return{ongoing:deleteRegistrantsResponse.fetching,start:function start(keys){var _headers4;deleteRegistrants({deleteRegistrantIds:keys},{fetchOptions:{headers:(_headers4={},_headers4[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers4)}})}}}),[deleteRegistrants,deleteRegistrantsResponse.fetching,subconferenceId]),_useState4=_slicedToArray((0,react.useState)(!1),2),exportWithProfileData=_useState4[0],setExportWithProfileData=_useState4[1],client=(0,urql_es.m8)(),buttons=(0,react.useMemo)((function(){return[{render:function ImportButton(_selectedData){return(0,jsx_runtime.jsx)(LinkButton.Qj,{colorScheme:"purple",to:conferencePath+"/manage/import/registrants",children:"Import"})}},{render:function render(_ref17){var selectedData=_ref17.selectedData;function doExport(_x){return _doExport.apply(this,arguments)}function _doExport(){return(_doExport=ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee(dataToExport){var _yield$client$query$t,_yield$client$query$t2,_headers5,_csvURL,profiles,csvText,csvData,csvURL,now,fileName,tempLink;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!exportWithProfileData){_context.next=24;break}return _context.next=3,client.query(graphql.C7U,{registrantIds:dataToExport.map((function(x){return x.id}))},{fetchOptions:{headers:(_headers5={},_headers5[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers5)}}).toPromise();case 3:if(_context.t3=_yield$client$query$t2=_context.sent.data,_context.t2=null===_context.t3,_context.t2){_context.next=7;break}_context.t2=void 0===_yield$client$query$t2;case 7:if(!_context.t2){_context.next=11;break}_context.t4=void 0,_context.next=12;break;case 11:_context.t4=_yield$client$query$t2.registrant_Profile;case 12:if(_context.t5=_yield$client$query$t=_context.t4,_context.t1=null!==_context.t5,!_context.t1){_context.next=16;break}_context.t1=void 0!==_yield$client$query$t;case 16:if(!_context.t1){_context.next=20;break}_context.t6=_yield$client$query$t,_context.next=21;break;case 20:_context.t6=[];case 21:_context.t0=_context.t6,_context.next=25;break;case 24:_context.t0=[];case 25:profiles=_context.t0,csvText=papaparse_min_default().unparse(dataToExport.map((function(registrant){var _registrant$invitatio,_registrant$invitatio2,_registrant$invitatio3,_registrant$invitatio4,result={"Conference Id":registrant.conferenceId,"Registrant Id":registrant.id,"User Id":registrant.userId,Name:registrant.displayName,Email:null!==(_registrant$invitatio=null===(_registrant$invitatio2=registrant.invitation)||void 0===_registrant$invitatio2?void 0:_registrant$invitatio2.invitedEmailAddress)&&void 0!==_registrant$invitatio?_registrant$invitatio:"","Invite code":null!==(_registrant$invitatio3=null===(_registrant$invitatio4=registrant.invitation)||void 0===_registrant$invitatio4?void 0:_registrant$invitatio4.inviteCode)&&void 0!==_registrant$invitatio3?_registrant$invitatio3:"","Invitation status":JSON.stringify(registrant.invitationStatus),"Invite accepted":registrant.userId?"Yes":"No","Group Ids":registrant.groupRegistrants.map((function(x){return x.groupId})),"Group Names":registrant.groupRegistrants.map((function(x){var _allGroups$registrant2,_allGroups$registrant3;return null!==(_allGroups$registrant2=null==allGroups||null===(_allGroups$registrant3=allGroups.registrant_Group.find((function(g){return g.id===x.groupId})))||void 0===_allGroups$registrant3?void 0:_allGroups$registrant3.name)&&void 0!==_allGroups$registrant2?_allGroups$registrant2:"<Hidden>"})),"Subconference Ids":registrant.subconferenceMemberships.map((function(x){return x.subconferenceId})),"Subconference Names":registrant.subconferenceMemberships.map((function(x){var _allRegistrants$confe2,_allRegistrants$confe3;return null!==(_allRegistrants$confe2=null==allRegistrants||null===(_allRegistrants$confe3=allRegistrants.conference_Subconference.find((function(g){return g.id===x.subconferenceId})))||void 0===_allRegistrants$confe3?void 0:_allRegistrants$confe3.name)&&void 0!==_allRegistrants$confe2?_allRegistrants$confe2:"<Hidden>"})),"Subconference Roles":registrant.subconferenceMemberships.map((function(x){return x.role})),"Created At":registrant.createdAt,"Updated At":registrant.updatedAt};if(exportWithProfileData){var _profile$badges$map,_profile$badges,_profile$affiliation,_profile$country,_profile$timezoneUTCO,_profile$bio,_profile$website,_profile$github,_profile$twitter,_profile$affiliationU,_profile$pronouns,_profile$photoURL_50x,_profile$photoURL_,profile=profiles.find((function(x){return x.registrantId===registrant.id}));result["Profile Data Exportable"]=profile?"Yes":"No",result["Has Been Edited"]=profile?profile.hasBeenEdited?"Yes":"No":"",result.Badges=null!==(_profile$badges$map=null==profile||null===(_profile$badges=profile.badges)||void 0===_profile$badges?void 0:_profile$badges.map((function(badge){return badge.name+" ["+badge.colour+"]"})))&&void 0!==_profile$badges$map?_profile$badges$map:"",result.Affiliation=null!==(_profile$affiliation=null==profile?void 0:profile.affiliation)&&void 0!==_profile$affiliation?_profile$affiliation:"",result.Country=null!==(_profile$country=null==profile?void 0:profile.country)&&void 0!==_profile$country?_profile$country:"",result["Timezone UTC Offset"]=null!==(_profile$timezoneUTCO=null==profile?void 0:profile.timezoneUTCOffset)&&void 0!==_profile$timezoneUTCO?_profile$timezoneUTCO:"",result["Bio (Markdown)"]=null!==(_profile$bio=null==profile?void 0:profile.bio)&&void 0!==_profile$bio?_profile$bio:"",result.Website=null!==(_profile$website=null==profile?void 0:profile.website)&&void 0!==_profile$website?_profile$website:"",result.GitHub=null!==(_profile$github=null==profile?void 0:profile.github)&&void 0!==_profile$github?_profile$github:"",result.Twitter=null!==(_profile$twitter=null==profile?void 0:profile.twitter)&&void 0!==_profile$twitter?_profile$twitter:"",result["Affiliation URL"]=null!==(_profile$affiliationU=null==profile?void 0:profile.affiliationURL)&&void 0!==_profile$affiliationU?_profile$affiliationU:"",result.Pronouns=null!==(_profile$pronouns=null==profile?void 0:profile.pronouns)&&void 0!==_profile$pronouns?_profile$pronouns:"",result["Photo URL - 50px by 50px"]=null!==(_profile$photoURL_50x=null==profile?void 0:profile.photoURL_50x50)&&void 0!==_profile$photoURL_50x?_profile$photoURL_50x:"",result["Photo URL - 350px by 350px"]=null!==(_profile$photoURL_=null==profile?void 0:profile.photoURL_350x350)&&void 0!==_profile$photoURL_?_profile$photoURL_:""}return result})),{columns:["Conference Id","Registrant Id","User Id","Name","Email","Invite code","Invite sent","Invite accepted","Group Ids","Group Names","Subconference Ids","Subconference Names","Subconference Roles","Created At","Updated At","Profile Data Exportable","Has Been Edited","Badges","Affiliation","Country","Timezone UTC Offset","Bio (Markdown)","Website","GitHub","Twitter","Affiliation URL","Pronouns","Photo URL - 50px by 50px","Photo URL - 350px by 350px"]}),csvData=new Blob([csvText],{type:"text/csv;charset=utf-8;"}),null,now=new Date,fileName=now.getFullYear()+"-"+(now.getMonth()+1).toString().padStart(2,"0")+"-"+now.getDate().toString().padStart(2,"0")+"T"+now.getHours().toString().padStart(2,"0")+"-"+now.getMinutes().toString().padStart(2,"0")+" - Midspace Registrants.csv",csvURL=window.URL.createObjectURL(csvData),(tempLink=document.createElement("a")).href=null!==(_csvURL=csvURL)&&void 0!==_csvURL?_csvURL:"",tempLink.setAttribute("download",fileName),tempLink.click();case 36:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}var tooltip=function tooltip(filler){return"Exports the name, email, groups and subconferences of "+filler+"."};return 0===selectedData.length?(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("all registrants (from a chosen group or subconference)"),children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,colorScheme:"purple",rightIcon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{}),children:"Export"})}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.ii,{closeOnSelect:!1,isChecked:exportWithProfileData,onClick:function onClick(){setExportWithProfileData(!exportWithProfileData)},children:"With profile data?"}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){doExport(data)},children:"All registrants"}),null!=allGroups&&allGroups.registrant_Group.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Groups",children:allGroups.registrant_Group.map((function(group){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){doExport(data.filter((function(a){return a.groupRegistrants.some((function(ga){return ga.groupId===group.id}))})))},children:group.name},group.id)}))}):void 0,null!=allRegistrants&&allRegistrants.conference_Subconference.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Subconferences",children:allRegistrants.conference_Subconference.map((function(subconference){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){doExport(data.filter((function(a){return a.subconferenceMemberships.some((function(ga){return ga.subconferenceId===subconference.id}))})))},children:subconference.shortName},subconference.id)}))}):void 0]})]}):(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("selected registrants"),children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:0===selectedData.length,onClick:function onClick(){return doExport(selectedData)},children:"Export"})})})}},{render:function SendInitialInvitesButton(_ref18){var selectedData=_ref18.selectedData,tooltip=function tooltip(filler){return"Sends invitations to "+filler+" who have not already been sent an invite."};return 0===selectedData.length?(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("all registrants (from a group or subconference)"),children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,colorScheme:"purple",rightIcon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{}),children:"Send initial invitations"})}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _headers6,result;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,insertInvitationEmailJobsMutation({registrantIds:data.map((function(a){return a.id})),conferenceId:conference.id,sendRepeat:!1},{fetchOptions:{headers:(_headers6={},_headers6[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers6)}});case 2:(result=_context2.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context2.stop()}}),_callee2)}))),children:"All registrants"}),null!=allGroups&&allGroups.registrant_Group.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Groups",children:null==allGroups?void 0:allGroups.registrant_Group.map((function(group){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _headers7,result;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,insertInvitationEmailJobsMutation({registrantIds:data.filter((function(a){return a.groupRegistrants.some((function(ga){return ga.groupId===group.id}))})).map((function(a){return a.id})),conferenceId:conference.id,sendRepeat:!1},{fetchOptions:{headers:(_headers7={},_headers7[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers7)}});case 2:(result=_context3.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context3.stop()}}),_callee3)}))),children:group.name},group.id)}))}):void 0,null!=allRegistrants&&allRegistrants.conference_Subconference.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Subconferences",children:allRegistrants.conference_Subconference.map((function(subconference){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _headers8,result;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,insertInvitationEmailJobsMutation({registrantIds:data.filter((function(a){return a.subconferenceMemberships.some((function(ga){return ga.subconferenceId===subconference.id}))})).map((function(a){return a.id})),conferenceId:conference.id,sendRepeat:!1},{fetchOptions:{headers:(_headers8={},_headers8[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers8)}});case 2:(result=_context4.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context4.stop()}}),_callee4)}))),children:subconference.shortName},subconference.id)}))}):void 0]})]}):(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("selected registrants"),children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:0===selectedData.length,isLoading:insertInvitationEmailJobsLoading,onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _headers9,result;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,insertInvitationEmailJobsMutation({registrantIds:selectedData.map((function(x){return x.id})),conferenceId:conference.id,sendRepeat:!1},{fetchOptions:{headers:(_headers9={},_headers9[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers9)}});case 2:(result=_context5.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context5.stop()}}),_callee5)}))),children:"Send initial invitations"})})})}},{render:function SendRepeatInvitesButton(_ref23){var selectedData=_ref23.selectedData,tooltip=function tooltip(filler){return"Sends repeat invitations to "+filler+"."};return 0===selectedData.length?(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("all registrants (from a group or subconference)"),children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,colorScheme:"purple",rightIcon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{}),children:"Send repeat invitations"})}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var _headers10,result;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,insertInvitationEmailJobsMutation({registrantIds:data.map((function(a){return a.id})),conferenceId:conference.id,sendRepeat:!0},{fetchOptions:{headers:(_headers10={},_headers10[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers10)}});case 2:(result=_context6.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context6.stop()}}),_callee6)}))),children:"All registrants"}),null!=allGroups&&allGroups.registrant_Group.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Groups",children:allGroups.registrant_Group.map((function(group){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){var _headers11,result;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,insertInvitationEmailJobsMutation({registrantIds:data.filter((function(a){return a.groupRegistrants.some((function(ga){return ga.groupId===group.id}))})).map((function(a){return a.id})),conferenceId:conference.id,sendRepeat:!0},{fetchOptions:{headers:(_headers11={},_headers11[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers11)}});case 2:(result=_context7.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context7.stop()}}),_callee7)}))),children:group.name},group.id)}))}):void 0,null!=allRegistrants&&allRegistrants.conference_Subconference.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Subconferences",children:allRegistrants.conference_Subconference.map((function(subconference){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){var _headers12,result;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,insertInvitationEmailJobsMutation({registrantIds:data.filter((function(a){return a.subconferenceMemberships.some((function(ga){return ga.subconferenceId===subconference.id}))})).map((function(a){return a.id})),conferenceId:conference.id,sendRepeat:!0},{fetchOptions:{headers:(_headers12={},_headers12[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers12)}});case 2:(result=_context8.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context8.stop()}}),_callee8)}))),children:subconference.shortName},subconference.id)}))}):void 0]})]}):(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("selected registrants"),children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:0===selectedData.length,isLoading:insertInvitationEmailJobsLoading,onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){var _headers13,result;return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,insertInvitationEmailJobsMutation({registrantIds:selectedData.map((function(x){return x.id})),conferenceId:conference.id,sendRepeat:!0},{fetchOptions:{headers:(_headers13={},_headers13[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers13)}});case 2:(result=_context9.sent).error?toast({title:"Failed to send invitation emails",description:result.error.message,isClosable:!0,status:"error"}):toast({title:"Invitation emails sent",duration:8e3,status:"success"}),refetchAllRegistrants();case 5:case"end":return _context9.stop()}}),_callee9)}))),children:"Send repeat invitations"})})})}},{render:function SendCustomEmailButton(_ref28){var selectedData=_ref28.selectedData;return 0===selectedData.length?(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,colorScheme:"purple",rightIcon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{}),children:"Send custom email"}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){setSendCustomEmailRegistrants(data),sendCustomEmailModal.onOpen()},children:"All registrants"}),null!=allGroups&&allGroups.registrant_Group.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Groups",children:allGroups.registrant_Group.map((function(group){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){setSendCustomEmailRegistrants(data.filter((function(a){return a.groupRegistrants.some((function(ga){return ga.groupId===group.id}))}))),sendCustomEmailModal.onOpen()},children:group.name},group.id)}))}):void 0,null!=allRegistrants&&allRegistrants.conference_Subconference.length?(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Subconferences",children:allRegistrants.conference_Subconference.map((function(subconference){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){setSendCustomEmailRegistrants(data.filter((function(a){return a.subconferenceMemberships.some((function(ga){return ga.subconferenceId===subconference.id}))}))),sendCustomEmailModal.onOpen()},children:subconference.shortName},subconference.id)}))}):void 0]})]}):(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:function tooltip(filler){return"Sends a custom email to "+filler+"."}("selected registrants"),children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:0===selectedData.length,onClick:ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:setSendCustomEmailRegistrants(selectedData),sendCustomEmailModal.onOpen();case 2:case"end":return _context10.stop()}}),_callee10)}))),children:"Send custom email"})})})}}]}),[conferencePath,exportWithProfileData,client,subconferenceId,null==allGroups?void 0:allGroups.registrant_Group,null==allRegistrants?void 0:allRegistrants.conference_Subconference,data,insertInvitationEmailJobsMutation,conference.id,refetchAllRegistrants,toast,insertInvitationEmailJobsLoading,sendCustomEmailModal]);return(0,jsx_runtime.jsx)(DashboardPage.Y,{title:"Registrants",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[loadingAllGroups&&!allGroups||loadingAllRegistrants&&(null==allRegistrants||!allRegistrants.registrant_Registrant)?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):errorAllRegistrants||errorAllGroups?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"An error occurred loading in data - please see further information in notifications."}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}),(0,jsx_runtime.jsx)(CRUDTable2.Z,{columns,row,data:!loadingAllGroups&&!loadingAllRegistrants&&(null!=allGroups&&allGroups.registrant_Group&&null!=allRegistrants&&allRegistrants.registrant_Registrant?data:null),tableUniqueName:"ManageConferenceRegistrants",alert:insertRegistrantResponse.error||insertRegistrantWithoutInviteResponse.error||updateRegistrantResponse.error||deleteRegistrantsResponse.error?{status:"error",title:"Error saving changes",description:null!==(_extractActualError=(0,ExtractActualError.Z)(null!==(_ref30=null!==(_ref31=null!==(_insertRegistrantResp=insertRegistrantResponse.error)&&void 0!==_insertRegistrantResp?_insertRegistrantResp:insertRegistrantWithoutInviteResponse.error)&&void 0!==_ref31?_ref31:updateRegistrantResponse.error)&&void 0!==_ref30?_ref30:deleteRegistrantsResponse.error))&&void 0!==_extractActualError?_extractActualError:"Unknown error"}:void 0,insert,update,delete:deleteP,buttons}),(0,jsx_runtime.jsx)(SendEmailModal,{isOpen:sendCustomEmailModal.isOpen,onClose:sendCustomEmailModal.onClose,registrants:sendCustomEmailRegistrants,send:function(){var _ref32=ManageRegistrants_asyncToGenerator(regeneratorRuntime.mark((function _callee11(registrantIds,markdownBody,subject){var _headers14,result;return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,insertCustomEmailJobMutation({registrantIds,conferenceId:conference.id,markdownBody,subject},{fetchOptions:{headers:(_headers14={},_headers14[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers14)}});case 2:if(null==(result=_context11.sent)||!result.error){_context11.next=6;break}throw console.error("Failed to insert CustomEmailJob",result.error),new Error("Error submitting query");case 6:case"end":return _context11.stop()}}),_callee11)})));return function(_x2,_x3,_x4){return _ref32.apply(this,arguments)}}()})]})})}(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment InvitationParts on registrant_Invitation {\n        registrantId\n        id\n        inviteCode\n        invitedEmailAddress\n        linkToUserId\n        createdAt\n        updatedAt\n        hash\n    }\n\n    fragment RegistrantParts on registrant_Registrant {\n        conferenceId\n        id\n        conferenceRole\n        invitation {\n            ...InvitationParts\n        }\n        groupRegistrants {\n            registrantId\n            id\n            groupId\n        }\n        subconferenceMemberships {\n            id\n            subconferenceId\n            registrantId\n            role\n        }\n        userId\n        updatedAt\n        createdAt\n        displayName\n        invitationStatus\n    }\n\n    fragment ManageRegistrants_Profile on registrant_Profile {\n        registrantId\n        badges\n        affiliation\n        country\n        timezoneUTCOffset\n        bio\n        website\n        github\n        twitter\n        affiliationURL\n        pronouns\n        photoURL_50x50\n        photoURL_350x350\n        hasBeenEdited\n    }\n\n    fragment SubconferenceParts on conference_Subconference {\n        id\n        conferenceId\n        name\n        shortName\n        slug\n    }\n\n    query SelectAllRegistrants($conferenceId: uuid!) {\n        registrant_Registrant(where: { conferenceId: { _eq: $conferenceId } }) {\n            ...RegistrantParts\n        }\n        conference_Subconference(where: { conferenceId: { _eq: $conferenceId } }) {\n            ...SubconferenceParts\n        }\n    }\n\n    query ManageRegistrants_SelectProfiles($registrantIds: [uuid!]!) {\n        registrant_Profile(where: { registrantId: { _in: $registrantIds } }) {\n            ...ManageRegistrants_Profile\n        }\n    }\n\n    mutation InsertRegistrant(\n        $registrant: registrant_Registrant_insert_input!\n        $invitation: registrant_Invitation_insert_input!\n    ) {\n        insert_registrant_Registrant_one(object: $registrant) {\n            ...RegistrantParts\n        }\n        insert_registrant_Invitation_one(object: $invitation) {\n            ...InvitationParts\n        }\n    }\n\n    mutation InsertRegistrantWithoutInvite($registrant: registrant_Registrant_insert_input!) {\n        insert_registrant_Registrant_one(object: $registrant) {\n            ...RegistrantParts\n        }\n    }\n\n    mutation DeleteRegistrants($deleteRegistrantIds: [uuid!] = []) {\n        delete_registrant_Registrant(where: { id: { _in: $deleteRegistrantIds } }) {\n            returning {\n                id\n            }\n        }\n    }\n\n    mutation UpdateRegistrant(\n        $registrantId: uuid!\n        $registrantUpdates: registrant_Registrant_set_input!\n        $upsertGroups: [registrant_GroupRegistrant_insert_input!]!\n        $remainingGroupIds: [uuid!]\n        $upsertSubconferences: [registrant_SubconferenceMembership_insert_input!]!\n        $remainingSubconferenceIds: [uuid!]\n    ) {\n        update_registrant_Registrant_by_pk(pk_columns: { id: $registrantId }, _set: $registrantUpdates) {\n            ...RegistrantParts\n        }\n        insert_registrant_GroupRegistrant(\n            objects: $upsertGroups\n            on_conflict: { constraint: GroupRegistrant_groupId_registrantId_key, update_columns: [] }\n        ) {\n            returning {\n                id\n                registrantId\n                groupId\n            }\n        }\n        delete_registrant_GroupRegistrant(\n            where: { registrantId: { _eq: $registrantId }, groupId: { _nin: $remainingGroupIds } }\n        ) {\n            returning {\n                id\n            }\n        }\n        insert_registrant_SubconferenceMembership(\n            objects: $upsertSubconferences\n            on_conflict: {\n                constraint: SubconferenceMembership_subconferenceId_registrantId_key\n                update_columns: [role]\n            }\n        ) {\n            returning {\n                id\n                registrantId\n                subconferenceId\n                role\n            }\n        }\n        delete_registrant_SubconferenceMembership(\n            where: { registrantId: { _eq: $registrantId }, subconferenceId: { _nin: $remainingSubconferenceIds } }\n        ) {\n            returning {\n                id\n            }\n        }\n    }\n\n    mutation InsertInvitationEmailJobs($registrantIds: jsonb!, $conferenceId: uuid!, $sendRepeat: Boolean!) {\n        insert_job_queues_InvitationEmailJob(\n            objects: [{ registrantIds: $registrantIds, conferenceId: $conferenceId, sendRepeat: $sendRepeat }]\n        ) {\n            affected_rows\n        }\n    }\n\n    mutation ManagePeople_InsertCustomEmailJob(\n        $markdownBody: String!\n        $subject: String!\n        $conferenceId: uuid!\n        $subconferenceId: uuid\n        $registrantIds: jsonb!\n    ) {\n        insert_job_queues_CustomEmailJob(\n            objects: {\n                markdownBody: $markdownBody\n                subject: $subject\n                conferenceId: $conferenceId\n                subconferenceId: $subconferenceId\n                registrantIds: $registrantIds\n            }\n        ) {\n            affected_rows\n        }\n    }\n"]))),ManageRegistrants.displayName="ManageRegistrants"},"../node_modules/.pnpm/use-react-router-breadcrumbs@2.0.2_react-router@5.2.1+react@17.0.2/node_modules/use-react-router-breadcrumbs/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/.pnpm/@babel+runtime@7.15.4/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js");var DEFAULT_MATCH_OPTIONS={exact:!0},humanize=function humanize(str){return str.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,(function(m){return m.toUpperCase()}))},render=function render(_ref){var Breadcrumb=_ref.breadcrumb,match=_ref.match,location=_ref.location,props=_ref.props,componentProps=Object.assign({match,location,key:match.url},props||{});return Object.assign(Object.assign({},componentProps),{breadcrumb:"string"==typeof Breadcrumb?(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("span",{key:componentProps.key},Breadcrumb):react__WEBPACK_IMPORTED_MODULE_0__.createElement(Breadcrumb,Object.assign({},componentProps))})},getBreadcrumbMatch=function getBreadcrumbMatch(_ref3){var breadcrumb,currentSection=_ref3.currentSection,disableDefaults=_ref3.disableDefaults,excludePaths=_ref3.excludePaths,location=_ref3.location,pathSection=_ref3.pathSection,routes=_ref3.routes;return excludePaths&&excludePaths.some((function getIsPathExcluded(path){return null!=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,{path,exact:!0,strict:!1})}))?"NO_BREADCRUMB":(routes.some((function(_a){var userProvidedBreadcrumb=_a.breadcrumb,matchOptions=_a.matchOptions,path=_a.path,rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}(_a,["breadcrumb","matchOptions","path"]);if(!path)throw new Error("useBreadcrumbs: `path` must be provided in every route object");var match=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,Object.assign(Object.assign({},matchOptions||DEFAULT_MATCH_OPTIONS),{path}));return match&&null===userProvidedBreadcrumb||!match&&matchOptions?(breadcrumb="NO_BREADCRUMB",!0):!!match&&(!userProvidedBreadcrumb&&disableDefaults?(breadcrumb="NO_BREADCRUMB",!0):(breadcrumb=render(Object.assign({breadcrumb:userProvidedBreadcrumb||humanize(currentSection),match,location},rest)),!0))})),breadcrumb||(disableDefaults?"NO_BREADCRUMB":function getDefaultBreadcrumb(_ref2){var currentSection=_ref2.currentSection,location=_ref2.location,pathSection=_ref2.pathSection,match=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,Object.assign(Object.assign({},DEFAULT_MATCH_OPTIONS),{path:pathSection}))||{url:"not-found"};return render({breadcrumb:humanize(currentSection),match,location})}({pathSection,currentSection:"/"===pathSection?"Home":currentSection,location})))},flattenRoutes=function flattenRoutes(routes){return routes.reduce((function(arr,route){return route.routes?arr.concat([route].concat((0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__.Z)(flattenRoutes(route.routes)))):arr.concat(route)}),[])};const __WEBPACK_DEFAULT_EXPORT__=function useReactRouterBreadcrumbs(routes,options){return function getBreadcrumbs(_ref4){var routes=_ref4.routes,location=_ref4.location,_ref4$options=_ref4.options,options=void 0===_ref4$options?{}:_ref4$options,matches=[];return location.pathname.split("?")[0].split("/").reduce((function(previousSection,currentSection,index){var pathSection=currentSection?"".concat(previousSection,"/").concat(currentSection):"/";if("/"===pathSection&&0!==index)return"";var breadcrumb=getBreadcrumbMatch(Object.assign({currentSection,location,pathSection,routes},options));return"NO_BREADCRUMB"!==breadcrumb&&matches.push(breadcrumb),"/"===pathSection?"":pathSection}),""),matches}({routes:flattenRoutes(routes||[]),location:(0,react_router__WEBPACK_IMPORTED_MODULE_1__.TH)(),options})}}}]);