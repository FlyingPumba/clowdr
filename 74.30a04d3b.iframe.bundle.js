"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[74],{"./src/aspects/Users/CurrentUser/CurrentUserPage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CurrentUserPage});var _templateObject,react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js"),chakra_ui_icons_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+icons@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icons/dist/chakra-ui-icons.esm.js")),chakra_ui_color_mode_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),chakra_ui_icon_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+icon@2.0.3_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icon/dist/chakra-ui-icon.esm.js"),chakra_ui_system_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+system@1.10.3_922a85da57e3646a57465b7970b0de85/node_modules/@chakra-ui/system/dist/chakra-ui-system.esm.js"),LinkButton=__webpack_require__("./src/aspects/Chakra/LinkButton.tsx"),useTitle=__webpack_require__("./src/aspects/Hooks/useTitle.tsx"),useCurrentUser=__webpack_require__("./src/aspects/Users/CurrentUser/useCurrentUser.ts"),auth=__webpack_require__("../packages/shared/shared-types/build/esm/auth.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),graphql=__webpack_require__("./src/generated/graphql.tsx"),CenteredSpinner=__webpack_require__("./src/aspects/Chakra/CenteredSpinner.tsx"),make_context=__webpack_require__("./src/aspects/GQL/make-context.ts"),useQueryErrorToast=__webpack_require__("./src/aspects/GQL/useQueryErrorToast.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment RegistrantFields on registrant_Registrant {\n        id\n        userId\n        conferenceId\n        displayName\n        createdAt\n        updatedAt\n        profile {\n            registrantId\n            photoURL_50x50\n        }\n        conference {\n            id\n            name\n            shortName\n            slug\n        }\n        conferenceRole\n    }\n\n    query SelectCurrentUserRegistrations($userId: String!) @cached {\n        registrant_Registrant(where: { userId: { _eq: $userId } }) {\n            ...RegistrantFields\n        }\n    }\n\n    query SelectRegistration($registrantId: uuid!) @cached {\n        registrant_Registrant_by_pk(id: $registrantId) {\n            ...RegistrantFields\n        }\n    }\n"])));var CurrentUserRegistrantsContext=react.createContext([]);function useCurrentUserRegistrants(){return react.useContext(CurrentUserRegistrantsContext)}function CurrentUserRegistrantsProvider(_ref){var children=_ref.children,userId=_ref.userId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=auth.Z.User,_makeContext.NoConferenceId="true",_makeContext))}),[]),_useSelectCurrentUser3=_slicedToArray((0,graphql.wy1)({variables:{userId},context}),1)[0],fetching=_useSelectCurrentUser3.fetching,error=_useSelectCurrentUser3.error,data=_useSelectCurrentUser3.data;return(0,useQueryErrorToast.Z)(error,!1,"useSelectCurrentUserRegistrationsQuery"),fetching||!data?(0,jsx_runtime.jsx)(CenteredSpinner.Z,{caller:"CurrentUserRegistrantsProvider",spinnerProps:{label:"Loading registrations"}}):(0,jsx_runtime.jsx)(CurrentUserRegistrantsContext.Provider,{value:data.registrant_Registrant,children})}CurrentUserRegistrantsProvider.displayName="CurrentUserRegistrantsProvider";try{CurrentUserRegistrantsProvider.displayName="CurrentUserRegistrantsProvider",CurrentUserRegistrantsProvider.__docgenInfo={description:"",displayName:"CurrentUserRegistrantsProvider",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Users/CurrentUser/useCurrentUserRegistrants.tsx#CurrentUserRegistrantsProvider"]={docgenInfo:CurrentUserRegistrantsProvider.__docgenInfo,name:"CurrentUserRegistrantsProvider",path:"src/aspects/Users/CurrentUser/useCurrentUserRegistrants.tsx#CurrentUserRegistrantsProvider"})}catch(__react_docgen_typescript_loader_error){}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return ListConferencesView_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function ListConferencesView_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ListConferencesView_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ListConferencesView_arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ListConferencesView_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ListConferencesView(){var _user$email,title=(0,useTitle.Z)("My Conferences"),user=(0,useCurrentUser.Z)().user,registrants=useCurrentUserRegistrants(),boxBg=(0,chakra_ui_color_mode_esm.ff)("gray.200","gray.700");return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[title,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{pt:4,width:"100%",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",spacing:5,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h1",id:"page-heading",children:"My conferences"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{alignItems:"flex-start",p:4,bgColor:boxBg,spacing:4,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h3",fontSize:"md",textAlign:"left",children:"Login email address"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{children:["Your login email address is: ",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{fontFamily:"monospace",fontSize:"md",fontWeight:"bold",children:null!==(_user$email=user.email)&&void 0!==_user$email?_user$email:"unknown"})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{maxW:"300px",fontSize:"md",children:[(0,jsx_runtime.jsx)("b",{children:"Choose a conference"})," or use an invite code to join a new one."]}),function renderConferenceList(icon,registrants,button,subPath){return 0===registrants.length?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"No conferences."}),button]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.aV,{spacing:2,display:"flex",flexDir:"column",alignItems:"stretch",children:_toConsumableArray(registrants).filter((function(x){return Boolean(x.conference)})).sort((function(x,y){return x.conference.shortName.localeCompare(y.conference.shortName)})).map((function(registrant){return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{display:"list-item",children:(0,jsx_runtime.jsx)(LinkButton.Qj,{leftIcon:(0,jsx_runtime.jsx)(chakra_ui_icon_esm.JO,{as:icon,color:"purple.500",fontSize:"100%",verticalAlign:"middle"}),to:"/conference/"+registrant.conference.slug+"/"+subPath,colorScheme:"PrimaryActionButton",linkProps:{w:"100%"},w:"100%",justifyContent:"flex-start",variant:"outline",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",verticalAlign:"middle",children:registrant.conference.shortName})})},registrant.id)}))}),button]})}(chakra_ui_icons_esm.LinkIcon,registrants,(0,jsx_runtime.jsx)(LinkButton.Qj,{to:"/join",colorScheme:"pink",marginRight:0,mt:5,children:"Use invite code"}),"")]})]})}function CurrentUserPage(){var user=(0,useCurrentUser.Z)().user;return(0,jsx_runtime.jsx)(CurrentUserRegistrantsProvider,{userId:user.id,children:(0,jsx_runtime.jsx)(CurrentUserPageInner,{})})}function CurrentUserPageInner(){return useCurrentUserRegistrants().length>0?(0,jsx_runtime.jsx)(ListConferencesView,{}):(0,jsx_runtime.jsx)(react_router.l_,{to:"/join"})}CurrentUserPage.displayName="CurrentUserPage"}}]);