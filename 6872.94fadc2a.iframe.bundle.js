"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[6872],{"./src/aspects/CRUDTable2/CRUDComponents.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Oe:()=>TextColumnFilter,DV:()=>CheckBoxColumnFilter,fD:()=>SelectColumnFilter,VB:()=>MultiSelectColumnFilter,pV:()=>NumberRangeColumnFilter,F2:()=>dateTimeFilterFn,V0:()=>DateTimeColumnFilter,oL:()=>formatEnumValue});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.parse-int.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.split.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.exec.js");var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+checkbox@1.6.5_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/checkbox/dist/chakra-ui-checkbox.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+input@1.4.1_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/input/dist/chakra-ui-input.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+select@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/select/dist/chakra-ui-select.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+number-input@1.4.2_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/number-input/dist/chakra-ui-number-input.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+system@1.10.3_922a85da57e3646a57465b7970b0de85/node_modules/@chakra-ui/system/dist/chakra-ui-system.esm.js"),_Chakra_DateTimePicker__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),__webpack_require__("./src/aspects/Chakra/DateTimePicker.tsx")),_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx"),_Chakra_MultiSelect__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/aspects/Chakra/MultiSelect.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function TextColumnFilter(_ref){var value=_ref.value,_onChange=_ref.onChange,onBlur=_ref.onBlur;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_13__.Ug,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.XZ,{"aria-label":"Filter to blank values",isChecked:null!==value,onChange:function onChange(e){_onChange(e.target.checked?null!=value?value:"":null)},onBlur}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__.II,{size:"sm",value:value||"",onChange:function onChange(e){null!==value&&""!==value&&""===e.target.value?_onChange(null):_onChange(e.target.value)},onBlur,placeholder:"Filter..."})]})}function CheckBoxColumnFilter(_ref2){var value=_ref2.value,_onChange2=_ref2.onChange,onBlur=_ref2.onBlur;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_13__.M5,{justifyContent:"center",alignItems:"center",minH:"5ex",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.XZ,{size:"sm",isChecked:!0===value,isIndeterminate:null===value,onChange:function onChange(e){_onChange2(e.target.indeterminate?null:e.target.checked)},onBlur}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_16__.zx,{"aria-label":"Clear filter",onClick:function onClick(){_onChange2(null)},variant:"ghost",size:"xs",rounded:"full",ml:1,p:0,isDisabled:null===value,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_10__.Z,{iconStyle:"s",icon:"ban"})})]})}function SelectColumnFilter(options){return function SelectColumnFilterInner(_ref3){var value=_ref3.value,_onChange3=_ref3.onChange,onBlur=_ref3.onBlur;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_17__.Ph,{size:"sm",value:null!=value?value:"",onChange:function onChange(e){_onChange3(e.target.value||null)},onBlur,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("option",{value:"",children:"All"}),options.map((function(option,i){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("option",{value:"string"==typeof option?option:option.value,children:"string"==typeof option?option:option.label},i)}))]})}}function MultiSelectColumnFilter(options){return function SelectColumnFilterInner(_ref4){var value=_ref4.value,_onChange4=_ref4.onChange,onBlur=_ref4.onBlur;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_13__.xu,{fontSize:"sm",textTransform:"none",maxW:400,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_Chakra_MultiSelect__WEBPACK_IMPORTED_MODULE_11__.ZP,{options,value:null!=value?value:[],onChange:function onChange(e){_onChange4(e)},onBlur})})}}function NumberRangeColumnFilter(min,max){return function NumberRangeColumnFilter(_ref5){var _value$min,_value$max,value=_ref5.value,_onChange5=_ref5.onChange,onBlur=_ref5.onBlur;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_13__.Ug,{justifyContent:"center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_18__.Y2,{size:"sm",value:null!==(_value$min=null==value?void 0:value.min)&&void 0!==_value$min?_value$min:"",onChange:function onChange(val){_onChange5({min:""!==val?parseInt(val,10):void 0,max:null==value?void 0:value.max})},placeholder:"Min ("+min+")",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_18__.zu,{onBlur,style:{width:"70px",marginRight:"0.5rem"}})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_19__.m$.span,{children:"to"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_18__.Y2,{size:"sm",value:null!==(_value$max=null==value?void 0:value.max)&&void 0!==_value$max?_value$max:"",onChange:function onChange(val){_onChange5({max:""!==val?parseInt(val,10):void 0,min:null==value?void 0:value.min})},placeholder:"Max ("+max+")",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_18__.zu,{onBlur,style:{width:"70px",marginLeft:"0.5rem"}})})]})}}TextColumnFilter.displayName="TextColumnFilter",CheckBoxColumnFilter.displayName="CheckBoxColumnFilter";var dateTimeFilterFn=function dateTimeFilterFn(columnIds){return function(rows,_ref6){var valueD=_ref6.value,mode=_ref6.mode;return columnIds.reduce((function(acc,id){var value=valueD.getTime();return"after"===mode?acc.filter((function(row){return Date.parse(row[id])>=value})):"before"===mode?acc.filter((function(row){return Date.parse(row[id])<=value})):(value=Math.round(value/1e3),acc.filter((function(row){return Math.round(Date.parse(row[id])/1e3)===value})))}),rows)}};function DateTimeColumnFilter(_ref7){var _value$mode,_value$value,value=_ref7.value,_onChange6=_ref7.onChange,_onBlur=_ref7.onBlur;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_13__.Ug,{flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",gridRowGap:2,minW:"max-content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_17__.Ph,{size:"sm",width:"auto",value:null!==(_value$mode=null==value?void 0:value.mode)&&void 0!==_value$mode?_value$mode:"",onChange:function onChange(ev){_onChange6(""===ev.target.value?null:value?Object.assign({},value,{mode:ev.target.value}):{value:new Date,mode:ev.target.value})},onBlur:function onBlur(){return _onBlur()},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("option",{value:"",children:"✕"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("option",{value:"after",children:"≥"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("option",{value:"exact",children:"="}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("option",{value:"before",children:"≤"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_Chakra_DateTimePicker__WEBPACK_IMPORTED_MODULE_9__.x,{size:"sm",allowUndefined:!0,value:null!==(_value$value=null==value?void 0:value.value)&&void 0!==_value$value?_value$value:void 0,onChange:function onChange(d){return _onChange6(d?value?Object.assign({},value,{value:d}):{value:d,mode:"after"}:null)},onBlur:function onBlur(){return _onBlur()}})]})}function formatEnumValuePart(part){return 0===part.length?"":part[0]+part.substr(1).toLowerCase()}function formatEnumValue(key){return key.split("_").reduce((function(acc,part){return acc+" "+formatEnumValuePart(part)}),"").substr(1)}DateTimeColumnFilter.displayName="DateTimeColumnFilter";try{TextColumnFilter.displayName="TextColumnFilter",TextColumnFilter.__docgenInfo={description:"",displayName:"TextColumnFilter",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: string | null) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#TextColumnFilter"]={docgenInfo:TextColumnFilter.__docgenInfo,name:"TextColumnFilter",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#TextColumnFilter"})}catch(__react_docgen_typescript_loader_error){}try{CheckBoxColumnFilter.displayName="CheckBoxColumnFilter",CheckBoxColumnFilter.__docgenInfo={description:"",displayName:"CheckBoxColumnFilter",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"boolean | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: boolean | null) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#CheckBoxColumnFilter"]={docgenInfo:CheckBoxColumnFilter.__docgenInfo,name:"CheckBoxColumnFilter",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#CheckBoxColumnFilter"})}catch(__react_docgen_typescript_loader_error){}try{SelectColumnFilter.displayName="SelectColumnFilter",SelectColumnFilter.__docgenInfo={description:"",displayName:"SelectColumnFilter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#SelectColumnFilter"]={docgenInfo:SelectColumnFilter.__docgenInfo,name:"SelectColumnFilter",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#SelectColumnFilter"})}catch(__react_docgen_typescript_loader_error){}try{MultiSelectColumnFilter.displayName="MultiSelectColumnFilter",MultiSelectColumnFilter.__docgenInfo={description:"",displayName:"MultiSelectColumnFilter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#MultiSelectColumnFilter"]={docgenInfo:MultiSelectColumnFilter.__docgenInfo,name:"MultiSelectColumnFilter",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#MultiSelectColumnFilter"})}catch(__react_docgen_typescript_loader_error){}try{DateTimeColumnFilter.displayName="DateTimeColumnFilter",DateTimeColumnFilter.__docgenInfo={description:"",displayName:"DateTimeColumnFilter",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:'{ value: Date; mode: "exact" | "after" | "before"; } | null'}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:'(newValue: { value: Date; mode: "exact" | "after" | "before"; } | null) => void'}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#DateTimeColumnFilter"]={docgenInfo:DateTimeColumnFilter.__docgenInfo,name:"DateTimeColumnFilter",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#DateTimeColumnFilter"})}catch(__react_docgen_typescript_loader_error){}try{formatEnumValuePart.displayName="formatEnumValuePart",formatEnumValuePart.__docgenInfo={description:"",displayName:"formatEnumValuePart",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#formatEnumValuePart"]={docgenInfo:formatEnumValuePart.__docgenInfo,name:"formatEnumValuePart",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#formatEnumValuePart"})}catch(__react_docgen_typescript_loader_error){}try{formatEnumValue.displayName="formatEnumValue",formatEnumValue.__docgenInfo={description:"",displayName:"formatEnumValue",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#formatEnumValue"]={docgenInfo:formatEnumValue.__docgenInfo,name:"formatEnumValue",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#formatEnumValue"})}catch(__react_docgen_typescript_loader_error){}try{dateTimeFilterFn.displayName="dateTimeFilterFn",dateTimeFilterFn.__docgenInfo={description:"",displayName:"dateTimeFilterFn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDComponents.tsx#dateTimeFilterFn"]={docgenInfo:dateTimeFilterFn.__docgenInfo,name:"dateTimeFilterFn",path:"src/aspects/CRUDTable2/CRUDComponents.tsx#dateTimeFilterFn"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/CRUDTable2/CRUDTable2.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>SortDirection,Z:()=>CRUDTable});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.timers.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find-index.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.set.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.reduce-right.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.parse-int.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.number.constructor.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js");var SortDirection,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+system@1.10.3_922a85da57e3646a57465b7970b0de85/node_modules/@chakra-ui/system/dist/chakra-ui-system.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+table@1.3.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/table/dist/chakra-ui-table.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+hooks@1.8.2_react@17.0.2/node_modules/@chakra-ui/hooks/dist/chakra-ui-hooks.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tooltip@1.4.6_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/tooltip/dist/chakra-ui-tooltip.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+checkbox@1.6.5_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/checkbox/dist/chakra-ui-checkbox.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+modal@1.10.7_d24435ba52f1f88b08cc54a1f1d4e56f/node_modules/@chakra-ui/modal/dist/chakra-ui-modal.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+form-control@1.5.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/form-control/dist/chakra-ui-form-control.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+alert@1.3.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/alert/dist/chakra-ui-alert.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+spinner@1.2.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/spinner/dist/chakra-ui-spinner.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+number-input@1.4.2_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/number-input/dist/chakra-ui-number-input.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+select@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/select/dist/chakra-ui-select.esm.js"),react__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_Chakra_CenteredSpinner__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("./src/aspects/Chakra/CenteredSpinner.tsx"),_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx"),_Hooks_useRestorableState__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("./src/aspects/Hooks/useRestorableState.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}!function(SortDirection){SortDirection.Asc="⬆",SortDirection.Dsc="⬇"}(SortDirection||(SortDirection={}));var CRUDCell=react__WEBPACK_IMPORTED_MODULE_32__.forwardRef((function CRUDCell(_ref,ref){var isInCreate=_ref.isInCreate,initialValue=_ref.initialValue,onUpdate=_ref.onUpdate,column=_ref.column,dependentData=_ref.dependentData,record=_ref.record,backgroundColor=_ref.backgroundColor,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(initialValue),2),value=_useState2[0],setValue=_useState2[1],updateTimeoutId=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)(null);(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){setValue(initialValue)}),[initialValue]);var _useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)([]),2),undoStack=_useState4[0],setUndoStack=_useState4[1],backgroundColorToken=_slicedToArray((0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_37__.dQ)("colors",[null!=backgroundColor?backgroundColor:"white.400"]),1)[0],contents=column.cell({isInCreate,ref,value,onKeyUp:column.set&&function(ev){if(ev.ctrlKey&&!ev.shiftKey&&"z"===ev.key&&undoStack.length>0){ev.preventDefault(),ev.stopPropagation(),setUndoStack((function(old){return old.slice(0,old.length-1)}));var prev=undoStack[undoStack.length-1];setValue(prev)}},onBlur:onUpdate&&column.set&&function(ev){value!==initialValue&&(null!==updateTimeoutId.current&&(clearTimeout(updateTimeoutId.current),updateTimeoutId.current=null),onUpdate(value,ev.relatedTarget),ev.stopPropagation())},onChange:onUpdate&&column.set&&function(newValue){setValue(newValue),setUndoStack((function(p){return[].concat(_toConsumableArray(p),[newValue]).slice(Math.max(0,p.length-10),p.length)})),null!==updateTimeoutId.current&&(clearTimeout(updateTimeoutId.current),updateTimeoutId.current=null),updateTimeoutId.current=setTimeout((function(){updateTimeoutId.current=null,newValue!==initialValue&&onUpdate(newValue)}),1e3)},dependentData,staleRecord:record});return contents?isInCreate?contents:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{padding:1,minW:"max-content",style:{backgroundColor:backgroundColor?backgroundColorToken:void 0},children:contents}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.Fragment,{})}));function CRUDRow(_ref2){var _invalidReason$reason,record=_ref2.record,row=_ref2.row,columns=_ref2.columns,focusOnColumn=_ref2.focusOnColumn,onSelectChange=_ref2.onSelectChange,beginInsert=_ref2.beginInsert,onUpdate=_ref2.onUpdate,onDelete=_ref2.onDelete,onSecondaryEdit=_ref2.onSecondaryEdit,getIsSelectedRef=_ref2.getIsSelected,setIsSelectedRef=_ref2.setIsSelected,dependentData=_ref2.dependentData,isSaved=_ref2.isSaved,refs=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return columns.map((function(_column){return react__WEBPACK_IMPORTED_MODULE_32__.createRef()}))}),[columns]),doFocusOnColumn=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(columnId){var _refs$idx,_refs$idx$current,idx=columns.findIndex((function(column){return column.id===columnId}));idx>-1&&(null===(_refs$idx=refs[idx])||void 0===_refs$idx||null===(_refs$idx$current=_refs$idx.current)||void 0===_refs$idx$current||_refs$idx$current.focus())}),[columns,refs]);focusOnColumn.current=doFocusOnColumn;var _useState6=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(record),2),localRecord=_useState6[0],setLocalRecord=_useState6[1];(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){setLocalRecord(record)}),[record]);var rowRef=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)(null),_useState8=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(!1),2),modified=_useState8[0],setIsModified=_useState8[1];(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){isSaved&&setIsModified(!1)}),[isSaved]);var _useState10=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(null),2),invalidReason=_useState10[0],setInvalidReason=_useState10[1],_useDisclosure=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_39__.qY)(),isOpen=_useDisclosure.isOpen,onOpen=_useDisclosure.onOpen,onClose=_useDisclosure.onClose,_onBlur=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(newRecord,relatedTarget){var _rowRef$current,_rowRef$current2;if(document.hasFocus()&&(!relatedTarget||null===(_rowRef$current=rowRef.current)||void 0===_rowRef$current||!_rowRef$current.contains(relatedTarget))&&(null===(_rowRef$current2=rowRef.current)||void 0===_rowRef$current2||!_rowRef$current2.contains(document.activeElement))&&"continue-editing"!==(null==relatedTarget?void 0:relatedTarget.id)&&"reset"!==(null==relatedTarget?void 0:relatedTarget.id)&&record!==newRecord){var _row$invalid,invld=null===(_row$invalid=row.invalid)||void 0===_row$invalid?void 0:_row$invalid.call(row,newRecord,!1,dependentData);setIsModified(!0),invld?(setInvalidReason(invld),onOpen()):(setInvalidReason(null),setLocalRecord(newRecord),null==onUpdate||onUpdate(newRecord))}}),[dependentData,onOpen,onUpdate,record,row]),green=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_40__.ff)("purple.100","purple.700"),red=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_40__.ff)("red.100","red.700"),cellEls=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return columns.map((function(column,index){var _row$colour,colSet=column.set;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(CRUDCell,{isInCreate:!1,initialValue:column.get(localRecord),ref:refs[index],column,onUpdate:onUpdate&&colSet&&function(newValue,relatedTarget){var modified=Object.assign({},localRecord);colSet(modified,newValue),setLocalRecord(modified),_onBlur(modified,relatedTarget)},dependentData,record:localRecord,backgroundColor:modified?invalidReason?red:green:null===(_row$colour=row.colour)||void 0===_row$colour?void 0:_row$colour.call(row,localRecord)},row.getKey(localRecord)+"_"+index)}))}),[columns,dependentData,green,invalidReason,localRecord,modified,_onBlur,onUpdate,red,refs,row]),_useState12=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(!1),2),isSelected=_useState12[0],setIsSelected=_useState12[1],getIsSelectedCb=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(){return isSelected}),[isSelected]);getIsSelectedRef&&(getIsSelectedRef.current=getIsSelectedCb),setIsSelectedRef&&(setIsSelectedRef.current=setIsSelected);var selectEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){var _row$canSelect,_row$canSelect2,canSelect=null===(_row$canSelect=null===(_row$canSelect2=row.canSelect)||void 0===_row$canSelect2?void 0:_row$canSelect2.call(row,record))||void 0===_row$canSelect||_row$canSelect;return onSelectChange&&(getIsSelectedRef||setIsSelectedRef)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{padding:1,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_41__.u,{label:!0!==canSelect?canSelect:void 0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{w:"100%",h:"100%",padding:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_43__.XZ,{"aria-label":"Select row",isChecked:isSelected,onChange:function onChange(ev){setIsSelected(ev.target.checked),null==onSelectChange||onSelectChange(ev.target.checked)},isDisabled:!0!==canSelect})})})}):void 0}),[getIsSelectedRef,isSelected,onSelectChange,record,row,setIsSelectedRef]),warning=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){var _row$warning;return null===(_row$warning=row.warning)||void 0===_row$warning?void 0:_row$warning.call(row,localRecord)}),[localRecord,row]),editEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return onSecondaryEdit?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{padding:1,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{w:"100%",h:"100%",padding:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_41__.u,{label:null!=warning?warning:"Edit hidden fields",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{"aria-label":"Edit hidden fields",size:"xs",onClick:function onClick(){return onSecondaryEdit()},colorScheme:warning?"yellow":"blue",children:warning?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__.Z,{iconStyle:"s",icon:"exclamation-triangle",mr:1}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__.Z,{iconStyle:"s",icon:"edit"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__.Z,{iconStyle:"s",icon:"edit"})})})})}):beginInsert?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{}):void 0}),[beginInsert,onSecondaryEdit,warning]),deleteEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){var _row$canDelete,_row$canDelete2,canDelete=null===(_row$canDelete=null===(_row$canDelete2=row.canDelete)||void 0===_row$canDelete2?void 0:_row$canDelete2.call(row,record))||void 0===_row$canDelete||_row$canDelete;return onDelete?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{padding:1,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_41__.u,{label:!0!==canDelete?canDelete:void 0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{w:"100%",h:"100%",padding:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{"aria-label":"Delete row",colorScheme:"red",size:"xs",onClick:function onClick(){return onDelete()},isDisabled:!0!==canDelete,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__.Z,{iconStyle:"s",icon:"trash-alt"})})})})}):void 0}),[onDelete,record,row]),leastDestructiveRef=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)(null),onCloseAlert=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(reset){onClose(),reset?(setInvalidReason(null),setIsModified(!1),setLocalRecord(record)):setTimeout((function(){var _invalidReason$column;return doFocusOnColumn(null!==(_invalidReason$column=null==invalidReason?void 0:invalidReason.columnId)&&void 0!==_invalidReason$column?_invalidReason$column:"")}),100)}),[doFocusOnColumn,null==invalidReason?void 0:invalidReason.columnId,onClose,record]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Tr,{onBlur:function onBlur(ev){_onBlur(localRecord,ev.relatedTarget)},ref:rowRef,children:[selectEl,editEl,cellEls,deleteEl,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.aR,{isOpen,onClose:function onClose(){return onCloseAlert(!0)},leastDestructiveRef,returnFocusOnClose:!1,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.dh,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__._T,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.fY,{children:"Changes are invalid"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.iP,{children:null!==(_invalidReason$reason=null==invalidReason?void 0:invalidReason.reason)&&void 0!==_invalidReason$reason?_invalidReason$reason:"Reason has not been programmed - oops! Please report this issue to us."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.xo,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{id:"reset",onClick:function onClick(){return onCloseAlert(!0)},children:"Reset"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{id:"continue-editing",colorScheme:"purple",onClick:function onClick(){return onCloseAlert(!1)},ref:leastDestructiveRef,children:"Continue editing"})]})]})})})]})}function CRUDColumnHeading(_ref3){var _column$defaultSortDi,column=_ref3.column,visibleData=_ref3.visibleData,applySorting=_ref3.applySorting,applyFilter=_ref3.applyFilter,_useState14=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(null),2),filterValue=_useState14[0],setFilterValue=_useState14[1],filterChangeTimeoutId=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)(null),_useState16=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(null!==(_column$defaultSortDi=column.defaultSortDirection)&&void 0!==_column$defaultSortDi?_column$defaultSortDi:null),2),sortDir=_useState16[0],setSortDir=_useState16[1],header="function"==typeof column.header?column.header({visibleData,onClick:function onClick(){sortDir===SortDirection.Asc?(setSortDir(SortDirection.Dsc),applySorting(column.id,SortDirection.Dsc)):sortDir===SortDirection.Dsc?(setSortDir(null),applySorting(column.id,null)):(setSortDir(SortDirection.Asc),applySorting(column.id,SortDirection.Asc))},sortDir,isInCreate:!1}):column.header;return header?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.gC,{justifyContent:"flex-start",alignItems:"stretch",h:"100%",children:[header,column.filterEl?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.xu,{children:column.filterEl({value:filterValue,onChange:function onChange(newV){setFilterValue(newV),null!==filterChangeTimeoutId.current&&(clearTimeout(filterChangeTimeoutId.current),filterChangeTimeoutId.current=null),filterChangeTimeoutId.current=setTimeout((function(){applyFilter(column.id,newV)}),250)},onBlur:function onBlur(){null!==filterChangeTimeoutId.current&&(clearTimeout(filterChangeTimeoutId.current),filterChangeTimeoutId.current=null),applyFilter(column.id,filterValue)}})}):void 0]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.Fragment,{})}function RenderedCRUDTable(_ref4){var fullDataLength=_ref4.fullDataLength,filteredDataLength=_ref4.filteredDataLength,data=_ref4.data,columns=_ref4.columns,row=_ref4.row,applySorting=_ref4.applySorting,applyFilter=_ref4.applyFilter,beginInsert=_ref4.beginInsert,onEdit=_ref4.onEdit,onUpdate=_ref4.onUpdate,onDelete=_ref4.onDelete,focusOnRow=_ref4.focusOnRow,dependentData=_ref4.dependentData,isSaving=_ref4.isSaving,buttons=_ref4.buttons,enableSelection=!!onDelete||buttons,_useState18=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(new Set),2),selectedKeys=_useState18[0],setSelectedKeys=_useState18[1],columnEls=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return!1!==data?columns.map((function(column){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Th,{padding:1,verticalAlign:"top",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(CRUDColumnHeading,{column,visibleData:data,applyFilter,applySorting})},column.id)})):void 0}),[applyFilter,applySorting,columns,data]),rowFocusRefs=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return data?data.map((function(_record){return react__WEBPACK_IMPORTED_MODULE_32__.createRef()})):[]}),[data]),getIsSelectedRefs=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return data?data.map((function(_record){return react__WEBPACK_IMPORTED_MODULE_32__.createRef()})):[]}),[data]),setIsSelectedRefs=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return data?data.map((function(_record){return react__WEBPACK_IMPORTED_MODULE_32__.createRef()})):[]}),[data]);(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){var _step,_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(setIsSelectedRefs);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _ref$current,ref=_step.value;null===(_ref$current=ref.current)||void 0===_ref$current||_ref$current.call(ref,!1)}}catch(err){_iterator.e(err)}finally{_iterator.f()}setSelectedKeys(new Set)}),[data,setIsSelectedRefs]);var selectColumnEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return enableSelection?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Th,{padding:1,verticalAlign:"bottom",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{w:"100%",h:"100%",padding:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_43__.XZ,{isIndeterminate:!!data&&selectedKeys.size>0&&selectedKeys.size<data.length,isChecked:!!data&&selectedKeys.size===data.length,onChange:data?function(ev){ev.target.checked?(setSelectedKeys(new Set(data.map(row.getKey))),setIsSelectedRefs.forEach((function(ref){var _ref$current2;return null==ref||null===(_ref$current2=ref.current)||void 0===_ref$current2?void 0:_ref$current2.call(ref,!0)}))):(setSelectedKeys(new Set),setIsSelectedRefs.forEach((function(ref){var _ref$current3;return null==ref||null===(_ref$current3=ref.current)||void 0===_ref$current3?void 0:_ref$current3.call(ref,!1)})))}:void 0})})}):void 0}),[data,enableSelection,row.getKey,selectedKeys.size,setIsSelectedRefs]),editColumnEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return beginInsert||onEdit?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Th,{padding:1,verticalAlign:"top",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{w:"100%",h:"100%",padding:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{"aria-label":"Create row",isDisabled:!beginInsert,onClick:function onClick(){null==beginInsert||beginInsert()},size:"xs",colorScheme:"green",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__.Z,{iconStyle:"s",icon:"plus"})})})}):void 0}),[beginInsert,onEdit]),deleteColumnEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return onDelete?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Th,{padding:1,verticalAlign:"top",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{w:"100%",h:"100%",padding:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_41__.u,{label:"Delete selected",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{"aria-label":"Delete row",onClick:function onClick(){var deletableKeys=_toConsumableArray(selectedKeys.values()).filter((function(key){var _row$canDelete3,_row$canDelete4;if(!row.canDelete)return!0;var record=data&&data.find((function(x){return row.getKey(x)===key}));return!!record&&!0===(null===(_row$canDelete3=null===(_row$canDelete4=row.canDelete)||void 0===_row$canDelete4?void 0:_row$canDelete4.call(row,record))||void 0===_row$canDelete3||_row$canDelete3)}));onDelete(deletableKeys)},size:"xs",colorScheme:"red",isDisabled:0===selectedKeys.size,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_FAIcon__WEBPACK_IMPORTED_MODULE_34__.Z,{iconStyle:"s",icon:"trash-alt"})})})})}):void 0}),[onDelete,selectedKeys,row,data]),doFocusOnRow=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(key,columnId){if(data){var _rowFocusRefs$idx,_rowFocusRefs$idx$cur,idx=data.findIndex((function(record){return row.getKey(record)===key}));if(idx>-1)null===(_rowFocusRefs$idx=rowFocusRefs[idx])||void 0===_rowFocusRefs$idx||null===(_rowFocusRefs$idx$cur=_rowFocusRefs$idx.current)||void 0===_rowFocusRefs$idx$cur||_rowFocusRefs$idx$cur.call(_rowFocusRefs$idx,columnId)}}),[data,row,rowFocusRefs]);focusOnRow.current=doFocusOnRow;var rowEls=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return data?data.map((function(record,index){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(CRUDRow,{record,isSaved:!isSaving,row,columns,beginInsert,onSelectChange:enableSelection?function(isSelected){var key=row.getKey(record);setSelectedKeys((function(old){var newKeys=new Set(old);return isSelected?newKeys.add(key):newKeys.delete(key),newKeys}))}:void 0,onSecondaryEdit:onEdit&&function(){return onEdit(row.getKey(record))},onUpdate,onDelete:onDelete&&function(){onDelete([row.getKey(record)])},focusOnColumn:rowFocusRefs[index],getIsSelected:getIsSelectedRefs[index],setIsSelected:setIsSelectedRefs[index],dependentData},row.getKey(record))})):void 0}),[beginInsert,columns,data,dependentData,enableSelection,getIsSelectedRefs,isSaving,onDelete,onEdit,onUpdate,row,rowFocusRefs,setIsSelectedRefs]),noDataEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return null===data?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Tr,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{colSpan:9,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.M5,{m:2,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.xv,{children:"No data"})})})}):void 0}),[data]),loadingDataEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return!1===data?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Tr,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Td,{colSpan:9,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_Chakra_CenteredSpinner__WEBPACK_IMPORTED_MODULE_33__.Z,{centerProps:{m:2,h:"auto"},spinnerProps:{label:"Loading schedule data"},caller:"CRUDTable2:862"})})}):void 0}),[data]),buttonEls=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){var selectedData=data?data.filter((function(x){return selectedKeys.has(row.getKey(x))})):[];return buttons.map((function(button,idx){return button.render({selectedData,key:idx.toString()})}))}),[buttons,data,row,selectedKeys]),bgColour=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_40__.ff)("gray.50","gray.900"),headerBottomColour=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_40__.ff)("gray.500","gray.400");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.Ug,{flexWrap:"wrap",justifyContent:"flex-start",w:"100%",my:4,children:buttonEls}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.xu,{flexDir:"column",mb:4,children:["Filtered to ",filteredDataLength," out of ",fullDataLength," (",selectedKeys.size," selected)"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_37__.m$.div,{maxWidth:"100%",minHeight:"10em",width:"auto",overflow:"auto",pr:8,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.iA,{bgColor:bgColour,size:"sm",variant:"striped",pt:1,colorScheme:"gray",width:"max-content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.hr,{borderBottom:"2px solid",borderBottomColor:headerBottomColour,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.Tr,{children:[selectColumnEl,editColumnEl,columnEls,deleteColumnEl]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_38__.p3,{children:[rowEls,noDataEl,loadingDataEl]})]})})]})}function clampPageIndex(data,pageSize,index){if("all"===pageSize)return null!==index?1:null;var pageCount=data?Math.ceil(data.length/pageSize):1;return null!==index?Math.max(0,Math.min(pageCount-1,index)):null}function mergeData(row,data,updatedData){var keys=new Set(Object.keys(updatedData.current)),result=data?data.map((function(record){var key=row.getKey(record);return updatedData.current[key]?(keys.delete(key),updatedData.current[key]):record})):data;return result?[].concat(_toConsumableArray(result),_toConsumableArray(_toConsumableArray(keys.values()).map((function(key){return updatedData.current[key]})))):result}function CRUDInsertModal(_ref5){var isOpen=_ref5.isOpen,onClose=_ref5.onClose,onCreate=_ref5.onCreate,defaultData=_ref5.defaultData,row=_ref5.row,columns=_ref5.columns,dependentData=_ref5.dependentData,_useState20=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)({}),2),newData=_useState20[0],setNewData=_useState20[1];(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){setNewData(defaultData)}),[defaultData]);var cellEls=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return columns.map((function(column,index){var _row$colour2,colSet=column.set,header="function"==typeof column.header?column.header({onClick:function onClick(){},sortDir:null,visibleData:[],isInCreate:!0}):column.header;return header&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_46__.NI,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_46__.lX,{children:header}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(CRUDCell,{isInCreate:!0,initialValue:column.get(newData),column,onUpdate:colSet&&function(newValue){var modified=Object.assign({},newData);colSet(modified,newValue),setNewData(modified)},dependentData,record:newData,backgroundColor:null===(_row$colour2=row.colour)||void 0===_row$colour2?void 0:_row$colour2.call(row,newData)})]},row.getKey(newData)+"_"+index)}))}),[columns,dependentData,newData,row]),invld=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){var _row$invalid2;return null===(_row$invalid2=row.invalid)||void 0===_row$invalid2?void 0:_row$invalid2.call(row,newData,!0,dependentData)}),[dependentData,newData,row]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.u_,{isOpen,onClose,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.ZA,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.hz,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.xB,{children:["Create new",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.ol,{onClick:onClose})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.fe,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.gC,{spacing:4,children:cellEls})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.mz,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.hE,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{onClick:onClose,children:"Cancel"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_41__.u,{label:invld?invld.reason:void 0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.xu,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{colorScheme:"green",onClick:function onClick(){var _row$invalid3;null!==(_row$invalid3=row.invalid)&&void 0!==_row$invalid3&&_row$invalid3.call(row,newData,!0,dependentData)||!onCreate(newData)||onClose()},isDisabled:!!invld,children:"Create"})})})]})})]})]})}function CRUDTable(_ref6){var _row$pages,data=_ref6.data,alert=_ref6.alert,columns=_ref6.columns,row=_ref6.row,tableUniqueName=_ref6.tableUniqueName,forceReload=_ref6.forceReload,insertProps=_ref6.insert,editProps=_ref6.edit,updateProps=_ref6.update,deleteProps=_ref6.delete,_ref6$pageSizes=_ref6.pageSizes,pageSizes=void 0===_ref6$pageSizes?[10,20,30,40,50,"all"]:_ref6$pageSizes,buttons=_ref6.buttons,_useState22=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(!1),2),currentData=_useState22[0],setCurrentData=_useState22[1],_useState24=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(columns.reduce((function(acc,col){var _Object$assign;return col.defaultSortDirection?Object.assign({},acc,((_Object$assign={})[col.id]=col.defaultSortDirection,_Object$assign)):acc}),{})),2),sortColumns=_useState24[0],setSortColumns=_useState24[1],_useState26=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)({}),2),filterColumns=_useState26[0],setFilterColumns=_useState26[1],_useState28=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(null),2),pageIndex=_useState28[0],setPageIndex=_useState28[1],_useRestorableState2=_slicedToArray((0,_Hooks_useRestorableState__WEBPACK_IMPORTED_MODULE_35__.aX)("CRUDTable_PageSize_"+tableUniqueName,10,(function(x){return"all"===x?"all":x.toString()}),(function(x){return"all"===x?pageSizes[0]:parseInt(x,10)})),2),pageSize=_useRestorableState2[0],setPageSize=_useRestorableState2[1],_useState30=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(!1),2),sortedData=_useState30[0],setSortedData=_useState30[1],_useState32=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(!1),2),filteredData=_useState32[0],setFilteredData=_useState32[1],_useState34=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(!1),2),paginatedData=_useState34[0],setPaginatedData=_useState34[1],updatedData=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)({}),_useState36=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)(new Map),2),dependentData=_useState36[0],setDependentData=_useState36[1];(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){if(!1===currentData&&"object"==typeof data){setCurrentData(data),updatedData.current={};var dependentColumns=columns.filter((function(x){return x.isDataDependency})),depData=new Map;null==data||data.forEach((function(record){var result={};dependentColumns.forEach((function(column){result[column.id]=column.get(record)})),depData.set(row.getKey(record),result)})),setDependentData(depData)}}),[columns,currentData,data,row]);var forceReloadCb=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(){setCurrentData("object"==typeof data?data:null),updatedData.current={}}),[data]);forceReload&&(forceReload.current=forceReloadCb),(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){var mergedData=mergeData(row,currentData,updatedData),sorted=function computeSortedData(columns,sortColumns,inputData){return Object.keys(sortColumns).map((function(columnId){return{spec:columns.find((function(column){return column.id===columnId})),dir:sortColumns[columnId]}})).filter((function(x){return!!x.spec&&!!x.spec.sort})).reduceRight((function(records,sorting){var _records$sort;return records?null!==(_records$sort=records.sort((function(x,y){var _sorting$spec$sort,_sorting$spec$sort2,_sorting$spec,sortVal=null!==(_sorting$spec$sort=null===(_sorting$spec$sort2=(_sorting$spec=sorting.spec).sort)||void 0===_sorting$spec$sort2?void 0:_sorting$spec$sort2.call(_sorting$spec,sorting.spec.get(x),sorting.spec.get(y)))&&void 0!==_sorting$spec$sort?_sorting$spec$sort:0;return sorting.dir===SortDirection.Asc?sortVal:-sortVal})))&&void 0!==_records$sort?_records$sort:null:records}),inputData?_toConsumableArray(inputData):inputData)}(columns,sortColumns,mergedData);setSortedData(sorted)}),[columns,currentData,row,sortColumns]),(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){var mergedData=mergeData(row,sortedData,updatedData),filtered=function computeFilteredData(columns,filterColumns,inputData){var filters=Object.keys(filterColumns).map((function(columnId){return{spec:columns.find((function(column){return column.id===columnId})),val:filterColumns[columnId]}})).filter((function(x){return!!x.spec&&!!x.spec.filterFn}));return inputData?filters.reduce((function(records,filter){var _filter$spec$filterFn,_filter$spec$filterFn2,_filter$spec;return null===filter.val?records:null!==(_filter$spec$filterFn=null===(_filter$spec$filterFn2=(_filter$spec=filter.spec).filterFn)||void 0===_filter$spec$filterFn2?void 0:_filter$spec$filterFn2.call(_filter$spec,records,filter.val))&&void 0!==_filter$spec$filterFn?_filter$spec$filterFn:records}),_toConsumableArray(inputData)):inputData}(columns,filterColumns,mergedData);setFilteredData(filtered)}),[columns,filterColumns,row,sortedData]),(0,react__WEBPACK_IMPORTED_MODULE_32__.useEffect)((function(){var mergedData=mergeData(row,filteredData,updatedData),clampedPageIndex=clampPageIndex(mergedData,pageSize,pageIndex),paginated=function computePaginatedData(row,pageIndex,pageSize,inputData){if(inputData&&row.pages&&"all"!==pageSize){if(null===pageIndex){if(row.pages.defaultToLast){var start=inputData.length-inputData.length%pageSize;return inputData.slice(start,inputData.length)}return inputData.slice(0,Math.min(inputData.length,pageSize))}var _start=pageIndex*pageSize,end=(1+pageIndex)*pageSize,startBounded=Math.max(0,Math.min(_start,inputData.length-inputData.length%pageSize)),endBounded=Math.min(end,inputData.length);return inputData.slice(startBounded,endBounded)}return inputData}(row,clampedPageIndex,pageSize,mergedData);setPaginatedData(paginated)}),[filteredData,pageIndex,pageSize,row,sortedData]);var applySorting=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(columnId,direction){setSortColumns(null===direction?function(old){var newCols=Object.assign({},old);return delete newCols[columnId],newCols}:function(old){var _Object$assign2;return Object.assign({},old,((_Object$assign2={})[columnId]=direction,_Object$assign2))})}),[]),applyFilter=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(columnId,value){setFilterColumns(null===value?function(old){var newCols=Object.assign({},old);return delete newCols[columnId],newCols}:function(old){var _Object$assign3;return Object.assign({},old,((_Object$assign3={})[columnId]=value,_Object$assign3))})}),[]),goToPage=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(nextIndex){setCurrentData(data),updatedData.current={},setPageIndex(clampPageIndex(data,pageSize,nextIndex))}),[data,pageSize]),startInsert=null==insertProps?void 0:insertProps.start,insertRecord=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(record){setPaginatedData((function(old){return old?[].concat(_toConsumableArray(old),[record]):[record]})),updatedData.current[row.getKey(record)]=record,setDependentData((function(old){var dependentColumns=columns.filter((function(x){return x.isDataDependency}));if(dependentColumns.length>0){var newMap=new Map(old),result={};return dependentColumns.forEach((function(column){result[column.id]=column.get(record)})),newMap.set(row.getKey(record),result),newMap}return old})),null==startInsert||startInsert(record)}),[columns,row,startInsert]),startUpdate=null==updateProps?void 0:updateProps.start,updateRecord=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(record){updatedData.current[row.getKey(record)]=record,setDependentData((function(old){var dependentColumns=columns.filter((function(x){return x.isDataDependency}));if(dependentColumns.length>0){var foundDifference=!1,newMap=new Map(old),_key=row.getKey(record),existing=newMap.get(_key);if(existing)dependentColumns.forEach((function(column){var newVal=column.get(record);foundDifference=foundDifference||existing[column.id]!==newVal,existing[column.id]=newVal}));else{foundDifference=!0;var result={};dependentColumns.forEach((function(column){result[column.id]=column.get(record)})),newMap.set(_key,result)}return foundDifference?newMap:old}return old})),null==startUpdate||startUpdate(record)}),[columns,row,startUpdate]),startDelete=null==deleteProps?void 0:deleteProps.start,keysToDelete=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)([]),_useDisclosure2=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_39__.qY)(),isDeleteConfirmOpen=_useDisclosure2.isOpen,onDeleteConfirmOpen=_useDisclosure2.onOpen,onDeleteConfirmClose=_useDisclosure2.onClose,beginDeleteRecords=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return startDelete&&function(keys){keysToDelete.current=keys,onDeleteConfirmOpen()}}),[onDeleteConfirmOpen,startDelete]),deleteRecords=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(){var keys=keysToDelete.current;keysToDelete.current=[],keys.forEach((function(key){delete updatedData.current[key]})),setCurrentData((function(old){return old?old.filter((function(x){return!keys.includes(row.getKey(x))})):old})),setDependentData((function(old){if(columns.filter((function(x){return x.isDataDependency})).length>0){var newMap=new Map(old);return keys.forEach((function(key){newMap.delete(key)})),newMap}return old})),null==startDelete||startDelete(keys)}),[columns,startDelete,row]),_useDisclosure3=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_39__.qY)(),isInsertModalOpen=_useDisclosure3.isOpen,openInsertModal=_useDisclosure3.onOpen,closeInsertModal=_useDisclosure3.onClose,_useState38=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_32__.useState)({}),2),defaultNewData=_useState38[0],setDefaultNewData=_useState38[1],beginInsert=(0,react__WEBPACK_IMPORTED_MODULE_32__.useCallback)((function(){insertProps&&(setDefaultNewData(insertProps.generateDefaults()),openInsertModal())}),[insertProps,openInsertModal]),focusOnRow=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)(null),renderedTable=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){var _ref7;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(RenderedCRUDTable,{fullDataLength:currentData?currentData.length:0,filteredDataLength:filteredData?filteredData.length:0,data:paginatedData,row,columns,applySorting,applyFilter,beginInsert:insertProps&&beginInsert,onEdit:null==editProps?void 0:editProps.open,onUpdate:updateRecord,onDelete:beginDeleteRecords,focusOnRow,dependentData,isSaving:null!==(_ref7=(null==insertProps?void 0:insertProps.ongoing)||(null==updateProps?void 0:updateProps.ongoing))&&void 0!==_ref7&&_ref7,buttons:null!=buttons?buttons:[]})}),[applyFilter,applySorting,beginDeleteRecords,beginInsert,buttons,columns,currentData,dependentData,null==editProps?void 0:editProps.open,filteredData,insertProps,paginatedData,row,null==updateProps?void 0:updateProps.ongoing,updateRecord]),pageCount=filteredData&&row.pages&&"all"!==pageSize?Math.ceil(filteredData.length/pageSize):1,pageNumber=null!==pageIndex?pageIndex+1:null!==(_row$pages=row.pages)&&void 0!==_row$pages&&_row$pages.defaultToLast?pageCount:1,canPreviousPage=pageNumber>1,canNextPage=pageNumber<pageCount,alertEl=(0,react__WEBPACK_IMPORTED_MODULE_32__.useMemo)((function(){return alert?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_47__.bZ,{status:alert.status,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_47__.Cd,{children:alert.title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_47__.X,{children:alert.description})]}):void 0}),[alert]),cancelDeleteRef=(0,react__WEBPACK_IMPORTED_MODULE_32__.useRef)(null);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.Fragment,{children:[alertEl,null!=insertProps&&insertProps.ongoing||null!=updateProps&&updateProps.ongoing||null!=deleteProps&&deleteProps.ongoing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.Ug,{w:"100%",alignItems:"flex-start",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_48__.$,{size:"xs",label:"Saving changes…"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.xv,{fontSize:"sm",children:["Saving changes","…"]})]}):void 0,renderedTable,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.aR,{isOpen:isDeleteConfirmOpen,leastDestructiveRef:cancelDeleteRef,onClose:onDeleteConfirmClose,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.dh,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__._T,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.fY,{fontSize:"lg",fontWeight:"bold",children:"Delete?"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.iP,{children:"Are you sure? You can‘t undo this action."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_45__.xo,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{ref:cancelDeleteRef,onClick:onDeleteConfirmClose,children:"Cancel"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{colorScheme:"red",onClick:function onClick(){onDeleteConfirmClose(),deleteRecords()},ml:3,children:"Delete"})]})]})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(CRUDInsertModal,{row,columns,defaultData:defaultNewData,isOpen:isInsertModalOpen,onClose:closeInsertModal,onCreate:function onCreate(d){if(insertProps){var whole=insertProps.makeWhole(d);if(void 0!==whole)return insertRecord(whole),!0}return!1},dependentData}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.kC,{justifyContent:"flex-start",alignItems:"center",gridGap:2,w:"100%",flexDir:"row",flexWrap:"wrap",my:"4px",pb:"4px",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.hE,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{onClick:function onClick(){return goToPage(0)},disabled:!canPreviousPage,children:"<<"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{onClick:function onClick(){return goToPage(pageNumber-2)},disabled:!canPreviousPage,children:"<"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{onClick:function onClick(){return goToPage(pageNumber)},disabled:!canNextPage,children:">"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_44__.zx,{onClick:function onClick(){return goToPage(pageCount-1)},disabled:!canNextPage,children:">>"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.xu,{flexBasis:"auto",flexShrink:0,children:["Page"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_37__.m$.strong,{children:[pageNumber," of ",pageCount]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_42__.Ug,{alignItems:"center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_37__.m$.span,{flexBasis:"auto",flexShrink:0,children:["| Go to page:"," "]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_49__.Y2,{defaultValue:pageIndex?pageIndex+1:0,onChange:function onChange(value){var page=value?Number(value)-1:0;goToPage(page)},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_49__.zu,{style:{width:"100px"}})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_50__.Ph,{value:pageSize,onChange:function onChange(e){setPageSize("all"===e.target.value?"all":Number(e.target.value))},maxW:125,children:pageSizes.map((function(pageSize){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_36__.jsxs)("option",{value:pageSize,children:["Show ",pageSize]},pageSize)}))})]})]})}CRUDRow.displayName="CRUDRow",CRUDInsertModal.displayName="CRUDInsertModal";try{CRUDTable2.displayName="CRUDTable2",CRUDTable2.__docgenInfo={description:"",displayName:"CRUDTable2",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"false | T[] | null"}},alert:{defaultValue:null,description:"",name:"alert",required:!1,type:{name:'{ title: string; description: string; status: "error" | "info" | "warning"; }'}},columns:{defaultValue:null,description:"",name:"columns",required:!0,type:{name:"ColumnSpecification<T, any, any>[]"}},row:{defaultValue:null,description:"",name:"row",required:!0,type:{name:"RowSpecification<T>"}},tableUniqueName:{defaultValue:null,description:"",name:"tableUniqueName",required:!0,type:{name:"string"}},forceReload:{defaultValue:null,description:"",name:"forceReload",required:!1,type:{name:"MutableRefObject<() => void>"}},insert:{defaultValue:null,description:"",name:"insert",required:!1,type:{name:"Insert<T>"}},edit:{defaultValue:null,description:"",name:"edit",required:!1,type:{name:"{ open: (key: string) => void; }"}},update:{defaultValue:null,description:"",name:"update",required:!1,type:{name:"Update<T>"}},delete:{defaultValue:null,description:"",name:"delete",required:!1,type:{name:"Delete<T>"}},pageSizes:{defaultValue:{value:'[10, 20, 30, 40, 50, "all"]'},description:"",name:"pageSizes",required:!1,type:{name:'(number | "all")[]'}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"ExtraButton<T>[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDTable2/CRUDTable2.tsx#CRUDTable2"]={docgenInfo:CRUDTable2.__docgenInfo,name:"CRUDTable2",path:"src/aspects/CRUDTable2/CRUDTable2.tsx#CRUDTable2"})}catch(__react_docgen_typescript_loader_error){}},"../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.reduce-right.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/export.js"),$reduceRight=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/array-reduce.js").right,arrayMethodIsStrict=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/array-method-is-strict.js"),CHROME_VERSION=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/engine-v8-version.js"),IS_NODE=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/engine-is-node.js");$({target:"Array",proto:!0,forced:!arrayMethodIsStrict("reduceRight")||!IS_NODE&&CHROME_VERSION>79&&CHROME_VERSION<83},{reduceRight:function reduceRight(callbackfn){return $reduceRight(this,callbackfn,arguments.length,arguments.length>1?arguments[1]:void 0)}})}}]);