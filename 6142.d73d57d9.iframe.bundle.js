"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[6142],{"./src/aspects/Conference/Attend/Profile/EditProfilePage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>EditProfilePage});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.every.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.timers.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.promise.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.number.to-fixed.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.starts-with.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.trim-start.js");var chakra_ui_icons_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+icons@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icons/dist/chakra-ui-icons.esm.js"),chakra_ui_toast_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+toast@1.5.4_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/toast/dist/chakra-ui-toast.esm.js"),chakra_ui_spinner_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+spinner@1.2.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/spinner/dist/chakra-ui-spinner.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),chakra_ui_form_control_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+form-control@1.5.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/form-control/dist/chakra-ui-form-control.esm.js"),chakra_ui_input_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+input@1.4.1_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/input/dist/chakra-ui-input.esm.js"),chakra_ui_number_input_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+number-input@1.4.2_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/number-input/dist/chakra-ui-number-input.esm.js"),chakra_ui_textarea_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+textarea@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/textarea/dist/chakra-ui-textarea.esm.js"),chakra_ui_alert_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+alert@1.3.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/alert/dist/chakra-ui-alert.esm.js"),chakra_ui_button_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js"),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),graphql=__webpack_require__("./src/generated/graphql.tsx"),chakra_ui_color_mode_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.some.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js")),chakra_ui_modal_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+modal@1.10.7_d24435ba52f1f88b08cc54a1f1d4e56f/node_modules/@chakra-ui/modal/dist/chakra-ui-modal.esm.js"),es=__webpack_require__("../node_modules/.pnpm/react-color@2.19.3_react@17.0.2/node_modules/react-color/es/index.js"),ProfileBadge=__webpack_require__("./src/aspects/Badges/ProfileBadge.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function BadgeColourModal(_ref){var badge=_ref.badge,onConfirm=_ref.onConfirm,_useState2=_slicedToArray((0,react.useState)(null!=badge&&badge.colour&&(null==badge?void 0:badge.colour.length)>0?null==badge?void 0:badge.colour:"rgba(0,0,0,1)"),2),selectedColour=_useState2[0],setSelectedColour=_useState2[1],onClose=(0,react.useCallback)((function(){onConfirm(selectedColour)}),[onConfirm,selectedColour]),badgeElF=function badgeElF(copyNum){return badge?(0,jsx_runtime.jsx)(ProfileBadge.Z,{badge:Object.assign({},badge,{colour:selectedColour})}):0===copyNum?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",children:"Error! Could not find badge"}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})},previewLightBgColour=(0,chakra_ui_color_mode_esm.ff)("AppPage.pageBackground-light","AppPage.pageBackground-dark"),previewDarkBgColour=(0,chakra_ui_color_mode_esm.ff)("AppPage.pageBackground-dark","AppPage.pageBackground-light");return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen:!!badge,onClose,isCentered:!0,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{children:"Select badge colour"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.M5,{flexDir:"column",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{mb:4,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{p:5,backgroundColor:previewLightBgColour,children:badgeElF(0)}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{p:5,backgroundColor:previewDarkBgColour,children:badgeElF(1)})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{color:"black",children:(0,jsx_runtime.jsx)(es.xS,{color:selectedColour,onChange:function onChange(c){var _c$rgb$a;return setSelectedColour("rgba("+c.rgb.r+","+c.rgb.g+","+c.rgb.b+","+(null!==(_c$rgb$a=c.rgb.a)&&void 0!==_c$rgb$a?_c$rgb$a:0)+")")}})})]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"ConfirmButton",onClick:function onClick(){return onClose()},children:"Done"})})]})]})}function BadgeInputInner(_ref2){var examples=_ref2.examples,badges=_ref2.badges,settingColourOf=_ref2.settingColourOf,onChange=_ref2.onChange,inputRef=(0,react.useRef)(null),badgeSettingColourOf=badges.find((function(badge){return badge.name===settingColourOf})),badgeInputBorderColor=(0,chakra_ui_color_mode_esm.ff)("Input.borderColor-light","Input.borderColor-dark");return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{maxW:450,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{fontWeight:"bold",fontSize:"1.2rem",children:"Badges"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{alignItems:"flex-start",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{alignItems:"flex-start",w:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",children:"Examples (click to add)"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{fontSize:"0.8rem",display:"block",w:"100%",children:examples.filter((function(example){return!badges.some((function(badge){return badge.name.toLowerCase()===example.toLowerCase()}))})).map((function(example){return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Ct,{mb:2,mr:2,colorScheme:"ProfileBadge-Default",variant:"outline",fontSize:"0.8rem",cursor:"pointer",onClick:function onClick(){onChange([].concat(_toConsumableArray(badges),[{name:example,colour:""}]),example)},onKeyUp:function onKeyUp(ev){" "!==ev.key&&"Enter"!==ev.key||onChange([].concat(_toConsumableArray(badges),[{name:example,colour:""}]),example)},tabIndex:0,_focus:{outlineWidth:"3px",outlineStyle:"solid",outlineOffset:"0 0 0",outlineColor:"focus.400"},children:example},example)}))})]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{alignItems:"flex-start",w:"100%",mt:-2,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",children:"Selected badges"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{fontSize:"0.8rem",display:"block",borderColor:badgeInputBorderColor,borderWidth:1,borderStyle:"solid",borderRadius:10,p:2,pb:0,w:"100%",overflow:"hidden",onClick:function onClick(){var _inputRef$current;return null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current?void 0:_inputRef$current.focus()},children:[badges.map((function(badge){return(0,jsx_runtime.jsx)(ProfileBadge.Z,{mb:2,mr:2,badge,onClick:function onClick(){var _inputRef$current2;onChange(badges.filter((function(x){return x.name.toLowerCase()!==badge.name.toLowerCase()}))),null===(_inputRef$current2=inputRef.current)||void 0===_inputRef$current2||_inputRef$current2.focus()}},badge.name)})),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{ref:inputRef,placeholder:"Type a badge",border:"none",w:"10em",p:0,m:0,pb:2,maxLength:10,h:"auto",lineHeight:"unset",fontSize:"0.9rem",borderRadius:0,onKeyUp:function onKeyUp(ev){if(inputRef.current){var newV=inputRef.current.value.trim();"Enter"===ev.key&&(badges.some((function(badge){return badge.name.toLowerCase()===newV}))||onChange([].concat(_toConsumableArray(badges),[{name:newV,colour:""}]),newV),inputRef.current.value="")}}})]})]})]}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.QI,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:"Create badges by typing, press Enter then select a colour."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:"Maximum length 10 characters."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:"Delete badges by clicking on them."})]})})]}),(0,jsx_runtime.jsx)(BadgeColourModal,{badge:null!=badgeSettingColourOf?badgeSettingColourOf:null,onConfirm:function onConfirm(colour){var _inputRef$current3;onChange(badges.map((function(x){return x.name!==settingColourOf?x:{name:x.name,colour}}))),null===(_inputRef$current3=inputRef.current)||void 0===_inputRef$current3||_inputRef$current3.focus()}})]})}function BadgeInput(_ref3){var examples=_ref3.examples,badges=_ref3.badges,settingColourOf=_ref3.settingColourOf,_onChange=_ref3.onChange,_useState4=_slicedToArray((0,react.useState)([]),2),internalBadges=_useState4[0],setInternalBadges=_useState4[1],_useState6=_slicedToArray((0,react.useState)(null),2),internalSettingColourOf=_useState6[0],setInternalSettingColourOf=_useState6[1];return(0,jsx_runtime.jsx)(BadgeInputInner,{examples:null!=examples?examples:["Author","Volunteer","Mentor","Mentee","Sponsor","Hiring","Hire me","Let's chat!","Coffee?","Organiser"],badges:null!=badges?badges:internalBadges,onChange:function onChange(newBadges,newBadgeName){return _onChange?_onChange(newBadges):setInternalBadges(newBadges),setInternalSettingColourOf(null!=newBadgeName?newBadgeName:null),!0},settingColourOf:null!=settingColourOf?settingColourOf:internalSettingColourOf})}BadgeColourModal.displayName="BadgeColourModal",BadgeInput.displayName="BadgeInput";try{BadgeInput.displayName="BadgeInput",BadgeInput.__docgenInfo={description:"",displayName:"BadgeInput",props:{examples:{defaultValue:null,description:"",name:"examples",required:!1,type:{name:"string[]"}},badges:{defaultValue:null,description:"",name:"badges",required:!1,type:{name:"{ name: string; colour: string; }[]"}},settingColourOf:{defaultValue:null,description:"",name:"settingColourOf",required:!1,type:{name:"string | null"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((badges: { name: string; colour: string; }[]) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Badges/BadgeInput.tsx#BadgeInput"]={docgenInfo:BadgeInput.__docgenInfo,name:"BadgeInput",path:"src/aspects/Badges/BadgeInput.tsx#BadgeInput"})}catch(__react_docgen_typescript_loader_error){}var LinkButton=__webpack_require__("./src/aspects/Chakra/LinkButton.tsx"),PageNotFound=__webpack_require__("./src/aspects/Errors/PageNotFound.tsx"),AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),useTitle=__webpack_require__("./src/aspects/Hooks/useTitle.tsx"),UnsavedChangesWarning=__webpack_require__("./src/aspects/LeavingPageWarnings/UnsavedChangesWarning.tsx"),PronounTag=__webpack_require__("./src/aspects/Pronouns/PronounTag.tsx");function PronounInput_slicedToArray(arr,i){return function PronounInput_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PronounInput_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||PronounInput_unsupportedIterableToArray(arr,i)||function PronounInput_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PronounInput_toConsumableArray(arr){return function PronounInput_arrayWithoutHoles(arr){if(Array.isArray(arr))return PronounInput_arrayLikeToArray(arr)}(arr)||function PronounInput_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||PronounInput_unsupportedIterableToArray(arr)||function PronounInput_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PronounInput_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return PronounInput_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PronounInput_arrayLikeToArray(o,minLen):void 0}}function PronounInput_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function PronounInputInner(_ref){var pronouns=_ref.pronouns,onChange=_ref.onChange,inputRef=(0,react.useRef)(null);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{maxW:450,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{fontWeight:"bold",fontSize:"1.2rem",children:"Pronouns"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{fontSize:"0.8rem",display:"block",borderColor:"gray.400",borderWidth:1,borderStyle:"solid",borderRadius:10,p:2,pb:0,w:"100%",overflow:"hidden",onClick:function onClick(){var _inputRef$current;return null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current?void 0:_inputRef$current.focus()},children:[pronouns.map((function(pronoun){return(0,jsx_runtime.jsx)(PronounTag.Z,{mb:2,mr:2,pronoun,onClick:function onClick(){var _inputRef$current2;onChange(pronouns.filter((function(x){return x.toLowerCase()!==pronoun.toLowerCase()}))),null===(_inputRef$current2=inputRef.current)||void 0===_inputRef$current2||_inputRef$current2.focus()}},pronoun)})),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{ref:inputRef,placeholder:"Type a pronoun",border:"none",w:"10em",p:0,m:0,pb:2,h:"auto",lineHeight:"unset",fontSize:"0.9rem",borderRadius:0,onKeyUp:function onKeyUp(ev){if(inputRef.current){var newV=inputRef.current.value.trim();"Enter"===ev.key&&(pronouns.some((function(pronoun){return pronoun.toLowerCase()===newV}))||onChange([].concat(PronounInput_toConsumableArray(pronouns),[newV]),newV),inputRef.current.value="")}}})]}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.QI,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:"Create pronouns by typing then press Enter."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:"Delete pronouns by clicking on them."})]})})]})})}function PronounInput(_ref2){var pronouns=_ref2.pronouns,_onChange=_ref2.onChange,_useState2=PronounInput_slicedToArray((0,react.useState)([]),2),internalPronouns=_useState2[0],setInternalPronouns=_useState2[1];return(0,jsx_runtime.jsx)(PronounInputInner,{pronouns:null!=pronouns?pronouns:internalPronouns,onChange:function onChange(newPronouns){return _onChange?_onChange(newPronouns):setInternalPronouns(newPronouns),!0}})}PronounInput.displayName="PronounInput";try{PronounInput.displayName="PronounInput",PronounInput.__docgenInfo={description:"",displayName:"PronounInput",props:{pronouns:{defaultValue:null,description:"",name:"pronouns",required:!1,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((pronouns: string[]) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Pronouns/PronounInput.tsx#PronounInput"]={docgenInfo:PronounInput.__docgenInfo,name:"PronounInput",path:"src/aspects/Pronouns/PronounInput.tsx#PronounInput"})}catch(__react_docgen_typescript_loader_error){}var _templateObject,useCurrentUser=__webpack_require__("./src/aspects/Users/CurrentUser/useCurrentUser.ts"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx"),useCurrentRegistrant=__webpack_require__("./src/aspects/Conference/useCurrentRegistrant.tsx"),chakra_ui_image_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.url.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.join.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+image@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/image/dist/chakra-ui-image.esm.js")),lib=__webpack_require__("../node_modules/.pnpm/@uppy+aws-s3-multipart@2.2.0_@uppy+core@2.1.4/node_modules/@uppy/aws-s3-multipart/lib/index.js"),lib_default=__webpack_require__.n(lib),core_lib=__webpack_require__("../node_modules/.pnpm/@uppy+core@2.1.4/node_modules/@uppy/core/lib/index.js"),core_lib_default=__webpack_require__.n(core_lib),formik_esm=(__webpack_require__("../node_modules/.pnpm/@uppy+core@2.1.4/node_modules/@uppy/core/dist/style.css"),__webpack_require__("../node_modules/.pnpm/@uppy+drag-drop@2.0.6_@uppy+core@2.1.4/node_modules/@uppy/drag-drop/dist/style.css"),__webpack_require__("../node_modules/.pnpm/@uppy+status-bar@2.1.2_@uppy+core@2.1.4/node_modules/@uppy/status-bar/dist/style.css"),__webpack_require__("../node_modules/.pnpm/formik@2.2.9_react@17.0.2/node_modules/formik/dist/formik.esm.js")),FAIcon=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function EditProfilePictureForm_slicedToArray(arr,i){return function EditProfilePictureForm_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function EditProfilePictureForm_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||EditProfilePictureForm_unsupportedIterableToArray(arr,i)||function EditProfilePictureForm_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EditProfilePictureForm_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return EditProfilePictureForm_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?EditProfilePictureForm_arrayLikeToArray(o,minLen):void 0}}function EditProfilePictureForm_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var EditProfilePage_templateObject,DragDrop=react.lazy((function(){return __webpack_require__.e(6256).then(__webpack_require__.bind(__webpack_require__,"../node_modules/.pnpm/@uppy+react@2.1.2_@uppy+core@2.1.4+react@17.0.2/node_modules/@uppy/react/index.mjs")).then((function(x){return{default:x.DragDrop}}))})),StatusBar=react.lazy((function(){return __webpack_require__.e(6256).then(__webpack_require__.bind(__webpack_require__,"../node_modules/.pnpm/@uppy+react@2.1.2_@uppy+core@2.1.4+react@17.0.2/node_modules/@uppy/react/index.mjs")).then((function(x){return{default:x.StatusBar}}))}));function EditProfilePitureForm(_ref){var handleFormSubmitted=_ref.handleFormSubmitted,registrant=_ref.registrant,toast=(0,chakra_ui_toast_esm.pm)(),_useState2=EditProfilePictureForm_slicedToArray((0,react.useState)([]),2),files=_useState2[0],setFiles=_useState2[1],submitProfilePhoto=EditProfilePictureForm_slicedToArray((0,graphql.u2_)(),2)[1],allowedFileTypes=(0,react.useMemo)((function(){return["image/*",".jpg",".jpeg",".png",".gif",".webp"]}),[]),uppy=(0,react.useMemo)((function(){var uppy=new(core_lib_default())({id:"profile-photo-upload",meta:{registrantId:registrant.id},allowMultipleUploads:!1,restrictions:{allowedFileTypes,maxNumberOfFiles:1,minNumberOfFiles:1},autoProceed:!1});return null==uppy||uppy.use(lib_default(),{limit:4,companionUrl:"string"==typeof(void 0).VITE_COMPANION_BASE_URL?(void 0).VITE_COMPANION_BASE_URL:""}),uppy}),[allowedFileTypes,registrant.id]),updateFiles=(0,react.useCallback)((function(){var validNameRegex=/^[a-zA-Z0-9.!*'()\-_ ]+$/;if(uppy){var _step,_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=EditProfilePictureForm_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(null==uppy?void 0:uppy.getFiles().filter((function(file){return!validNameRegex.test(file.name)||file.size>1048576})));try{for(_iterator.s();!(_step=_iterator.n()).done;){var invalidFile=_step.value;invalidFile.size>1048576?(toast({position:"top",status:"error",description:"The maximum size is 1MiB."}),uppy.removeFile(invalidFile.id)):(toast({position:"top",status:"error",description:"Invalid file name. File names must only contain letters, numbers, spaces and the following special characters: !*'()-_"}),uppy.removeFile(invalidFile.id))}}catch(err){_iterator.e(err)}finally{_iterator.f()}setFiles(uppy.getFiles())}}),[toast,uppy]);(0,react.useEffect)((function(){null==uppy||uppy.on("file-added",updateFiles),null==uppy||uppy.on("file-removed",updateFiles)}),[registrant,toast,updateFiles,uppy]);var _useState4=EditProfilePictureForm_slicedToArray((0,react.useState)(!1),2),isDeleting=_useState4[0],setIsDeleting=_useState4[1];return(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{}),children:(0,jsx_runtime.jsx)(formik_esm.J9,{initialValues:{},onSubmit:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(_values){var result,_submitResult$data,_submitResult$data$up,s3URL,submitResult,_e$message;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(uppy){_context.next=2;break}throw new Error("No Uppy instance");case 2:return _context.prev=2,_context.next=5,uppy.upload();case 5:result=_context.sent,_context.next=14;break;case 8:return _context.prev=8,_context.t0=_context.catch(2),console.error("Failed to upload file",_context.t0),toast({position:"top",status:"error",description:"Failed to upload file. Please try again."}),uppy.reset(),_context.abrupt("return");case 14:if(!(result.failed.length>0||result.successful.length<1)){_context.next=19;break}return console.error("Failed to upload file",result.failed),toast({position:"top",status:"error",description:"Failed to upload file. Please try again later."}),uppy.reset(),_context.abrupt("return");case 19:return _context.prev=19,s3URL=result.successful[0].uploadURL,_context.next=23,submitProfilePhoto({s3URL,registrantId:registrant.id});case 23:if(!(submitResult=_context.sent).error&&null!==(_submitResult$data=submitResult.data)&&void 0!==_submitResult$data&&null!==(_submitResult$data$up=_submitResult$data.updateProfilePhoto)&&void 0!==_submitResult$data$up&&_submitResult$data$up.ok){_context.next=26;break}throw new Error("Upload failed.");case 26:if(toast({position:"top",status:"success",description:"Uploaded file successfully."}),uppy.reset(),!handleFormSubmitted){_context.next=31;break}return _context.next=31,handleFormSubmitted();case 31:_context.next=39;break;case 33:return _context.prev=33,_context.t1=_context.catch(19),console.error("Failed to upload file",_context.t1),toast({status:"error",title:"Failed to upload file.",description:null!==(_e$message=null===_context.t1||void 0===_context.t1?void 0:_context.t1.message)&&void 0!==_e$message?_e$message:"Please try again later."}),uppy.reset(),_context.abrupt("return");case 39:case"end":return _context.stop()}}),_callee,null,[[2,8],[19,33]])})));return function(_x){return _ref2.apply(this,arguments)}}(),children:function children(_ref3){var dirty=_ref3.dirty,isSubmitting=_ref3.isSubmitting,isValid=_ref3.isValid;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(UnsavedChangesWarning.Z,{hasUnsavedChanges:dirty||files.length>0}),(0,jsx_runtime.jsxs)(formik_esm.l0,{style:{width:"100%",maxWidth:"350px"},children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{isInvalid:!files,isRequired:!0,color:"white",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{pos:"relative",w:350,h:350,borderWidth:2,borderColor:"gray.400",borderRadius:10,mt:2,mb:2,p:0,overflow:"hidden",backgroundColor:"#222",children:[1===files.length||registrant.profile.photoURL_350x350?(0,jsx_runtime.jsx)(chakra_ui_image_esm.Ee,{mt:2,alt:1===files.length?"Preview of the selected file.":"Your current profile picture.",src:1===files.length?URL.createObjectURL(files[0].data):registrant.profile.photoURL_350x350,objectFit:"cover",w:"100%",h:"100%",pos:"absolute",top:0,left:0,m:0,p:0,filter:"brightness(25%)"}):void 0,(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{w:"100%",h:"100%",pos:"absolute",justifyContent:1===files.length?"center":"flex-start",alignItems:"center",flexDir:"column",p:5,children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",mt:1===files.length?0:10,fontWeight:"bold",fontSize:"1.5em",textAlign:"center",children:1===files.length?"Please press Upload when you're ready":registrant.profile.photoURL_350x350?void 0:"Please upload a picture."})}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{display:1===files.length?"none":"",children:(0,jsx_runtime.jsx)(DragDrop,{width:350,height:350,uppy,allowMultipleFiles:!1})}),registrant.profile.photoURL_350x350?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{isLoading:isDeleting,pos:"absolute","aria-label":"Remove profile picture",colorScheme:"DestructiveActionButton",top:2,right:2,onClick:function onClick(ev){ev.stopPropagation(),setIsDeleting(!0),_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,submitProfilePhoto({s3URL:"",registrantId:registrant.id});case 3:return _context2.prev=3,setIsDeleting(!1),_context2.finish(3);case 6:case"end":return _context2.stop()}}),_callee2,null,[[0,,3,6]])})))()},children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"trash-alt"})}):void 0]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.Q6,{children:["File types: ",allowedFileTypes.join(", "),".",(0,jsx_runtime.jsx)("br",{}),"Maximum file size 1MiB."]})]}),(0,jsx_runtime.jsx)(StatusBar,{uppy,hideAfterFinish:!0,hideUploadButton:!0}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"PrimaryActionButton",isLoading:isSubmitting,type:"submit",isDisabled:!isValid||1!==files.length,mt:2,children:"Upload"})]})]})}})})}(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    mutation SubmitProfilePhoto($registrantId: uuid!, $s3URL: String!) {\n        updateProfilePhoto(registrantId: $registrantId, s3URL: $s3URL) {\n            ok\n            photoURL_350x350\n            photoURL_50x50\n        }\n    }\n"]))),EditProfilePitureForm.displayName="EditProfilePitureForm";try{EditProfilePictureForm.displayName="EditProfilePictureForm",EditProfilePictureForm.__docgenInfo={description:"",displayName:"EditProfilePictureForm",props:{handleFormSubmitted:{defaultValue:null,description:"",name:"handleFormSubmitted",required:!1,type:{name:"(() => Promise<void>)"}},registrant:{defaultValue:null,description:"",name:"registrant",required:!0,type:{name:"Registrant"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Profile/EditProfilePictureForm.tsx#EditProfilePictureForm"]={docgenInfo:EditProfilePictureForm.__docgenInfo,name:"EditProfilePictureForm",path:"src/aspects/Conference/Attend/Profile/EditProfilePictureForm.tsx#EditProfilePictureForm"})}catch(__react_docgen_typescript_loader_error){}function EditProfilePage_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function EditProfilePage_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){EditProfilePage_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){EditProfilePage_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function EditProfilePage_slicedToArray(arr,i){return function EditProfilePage_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function EditProfilePage_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||EditProfilePage_unsupportedIterableToArray(arr,i)||function EditProfilePage_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EditProfilePage_toConsumableArray(arr){return function EditProfilePage_arrayWithoutHoles(arr){if(Array.isArray(arr))return EditProfilePage_arrayLikeToArray(arr)}(arr)||function EditProfilePage_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||EditProfilePage_unsupportedIterableToArray(arr)||function EditProfilePage_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EditProfilePage_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return EditProfilePage_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?EditProfilePage_arrayLikeToArray(o,minLen):void 0}}function EditProfilePage_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function arraysEqual(x,y,sort,compare){if(!x||!y)return!x&&!y||!!(x&&0===x.length||y&&0===y.length);var sortedY=EditProfilePage_toConsumableArray(y).sort(sort);return x.length===y.length&&EditProfilePage_toConsumableArray(x).sort(sort).every((function(v,idx){return compare(v,sortedY[idx])}))}function EditProfilePageInner(_ref){var _errorUpdateProfile$m,_currentUser$user$ema,_invitation$data,_editingRegistrant$pr,_editingRegistrant$pr2,registrant=_ref.registrant,conference=(0,useConference.fk)(),conferencePath=(0,AuthParameters.h)().conferencePath,currentUser=(0,useCurrentUser.Z)(),_useState2=EditProfilePage_slicedToArray((0,react.useState)(registrant),2),editingRegistrant=_useState2[0],setEditingRegistrant=_useState2[1],isDirty=(0,react.useMemo)((function(){return!function deepProfileIsEqual(x,y){return x.profile.affiliation===y.profile.affiliation&&x.profile.affiliationURL===y.profile.affiliationURL&&x.profile.country===y.profile.country&&x.profile.timezoneUTCOffset===y.profile.timezoneUTCOffset&&x.profile.bio===y.profile.bio&&x.profile.website===y.profile.website&&x.profile.github===y.profile.github&&x.profile.twitter===y.profile.twitter&&arraysEqual(x.profile.badges,y.profile.badges,(function(a,b){return a.name.toLowerCase().localeCompare(b.name.toLowerCase())}),(function(a,b){return a.name.toLowerCase()===b.name.toLowerCase()&&a.colour===b.colour}))&&arraysEqual(x.profile.pronouns,y.profile.pronouns,(function(a,b){return a.toLowerCase().localeCompare(b.toLowerCase())}),(function(a,b){return a.toLowerCase()===b.toLowerCase()}))}(registrant,editingRegistrant)}),[registrant,editingRegistrant]),displayNameIsDirty=editingRegistrant.displayName!==registrant.displayName,_useUpdateProfileMuta2=EditProfilePage_slicedToArray((0,graphql.TGI)(),2),_useUpdateProfileMuta3=_useUpdateProfileMuta2[0],loadingUpdateAttendeProfile=_useUpdateProfileMuta3.fetching,errorUpdateProfile=_useUpdateProfileMuta3.error,updateProfile=_useUpdateProfileMuta2[1],_useUpdateRegistrantD2=EditProfilePage_slicedToArray((0,graphql.t8N)(),2),_useUpdateRegistrantD3=_useUpdateRegistrantD2[0],loadingUpdateAttendeDisplayName=_useUpdateRegistrantD3.fetching,errorUpdateRegistrantDisplayName=_useUpdateRegistrantD3.error,updateRegistrantDisplayName=_useUpdateRegistrantD2[1],toast=(0,chakra_ui_toast_esm.pm)(),savingToastIdRef=(0,react.useRef)(),closeSavingToast=(0,react.useCallback)((function(){void 0!==savingToastIdRef.current&&(toast.close(savingToastIdRef.current),savingToastIdRef.current=void 0)}),[toast]),showSavingToast=(0,react.useCallback)((function(){void 0===savingToastIdRef.current&&(savingToastIdRef.current=toast({position:"top",description:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{mr:4}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",children:"Saving changes…"})]}),status:"info"}))}),[toast]);(0,react.useEffect)((function(){var tId;return isDirty||loadingUpdateAttendeDisplayName||loadingUpdateAttendeProfile?tId=setTimeout(showSavingToast,1e3):closeSavingToast(),function(){tId&&clearTimeout(tId)}}),[closeSavingToast,isDirty,loadingUpdateAttendeDisplayName,loadingUpdateAttendeProfile,showSavingToast]),(0,react.useEffect)((function(){var tId;return isDirty&&(tId=setTimeout(EditProfilePage_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,updateProfile({registrantId:registrant.id,profile:{affiliation:editingRegistrant.profile.affiliation,affiliationURL:editingRegistrant.profile.affiliationURL,country:editingRegistrant.profile.country,timezoneUTCOffset:editingRegistrant.profile.timezoneUTCOffset,bio:editingRegistrant.profile.bio,website:editingRegistrant.profile.website,github:editingRegistrant.profile.github,twitter:editingRegistrant.profile.twitter,badges:editingRegistrant.profile.badges,pronouns:editingRegistrant.profile.pronouns,hasBeenEdited:!0}});case 3:_context.next=8;break;case 5:_context.prev=5,_context.t0=_context.catch(0),console.error("Error saving profile",_context.t0);case 8:case"end":return _context.stop()}}),_callee,null,[[0,5]])}))),3e3)),function(){tId&&clearTimeout(tId)}}),[registrant,editingRegistrant.displayName,editingRegistrant.profile,isDirty,updateRegistrantDisplayName,updateProfile]);var textField=(0,react.useCallback)((function(fieldName,title,type,leftAddon,stripPrefixes,helperText){var _toFixed,v=editingRegistrant.profile[fieldName];return(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{fontWeight:"bold",fontSize:"1.2rem",children:title}),"number"===type||"timezone"===type?(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{children:[leftAddon?(0,jsx_runtime.jsx)(chakra_ui_input_esm.Ui,{children:leftAddon}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_number_input_esm.Y2,{min:"timezone"===type?-24:void 0,max:"timezone"===type?24:void 0,precision:1,allowMouseWheel:!0,value:null!==(_toFixed=null==v?void 0:v.toFixed(1))&&void 0!==_toFixed?_toFixed:"",step:.5,onChange:function onChange(vvv,v){var _Object$assign;""!==vvv&&setEditingRegistrant(Object.assign({},editingRegistrant,{profile:Object.assign({},editingRegistrant.profile,(_Object$assign={},_Object$assign[fieldName]="timezone"===type?Math.round(2*v)/2:v,_Object$assign))}))},pattern:"-?[0-9]*(.[0-9]+)?",children:[(0,jsx_runtime.jsx)(chakra_ui_number_input_esm.zu,{}),(0,jsx_runtime.jsxs)(chakra_ui_number_input_esm.Fi,{children:[(0,jsx_runtime.jsx)(chakra_ui_number_input_esm.WQ,{"aria-label":"Increment"}),(0,jsx_runtime.jsx)(chakra_ui_number_input_esm.Y_,{"aria-label":"Decrement"})]})]})]}):"textarea"===type?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_textarea_esm.g,{transition:"none",value:null!=v?v:"",onChange:function onChange(ev){var _Object$assign2;setEditingRegistrant(Object.assign({},editingRegistrant,{profile:Object.assign({},editingRegistrant.profile,(_Object$assign2={},_Object$assign2[fieldName]=ev.target.value,_Object$assign2))}))}}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.Q6,{children:["Use"," ",(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.rU,{isExternal:!0,href:"https://itsfoss.com/markdown-guide/",children:["Markdown syntax",(0,jsx_runtime.jsx)("sup",{children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ExternalLinkIcon,{})})]})," ","to format your text."]})]}):(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{children:[leftAddon?(0,jsx_runtime.jsx)(chakra_ui_input_esm.Ui,{children:leftAddon}):void 0,(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!=v?v:"",onChange:function onChange(ev){var _Object$assign3,newV=ev.target.value;if(stripPrefixes){var _step,_iterator=function EditProfilePage_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=EditProfilePage_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(stripPrefixes);try{for(_iterator.s();!(_step=_iterator.n()).done;){var prefix=_step.value;if(newV.toLowerCase().startsWith(prefix)){newV=newV.substr(prefix.length);break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}setEditingRegistrant(Object.assign({},editingRegistrant,{profile:Object.assign({},editingRegistrant.profile,(_Object$assign3={},_Object$assign3[fieldName]=newV.trimStart(),_Object$assign3))}))}})]}),helperText&&(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:helperText})]})}),[editingRegistrant]),bioField=(0,react.useMemo)((function(){return textField("bio","Bio","textarea")}),[textField]),affiliationField=(0,react.useMemo)((function(){return textField("affiliation","Affiliation")}),[textField]),affiliationURLField=(0,react.useMemo)((function(){return textField("affiliationURL","Affiliation URL","url","URL")}),[textField]),countryField=(0,react.useMemo)((function(){return textField("country","Country")}),[textField]),webPageField=(0,react.useMemo)((function(){return textField("website","Website","url","URL")}),[textField]),githubField=(0,react.useMemo)((function(){return textField("github","GitHub","text","github.com/",["http://www.github.com/","https://www.github.com/","http://github.com/","https://github.com/","http://www.github.com","https://www.github.com","http://github.com","https://github.com","www.github.com/","github.com/","www.github.com","github.com","https://","http://"])}),[textField]),twitterField=(0,react.useMemo)((function(){return textField("twitter","Twitter","text","twitter.com/",["http://www.twitter.com/","https://www.twitter.com/","http://twitter.com/","https://twitter.com/","http://www.twitter.com","https://www.twitter.com","http://twitter.com","https://twitter.com","www.twitter.com/","twitter.com/","www.twitter.com","twitter.com","https://","http://"])}),[textField]),timezoneField=(0,react.useMemo)((function(){return textField("timezoneUTCOffset","Timezone Offset","timezone","UTC",void 0,"This does not change how the schedule is shown to you in Midspace. The schedule always displays in your local timezone according to your computer's settings.")}),[textField]),_useState4=EditProfilePage_slicedToArray((0,react.useState)(!1),2),isEditingName=_useState4[0],setIsEditingName=_useState4[1];(0,react.useEffect)((function(){editingRegistrant.displayName===registrant.displayName||isEditingName||EditProfilePage_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,updateRegistrantDisplayName({registrantId:registrant.id,name:editingRegistrant.displayName});case 2:toast({title:"Name saved",status:"success",position:"top",duration:500});case 3:case"end":return _context2.stop()}}),_callee2)})))()}),[registrant,editingRegistrant.displayName,isEditingName,toast,updateRegistrantDisplayName]);var title=(0,useTitle.Z)(currentUser.user.id===registrant.userId?"Edit your profile":"Edit "+registrant.displayName),invitation=EditProfilePage_slicedToArray((0,graphql.LS8)({variables:{registrantId:registrant.id}}),1)[0];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[title,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{maxW:450,spacing:6,m:2,children:[(0,jsx_runtime.jsx)(UnsavedChangesWarning.Z,{hasUnsavedChanges:isDirty||displayNameIsDirty}),registrant.userId!==currentUser.user.id||registrant.profile.hasBeenEdited||registrant.profile.photoURL_350x350?(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{variant:"outline",children:[(0,jsx_runtime.jsxs)(LinkButton.Qj,{to:null!=conferencePath?conferencePath:"/",colorScheme:"PrimaryActionButton",children:["Continue to ",conference.shortName]}),(0,jsx_runtime.jsx)(LinkButton.Qj,{to:registrant.userId===currentUser.user.id?conferencePath+"/profile/view":conferencePath+"/profile/view/"+registrant.id,colorScheme:"PrimaryActionButton",children:"View profile"})]}):(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"warning",variant:"top-accent",flexWrap:"wrap",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"Please make an edit"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{mt:2,children:"Please edit at least one part of your profile before proceeding. For example, you might like to upload a profile picture or add a badge."})]}),isEditingName?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{alignItems:"flex-start",w:"100%",maxW:350,children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{fontWeight:"bold",fontSize:"1.2rem",children:"Name"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{minLength:2,value:editingRegistrant.displayName,onChange:function onChange(ev){setEditingRegistrant(Object.assign({},editingRegistrant,{displayName:ev.target.value}))}})]}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"ConfirmButton",onClick:function onClick(){return setIsEditingName(!1)},children:"Save"})]}):(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.X6,{as:"h1",id:"page-heading",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"span",mr:2,children:editingRegistrant.displayName}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{verticalAlign:"top",size:"sm","aria-label":"Edit name",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.EditIcon,{}),variant:"outline",colorScheme:"PrimaryActionButton",onClick:function onClick(){return setIsEditingName(!0)}})]}),errorUpdateRegistrantDisplayName||errorUpdateProfile?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{mr:2,children:"Error saving changes"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:null!==(_errorUpdateProfile$m=null==errorUpdateProfile?void 0:errorUpdateProfile.message)&&void 0!==_errorUpdateProfile$m?_errorUpdateProfile$m:null==errorUpdateRegistrantDisplayName?void 0:errorUpdateRegistrantDisplayName.message})]}):void 0,(0,jsx_runtime.jsx)(EditProfilePitureForm,{registrant}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{fontWeight:"bold",fontSize:"1.2rem",children:"Account login email address"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!==(_currentUser$user$ema=currentUser.user.email)&&void 0!==_currentUser$user$ema?_currentUser$user$ema:"",isDisabled:!0}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:"The email address you use to log in to your account."})]}),null!==(_invitation$data=invitation.data)&&void 0!==_invitation$data&&_invitation$data.registrant_Invitation.length?(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{fontWeight:"bold",fontSize:"1.2rem",children:"Invitation email address"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:invitation.data.registrant_Invitation[0].invitedEmailAddress,isDisabled:!0}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:"Your invitation for this conference was originally sent to this address. It is okay if this is different from your login address."})]}):void 0,bioField,(0,jsx_runtime.jsx)(BadgeInput,{badges:null!==(_editingRegistrant$pr=editingRegistrant.profile.badges)&&void 0!==_editingRegistrant$pr?_editingRegistrant$pr:[],onChange:function onChange(newBadges){setEditingRegistrant(Object.assign({},editingRegistrant,{profile:Object.assign({},editingRegistrant.profile,{badges:newBadges})}))}}),affiliationField,affiliationURLField,timezoneField,(0,jsx_runtime.jsx)(PronounInput,{pronouns:null!==(_editingRegistrant$pr2=editingRegistrant.profile.pronouns)&&void 0!==_editingRegistrant$pr2?_editingRegistrant$pr2:[],onChange:function onChange(newPronouns){setEditingRegistrant(Object.assign({},editingRegistrant,{profile:Object.assign({},editingRegistrant.profile,{pronouns:newPronouns})}))}}),countryField,webPageField,twitterField,githubField,registrant.profile.hasBeenEdited?(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{variant:"solid",children:[(0,jsx_runtime.jsxs)(LinkButton.Qj,{to:null!=conferencePath?conferencePath:"/",colorScheme:"EditProfilePage-ContinueButton",children:["Continue to ",conference.shortName]}),(0,jsx_runtime.jsx)(LinkButton.Qj,{to:registrant.userId===currentUser.user.id?conferencePath+"/profile/view":conferencePath+"/profile/view/"+registrant.id,colorScheme:"SecondaryActionButton",children:"View profile"})]}):void 0]})]})}function EditCurrentProfilePage(){var maybeCurrentRegistrant=(0,useCurrentRegistrant.oC)();return maybeCurrentRegistrant?(0,jsx_runtime.jsx)(EditProfilePageInner,{registrant:maybeCurrentRegistrant}):(0,jsx_runtime.jsx)(PageNotFound.default,{})}function EditProfilePage_FetchWrapper(_ref4){var registrantId=_ref4.registrantId,conference=(0,useConference.fk)(),_useRegistrantByIdQue3=EditProfilePage_slicedToArray((0,graphql.$fE)({variables:{conferenceId:conference.id,registrantId}}),1)[0],loading=_useRegistrantByIdQue3.fetching,error=_useRegistrantByIdQue3.error,data=_useRegistrantByIdQue3.data;return loading&&!data?(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{})}):error?(0,jsx_runtime.jsx)(PageNotFound.default,{}):data&&data.registrant_Registrant[0].profile?(0,jsx_runtime.jsx)(EditProfilePageInner,{registrant:Object.assign({},data.registrant_Registrant[0],{profile:data.registrant_Registrant[0].profile})}):(0,jsx_runtime.jsx)(PageNotFound.default,{})}function EditProfilePage(_ref5){var registrantId=_ref5.registrantId;return registrantId?(0,jsx_runtime.jsx)(EditProfilePage_FetchWrapper,{registrantId}):(0,jsx_runtime.jsx)(EditCurrentProfilePage,{})}(0,urql_core.Ps)(EditProfilePage_templateObject||(EditProfilePage_templateObject=function EditProfilePage_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query RegistrantById($conferenceId: uuid!, $registrantId: uuid!) {\n        registrant_Registrant(where: { id: { _eq: $registrantId }, conferenceId: { _eq: $conferenceId } }) {\n            ...RegistrantData\n        }\n    }\n\n    query RegistrantInvitedEmailAddress($registrantId: uuid!) {\n        registrant_Invitation(where: { registrantId: { _eq: $registrantId } }) {\n            id\n            registrantId\n            invitedEmailAddress\n        }\n    }\n\n    mutation UpdateProfile($registrantId: uuid!, $profile: registrant_Profile_set_input = {}) {\n        update_registrant_Profile_by_pk(pk_columns: { registrantId: $registrantId }, _set: $profile) {\n            ...ProfileData\n        }\n    }\n\n    mutation UpdateRegistrantDisplayName($registrantId: uuid!, $name: String!) {\n        update_registrant_Registrant_by_pk(pk_columns: { id: $registrantId }, _set: { displayName: $name }) {\n            ...RegistrantData\n        }\n    }\n"])));try{EditProfilePage.displayName="EditProfilePage",EditProfilePage.__docgenInfo={description:"",displayName:"EditProfilePage",props:{registrantId:{defaultValue:null,description:"",name:"registrantId",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Profile/EditProfilePage.tsx#EditProfilePage"]={docgenInfo:EditProfilePage.__docgenInfo,name:"EditProfilePage",path:"src/aspects/Conference/Attend/Profile/EditProfilePage.tsx#EditProfilePage"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/LeavingPageWarnings/UnsavedChangesWarning.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>UnsavedChangesWarning});var react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function LeavePageWarning(_ref){var message=_ref.message,hasUnsavedChanges=_ref.hasUnsavedChanges;return(0,react.useEffect)((function(){var unloadHandler=function(){if(hasUnsavedChanges){var _unloadHandler=function _unloadHandler(ev){return ev.preventDefault(),ev.returnValue=message,!0};return window.addEventListener("beforeunload",_unloadHandler),_unloadHandler}return null}();return function(){unloadHandler&&window.removeEventListener("beforeunload",unloadHandler)}}),[hasUnsavedChanges,message]),(0,jsx_runtime.jsx)(react_router.NL,{when:hasUnsavedChanges,message})}LeavePageWarning.displayName="LeavePageWarning";try{LeavePageWarning.displayName="LeavePageWarning",LeavePageWarning.__docgenInfo={description:"",displayName:"LeavePageWarning",props:{hasUnsavedChanges:{defaultValue:null,description:"",name:"hasUnsavedChanges",required:!0,type:{name:"boolean"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/LeavingPageWarnings/LeavePageWarning.tsx#LeavePageWarning"]={docgenInfo:LeavePageWarning.__docgenInfo,name:"LeavePageWarning",path:"src/aspects/LeavingPageWarnings/LeavePageWarning.tsx#LeavePageWarning"})}catch(__react_docgen_typescript_loader_error){}function UnsavedChangesWarning(_ref){var hasUnsavedChanges=_ref.hasUnsavedChanges;return(0,jsx_runtime.jsx)(LeavePageWarning,{hasUnsavedChanges,message:"You have unsaved changes, are you sure you wish to leave the page?"})}UnsavedChangesWarning.displayName="UnsavedChangesWarning";try{UnsavedChangesWarning.displayName="UnsavedChangesWarning",UnsavedChangesWarning.__docgenInfo={description:"",displayName:"UnsavedChangesWarning",props:{hasUnsavedChanges:{defaultValue:null,description:"",name:"hasUnsavedChanges",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/LeavingPageWarnings/UnsavedChangesWarning.tsx#UnsavedChangesWarning"]={docgenInfo:UnsavedChangesWarning.__docgenInfo,name:"UnsavedChangesWarning",path:"src/aspects/LeavingPageWarnings/UnsavedChangesWarning.tsx#UnsavedChangesWarning"})}catch(__react_docgen_typescript_loader_error){}},"../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.every.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/export.js"),$every=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/array-iteration.js").every;$({target:"Array",proto:!0,forced:!__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/array-method-is-strict.js")("every")},{every:function every(callbackfn){return $every(this,callbackfn,arguments.length>1?arguments[1]:void 0)}})},"../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.trim-start.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/export.js"),$trimStart=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/string-trim.js").start,FORCED=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/string-trim-forced.js")("trimStart"),trimStart=FORCED?function trimStart(){return $trimStart(this)}:"".trimStart;$({target:"String",proto:!0,name:"trimStart",forced:FORCED},{trimStart,trimLeft:trimStart})}}]);