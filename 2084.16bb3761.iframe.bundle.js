/*! For license information please see 2084.16bb3761.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[2084],{"../node_modules/.pnpm/jsonata@1.8.6/node_modules/jsonata/jsonata.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,(function(r){return o(e[i][1][r]||r)}),p,p.exports,r,e,n,t)}return n[i].exports}for(var u=void 0,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){const utils=require("./utils"),dateTime=function(){"use strict";const stringToArray=utils.stringToArray,few=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],ordinals=["Zeroth","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth","Eleventh","Twelfth","Thirteenth","Fourteenth","Fifteenth","Sixteenth","Seventeenth","Eighteenth","Nineteenth"],decades=["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety","Hundred"],magnitudes=["Thousand","Million","Billion","Trillion"];function numberToWords(value,ordinal){var lookup=function(num,prev,ord){var words="";if(num<=19)words=(prev?" and ":"")+(ord?ordinals[num]:few[num]);else if(num<100){const tens=Math.floor(num/10),remainder=num%10;words=(prev?" and ":"")+decades[tens-2],remainder>0?words+="-"+lookup(remainder,!1,ord):ord&&(words=words.substring(0,words.length-1)+"ieth")}else if(num<1e3){const hundreds=Math.floor(num/100),remainder=num%100;words=(prev?", ":"")+few[hundreds]+" Hundred",remainder>0?words+=lookup(remainder,!0,ord):ord&&(words+="th")}else{var mag=Math.floor(Math.log10(num)/3);mag>magnitudes.length&&(mag=magnitudes.length);const factor=Math.pow(10,3*mag),mant=Math.floor(num/factor),remainder=num-mant*factor;words=(prev?", ":"")+lookup(mant,!1,!1)+" "+magnitudes[mag-1],remainder>0?words+=lookup(remainder,!0,ord):ord&&(words+="th")}return words};return lookup(value,!1,ordinal)}const wordValues={};function wordsToNumber(text){const values=text.split(/,\s|\sand\s|[\s\\-]/).map((part=>wordValues[part]));let segs=[0];return values.forEach((value=>{if(value<100){let top=segs.pop();top>=1e3&&(segs.push(top),top=0),segs.push(top+value)}else segs.push(segs.pop()*value)})),segs.reduce(((a,b)=>a+b),0)}few.forEach((function(word,index){wordValues[word.toLowerCase()]=index})),ordinals.forEach((function(word,index){wordValues[word.toLowerCase()]=index})),decades.forEach((function(word,index){const lword=word.toLowerCase();wordValues[lword]=10*(index+2),wordValues[lword.substring(0,word.length-1)+"ieth"]=wordValues[lword]})),wordValues.hundredth=100,magnitudes.forEach((function(word,index){const lword=word.toLowerCase(),val=Math.pow(10,3*(index+1));wordValues[lword]=val,wordValues[lword+"th"]=val}));const romanNumerals=[[1e3,"m"],[900,"cm"],[500,"d"],[400,"cd"],[100,"c"],[90,"xc"],[50,"l"],[40,"xl"],[10,"x"],[9,"ix"],[5,"v"],[4,"iv"],[1,"i"]],romanValues={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1};function decimalToRoman(value){for(var index=0;index<romanNumerals.length;index++){const numeral=romanNumerals[index];if(value>=numeral[0])return numeral[1]+decimalToRoman(value-numeral[0])}return""}function romanToDecimal(roman){for(var decimal=0,max=1,i=roman.length-1;i>=0;i--){const digit=roman[i],value=romanValues[digit];value<max?decimal-=value:(max=value,decimal+=value)}return decimal}function decimalToLetters(value,aChar){for(var letters=[],aCode=aChar.charCodeAt(0);value>0;)letters.unshift(String.fromCharCode((value-1)%26+aCode)),value=Math.floor((value-1)/26);return letters.join("")}function lettersToDecimal(letters,aChar){for(var aCode=aChar.charCodeAt(0),decimal=0,i=0;i<letters.length;i++)decimal+=(letters.charCodeAt(letters.length-i-1)-aCode+1)*Math.pow(26,i);return decimal}function formatInteger(value,picture){if(void 0!==value)return _formatInteger(value=Math.floor(value),analyseIntegerPicture(picture))}const formats={DECIMAL:"decimal",LETTERS:"letters",ROMAN:"roman",WORDS:"words",SEQUENCE:"sequence"},tcase={UPPER:"upper",LOWER:"lower",TITLE:"title"};function _formatInteger(value,format){let formattedInteger;const negative=value<0;switch(value=Math.abs(value),format.primary){case formats.LETTERS:formattedInteger=decimalToLetters(value,format.case===tcase.UPPER?"A":"a");break;case formats.ROMAN:formattedInteger=decimalToRoman(value),format.case===tcase.UPPER&&(formattedInteger=formattedInteger.toUpperCase());break;case formats.WORDS:formattedInteger=numberToWords(value,format.ordinal),format.case===tcase.UPPER?formattedInteger=formattedInteger.toUpperCase():format.case===tcase.LOWER&&(formattedInteger=formattedInteger.toLowerCase());break;case formats.DECIMAL:formattedInteger=""+value;var padLength=format.mandatoryDigits-formattedInteger.length;if(padLength>0){var padding=new Array(padLength+1).join("0");formattedInteger=padding+formattedInteger}if(48!==format.zeroCode&&(formattedInteger=stringToArray(formattedInteger).map((code=>String.fromCodePoint(code.codePointAt(0)+format.zeroCode-48))).join("")),format.regular)for(let ii=Math.floor((formattedInteger.length-1)/format.groupingSeparators.position);ii>0;ii--){const pos=formattedInteger.length-ii*format.groupingSeparators.position;formattedInteger=formattedInteger.substr(0,pos)+format.groupingSeparators.character+formattedInteger.substr(pos)}else format.groupingSeparators.reverse().forEach((separator=>{const pos=formattedInteger.length-separator.position;formattedInteger=formattedInteger.substr(0,pos)+separator.character+formattedInteger.substr(pos)}));if(format.ordinal){var suffix={1:"st",2:"nd",3:"rd"}[formattedInteger[formattedInteger.length-1]];(!suffix||formattedInteger.length>1&&"1"===formattedInteger[formattedInteger.length-2])&&(suffix="th"),formattedInteger+=suffix}break;case formats.SEQUENCE:throw{code:"D3130",value:format.token}}return negative&&(formattedInteger="-"+formattedInteger),formattedInteger}const decimalGroups=[48,1632,1776,1984,2406,2534,2662,2790,2918,3046,3174,3302,3430,3558,3664,3792,3872,4160,4240,6112,6160,6470,6608,6784,6800,6992,7088,7232,7248,42528,43216,43264,43472,43504,43600,44016,65296];function analyseIntegerPicture(picture){const format={type:"integer",primary:formats.DECIMAL,case:tcase.LOWER,ordinal:!1};let primaryFormat,formatModifier;const semicolon=picture.lastIndexOf(";");switch(-1===semicolon?primaryFormat=picture:(primaryFormat=picture.substring(0,semicolon),formatModifier=picture.substring(semicolon+1),"o"===formatModifier[0]&&(format.ordinal=!0)),primaryFormat){case"A":format.case=tcase.UPPER;case"a":format.primary=formats.LETTERS;break;case"I":format.case=tcase.UPPER;case"i":format.primary=formats.ROMAN;break;case"W":format.case=tcase.UPPER,format.primary=formats.WORDS;break;case"Ww":format.case=tcase.TITLE,format.primary=formats.WORDS;break;case"w":format.primary=formats.WORDS;break;default:{let zeroCode=null,mandatoryDigits=0,optionalDigits=0,groupingSeparators=[],separatorPosition=0;if(stringToArray(primaryFormat).map((c=>c.codePointAt(0))).reverse().forEach((codePoint=>{let digit=!1;for(let ii=0;ii<decimalGroups.length;ii++){const group=decimalGroups[ii];if(codePoint>=group&&codePoint<=group+9){if(digit=!0,mandatoryDigits++,separatorPosition++,null===zeroCode)zeroCode=group;else if(group!==zeroCode)throw{code:"D3131"};break}}digit||(35===codePoint?(separatorPosition++,optionalDigits++):groupingSeparators.push({position:separatorPosition,character:String.fromCodePoint(codePoint)}))})),mandatoryDigits>0){format.primary=formats.DECIMAL,format.zeroCode=zeroCode,format.mandatoryDigits=mandatoryDigits,format.optionalDigits=optionalDigits;const regular=function(separators){if(0===separators.length)return 0;const sepChar=separators[0].character;for(let ii=1;ii<separators.length;ii++)if(separators[ii].character!==sepChar)return 0;const indexes=separators.map((separator=>separator.position)),gcd=function(a,b){return 0===b?a:gcd(b,a%b)},factor=indexes.reduce(gcd);for(let index=1;index<=indexes.length;index++)if(-1===indexes.indexOf(index*factor))return 0;return factor}(groupingSeparators);regular>0?(format.regular=!0,format.groupingSeparators={position:regular,character:groupingSeparators[0].character}):(format.regular=!1,format.groupingSeparators=groupingSeparators)}else format.primary=formats.SEQUENCE,format.token=primaryFormat}}return format}const defaultPresentationModifiers={Y:"1",M:"1",D:"1",d:"1",F:"n",W:"1",w:"1",X:"1",x:"1",H:"1",h:"1",P:"n",m:"01",s:"01",f:"1",Z:"01:01",z:"01:01",C:"n",E:"n"};function analyseDateTimePicture(picture){var spec=[];const format={type:"datetime",parts:spec},addLiteral=function(start,end){if(end>start){let literal=picture.substring(start,end);literal=literal.split("]]").join("]"),spec.push({type:"literal",value:literal})}};for(var start=0,pos=0;pos<picture.length;){if("["===picture.charAt(pos)){if("["===picture.charAt(pos+1)){addLiteral(start,pos),spec.push({type:"literal",value:"["}),start=pos+=2;continue}if(addLiteral(start,pos),start=pos,-1===(pos=picture.indexOf("]",start)))throw{code:"D3135"};let marker=picture.substring(start+1,pos);marker=marker.split(/\s+/).join("");var presMod,def={type:"marker",component:marker.charAt(0)},comma=marker.lastIndexOf(",");if(-1!==comma){const widthMod=marker.substring(comma+1),dash=widthMod.indexOf("-");let min,max;const parseWidth=function(wm){return void 0===wm||"*"===wm?void 0:parseInt(wm)};-1===dash?min=widthMod:(min=widthMod.substring(0,dash),max=widthMod.substring(dash+1));const widthDef={min:parseWidth(min),max:parseWidth(max)};def.width=widthDef,presMod=marker.substring(1,comma)}else presMod=marker.substring(1);if(1===presMod.length)def.presentation1=presMod;else if(presMod.length>1){var lastChar=presMod.charAt(presMod.length-1);-1!=="atco".indexOf(lastChar)?(def.presentation2=lastChar,"o"===lastChar&&(def.ordinal=!0),def.presentation1=presMod.substring(0,presMod.length-1)):def.presentation1=presMod}else def.presentation1=defaultPresentationModifiers[def.component];if(void 0===def.presentation1)throw{code:"D3132",value:def.component};if("n"===def.presentation1[0])def.names=tcase.LOWER;else if("N"===def.presentation1[0])"n"===def.presentation1[1]?def.names=tcase.TITLE:def.names=tcase.UPPER;else if(-1!=="YMDdFWwXxHhmsf".indexOf(def.component)){var integerPattern=def.presentation1;if(def.presentation2&&(integerPattern+=";"+def.presentation2),def.integerFormat=analyseIntegerPicture(integerPattern),def.width&&void 0!==def.width.min&&def.integerFormat.mandatoryDigits<def.width.min&&(def.integerFormat.mandatoryDigits=def.width.min),-1!=="YMD".indexOf(def.component))if(def.n=-1,def.width&&void 0!==def.width.max)def.n=def.width.max,def.integerFormat.mandatoryDigits=def.n;else{var w=def.integerFormat.mandatoryDigits+def.integerFormat.optionalDigits;w>=2&&(def.n=w)}}"Z"!==def.component&&"z"!==def.component||(def.integerFormat=analyseIntegerPicture(def.presentation1)),spec.push(def),start=pos+1}pos++}return addLiteral(start,pos),format}const days=["","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months=["January","February","March","April","May","June","July","August","September","October","November","December"],millisInADay=864e5,startOfFirstWeek=function(ym){const jan1=Date.UTC(ym.year,ym.month);var dayOfJan1=new Date(jan1).getUTCDay();return 0===dayOfJan1&&(dayOfJan1=7),dayOfJan1>4?jan1+(8-dayOfJan1)*millisInADay:jan1-(dayOfJan1-1)*millisInADay},yearMonth=function(year,month){return{year,month,nextMonth:function(){return 11===month?yearMonth(year+1,0):yearMonth(year,month+1)},previousMonth:function(){return 0===month?yearMonth(year-1,11):yearMonth(year,month-1)},nextYear:function(){return yearMonth(year+1,month)},previousYear:function(){return yearMonth(year-1,month)}}},deltaWeeks=function(start,end){return(end-start)/(7*millisInADay)+1},getDateTimeFragment=(date,component)=>{let componentValue;switch(component){case"Y":componentValue=date.getUTCFullYear();break;case"M":componentValue=date.getUTCMonth()+1;break;case"D":componentValue=date.getUTCDate();break;case"d":componentValue=(Date.UTC(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate())-Date.UTC(date.getUTCFullYear(),0))/millisInADay+1;break;case"F":componentValue=date.getUTCDay(),0===componentValue&&(componentValue=7);break;case"W":{const thisYear=yearMonth(date.getUTCFullYear(),0),startOfWeek1=startOfFirstWeek(thisYear),today=Date.UTC(thisYear.year,date.getUTCMonth(),date.getUTCDate());let week=deltaWeeks(startOfWeek1,today);if(week>52)today>=startOfFirstWeek(thisYear.nextYear())&&(week=1);else if(week<1){const startOfPreviousYear=startOfFirstWeek(thisYear.previousYear());week=deltaWeeks(startOfPreviousYear,today)}componentValue=Math.floor(week);break}case"w":{const thisMonth=yearMonth(date.getUTCFullYear(),date.getUTCMonth()),startOfWeek1=startOfFirstWeek(thisMonth),today=Date.UTC(thisMonth.year,thisMonth.month,date.getUTCDate());let week=deltaWeeks(startOfWeek1,today);if(week>4)today>=startOfFirstWeek(thisMonth.nextMonth())&&(week=1);else if(week<1){const startOfPreviousMonth=startOfFirstWeek(thisMonth.previousMonth());week=deltaWeeks(startOfPreviousMonth,today)}componentValue=Math.floor(week);break}case"X":{const thisYear=yearMonth(date.getUTCFullYear(),0),startOfISOYear=startOfFirstWeek(thisYear),endOfISOYear=startOfFirstWeek(thisYear.nextYear()),now=date.getTime();componentValue=now<startOfISOYear?thisYear.year-1:now>=endOfISOYear?thisYear.year+1:thisYear.year;break}case"x":{const thisMonth=yearMonth(date.getUTCFullYear(),date.getUTCMonth()),startOfISOMonth=startOfFirstWeek(thisMonth),nextMonth=thisMonth.nextMonth(),endOfISOMonth=startOfFirstWeek(nextMonth),now=date.getTime();componentValue=now<startOfISOMonth?thisMonth.previousMonth().month+1:now>=endOfISOMonth?nextMonth.month+1:thisMonth.month+1;break}case"H":componentValue=date.getUTCHours();break;case"h":componentValue=date.getUTCHours(),componentValue%=12,0===componentValue&&(componentValue=12);break;case"P":componentValue=date.getUTCHours()>=12?"pm":"am";break;case"m":componentValue=date.getUTCMinutes();break;case"s":componentValue=date.getUTCSeconds();break;case"f":componentValue=date.getUTCMilliseconds();break;case"Z":case"z":break;case"C":case"E":componentValue="ISO"}return componentValue};let iso8601Spec=null;function formatDateTime(millis,picture,timezone){var offsetHours=0,offsetMinutes=0;if(void 0!==timezone){const offset=parseInt(timezone);offsetHours=Math.floor(offset/100),offsetMinutes=offset%100}var formatComponent=function(date,markerSpec){var componentValue=getDateTimeFragment(date,markerSpec.component);if(-1!=="YMDdFWwXxHhms".indexOf(markerSpec.component))if("Y"===markerSpec.component&&-1!==markerSpec.n&&(componentValue%=Math.pow(10,markerSpec.n)),markerSpec.names){if("M"===markerSpec.component||"x"===markerSpec.component)componentValue=months[componentValue-1];else{if("F"!==markerSpec.component)throw{code:"D3133",value:markerSpec.component};componentValue=days[componentValue]}markerSpec.names===tcase.UPPER?componentValue=componentValue.toUpperCase():markerSpec.names===tcase.LOWER&&(componentValue=componentValue.toLowerCase()),markerSpec.width&&componentValue.length>markerSpec.width.max&&(componentValue=componentValue.substring(0,markerSpec.width.max))}else componentValue=_formatInteger(componentValue,markerSpec.integerFormat);else if("f"===markerSpec.component)componentValue=_formatInteger(componentValue,markerSpec.integerFormat);else if("Z"===markerSpec.component||"z"===markerSpec.component){const offset=100*offsetHours+offsetMinutes;if(markerSpec.integerFormat.regular)componentValue=_formatInteger(offset,markerSpec.integerFormat);else{const numDigits=markerSpec.integerFormat.mandatoryDigits;if(1===numDigits||2===numDigits)componentValue=_formatInteger(offsetHours,markerSpec.integerFormat),0!==offsetMinutes&&(componentValue+=":"+formatInteger(offsetMinutes,"00"));else{if(3!==numDigits&&4!==numDigits)throw{code:"D3134",value:numDigits};componentValue=_formatInteger(offset,markerSpec.integerFormat)}}offset>=0&&(componentValue="+"+componentValue),"z"===markerSpec.component&&(componentValue="GMT"+componentValue),0===offset&&"t"===markerSpec.presentation2&&(componentValue="Z")}return componentValue};let formatSpec;void 0===picture?(null===iso8601Spec&&(iso8601Spec=analyseDateTimePicture("[Y0001]-[M01]-[D01]T[H01]:[m01]:[s01].[f001][Z01:01t]")),formatSpec=iso8601Spec):formatSpec=analyseDateTimePicture(picture);const dateTime=new Date(millis+60*(60*offsetHours+offsetMinutes)*1e3);let result="";return formatSpec.parts.forEach((function(part){"literal"===part.type?result+=part.value:result+=formatComponent(dateTime,part)})),result}function generateRegex(formatSpec){var matcher={};if("datetime"===formatSpec.type)matcher.type="datetime",matcher.parts=formatSpec.parts.map((function(part){var res={};if("literal"===part.type)res.regex=part.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");else if("Z"===part.component||"z"===part.component){let separator;Array.isArray(part.integerFormat.groupingSeparators)||(separator=part.integerFormat.groupingSeparators),res.regex="","z"===part.component&&(res.regex="GMT"),res.regex+="[-+][0-9]+",separator&&(res.regex+=separator.character+"[0-9]+"),res.parse=function(value){"z"===part.component&&(value=value.substring(3));let offsetHours=0,offsetMinutes=0;return separator?(offsetHours=Number.parseInt(value.substring(0,value.indexOf(separator.character))),offsetMinutes=Number.parseInt(value.substring(value.indexOf(separator.character)+1))):value.length-1<=2?offsetHours=Number.parseInt(value):(offsetHours=Number.parseInt(value.substring(0,3)),offsetMinutes=Number.parseInt(value.substring(3))),60*offsetHours+offsetMinutes}}else if(part.integerFormat)part.integerFormat.n=part.n,res=generateRegex(part.integerFormat);else{res.regex="[a-zA-Z]+";var lookup={};if("M"===part.component||"x"===part.component)months.forEach((function(name,index){part.width&&part.width.max?lookup[name.substring(0,part.width.max)]=index+1:lookup[name]=index+1}));else if("F"===part.component)days.forEach((function(name,index){index>0&&(part.width&&part.width.max?lookup[name.substring(0,part.width.max)]=index:lookup[name]=index)}));else{if("P"!==part.component)throw{code:"D3133",value:part.component};lookup={am:0,AM:0,pm:1,PM:1}}res.parse=function(value){return lookup[value]}}return res.component=part.component,res}));else{matcher.type="integer";const isUpper=formatSpec.case===tcase.UPPER;let occurrences;switch(occurrences=formatSpec.n&&formatSpec.n>0?0===formatSpec.optionalDigits?`{${formatSpec.n}}`:`{${formatSpec.n-formatSpec.optionalDigits},${formatSpec.n}}`:"+",formatSpec.primary){case formats.LETTERS:matcher.regex=isUpper?"[A-Z]+":"[a-z]+",matcher.parse=function(value){return lettersToDecimal(value,isUpper?"A":"a")};break;case formats.ROMAN:matcher.regex=isUpper?"[MDCLXVI]+":"[mdclxvi]+",matcher.parse=function(value){return romanToDecimal(isUpper?value:value.toUpperCase())};break;case formats.WORDS:matcher.regex="(?:"+Object.keys(wordValues).concat("and","[\\-, ]").join("|")+")+",matcher.parse=function(value){return wordsToNumber(value.toLowerCase())};break;case formats.DECIMAL:matcher.regex=`[0-9]${occurrences}`,formatSpec.ordinal&&(matcher.regex+="(?:th|st|nd|rd)"),matcher.parse=function(value){let digits=value;return formatSpec.ordinal&&(digits=value.substring(0,value.length-2)),formatSpec.regular?digits=digits.split(",").join(""):formatSpec.groupingSeparators.forEach((sep=>{digits=digits.split(sep.character).join("")})),48!==formatSpec.zeroCode&&(digits=digits.split("").map((char=>String.fromCodePoint(char.codePointAt(0)-formatSpec.zeroCode+48))).join("")),parseInt(digits)};break;case formats.SEQUENCE:throw{code:"D3130",value:formatSpec.token}}}return matcher}function parseInteger(value,picture){if(void 0!==value)return generateRegex(analyseIntegerPicture(picture)).parse(value)}function parseDateTime(timestamp,picture){const matchSpec=generateRegex(analyseDateTimePicture(picture)),fullRegex="^"+matchSpec.parts.map((part=>"("+part.regex+")")).join("")+"$";var info=new RegExp(fullRegex,"i").exec(timestamp);if(null!==info){const dmA=161,dmB=130,dmC=84,dmD=72,tmA=23,tmB=47,components={};for(let i=1;i<info.length;i++){const mpart=matchSpec.parts[i-1];mpart.parse&&(components[mpart.component]=mpart.parse(info[i]))}if(0===Object.getOwnPropertyNames(components).length)return;let mask=0;const shift=bit=>{mask<<=1,mask+=bit?1:0},isType=type=>!(~type&mask||!(type&mask));"YXMxWwdD".split("").forEach((part=>shift(components[part])));const dateB=!isType(dmA)&&isType(dmB),dateC=isType(dmC),dateD=!dateC&&isType(dmD);mask=0,"PHhmsf".split("").forEach((part=>shift(components[part])));const timeB=!isType(tmA)&&isType(tmB),comps=(dateB?"YD":dateC?"XxwF":dateD?"XWF":"YMD")+(timeB?"Phmsf":"Hmsf"),now=this.environment.timestamp;let startSpecified=!1,endSpecified=!1;if(comps.split("").forEach((part=>{if(void 0===components[part])startSpecified?(components[part]=-1!=="MDd".indexOf(part)?1:0,endSpecified=!0):components[part]=getDateTimeFragment(now,part);else if(startSpecified=!0,endSpecified)throw{code:"D3136"}})),components.M>0?components.M-=1:components.M=0,dateB){const firstJan=Date.UTC(components.Y,0),offsetMillis=1e3*(components.d-1)*60*60*24,derivedDate=new Date(firstJan+offsetMillis);components.M=derivedDate.getUTCMonth(),components.D=derivedDate.getUTCDate()}if(dateC)throw{code:"D3136"};if(dateD)throw{code:"D3136"};timeB&&(components.H=12===components.h?0:components.h,1===components.P&&(components.H+=12));var millis=Date.UTC(components.Y,components.M,components.D,components.H,components.m,components.s,components.f);return(components.Z||components.z)&&(millis-=60*(components.Z||components.z)*1e3),millis}}var iso8601regex=new RegExp("^\\d{4}(-[01]\\d)*(-[0-3]\\d)*(T[0-2]\\d:[0-5]\\d:[0-5]\\d)*(\\.\\d+)?([+-][0-2]\\d:?[0-5]\\d|Z)?$");function toMillis(timestamp,picture){if(void 0!==timestamp){if(void 0===picture){if(!iso8601regex.test(timestamp))throw{stack:(new Error).stack,code:"D3110",value:timestamp};return Date.parse(timestamp)}return parseDateTime.call(this,timestamp,picture)}}function fromMillis(millis,picture,timezone){if(void 0!==millis)return formatDateTime.call(this,millis,picture,timezone)}return{formatInteger,parseInteger,fromMillis,toMillis}}();module.exports=dateTime},{"./utils":6}],2:[function(require,module,exports){(function(global){(function(){var utils=require("./utils");const functions=(()=>{"use strict";var isNumeric=utils.isNumeric,isArrayOfStrings=utils.isArrayOfStrings,isArrayOfNumbers=utils.isArrayOfNumbers,createSequence=utils.createSequence,isSequence=utils.isSequence,isFunction=utils.isFunction,isLambda=utils.isLambda,isIterable=utils.isIterable,getFunctionArity=utils.getFunctionArity,deepEquals=utils.isDeepEqual,stringToArray=utils.stringToArray;function sum(args){if(void 0!==args){var total=0;return args.forEach((function(num){total+=num})),total}}function count(args){return void 0===args?0:args.length}function max(args){if(void 0!==args&&0!==args.length)return Math.max.apply(Math,args)}function min(args){if(void 0!==args&&0!==args.length)return Math.min.apply(Math,args)}function average(args){if(void 0!==args&&0!==args.length){var total=0;return args.forEach((function(num){total+=num})),total/args.length}}function string(arg,prettify=!1){if(void 0!==arg){var str;if("string"==typeof arg)str=arg;else if(isFunction(arg))str="";else{if("number"==typeof arg&&!isFinite(arg))throw{code:"D3001",value:arg,stack:(new Error).stack};var space=prettify?2:0;Array.isArray(arg)&&arg.outerWrapper&&(arg=arg[0]),str=JSON.stringify(arg,(function(key,val){return null!=val&&val.toPrecision&&isNumeric(val)?Number(val.toPrecision(15)):val&&isFunction(val)?"":val}),space)}return str}}function substring(str,start,length){if(void 0!==str){var strArray=stringToArray(str),strLength=strArray.length;if(strLength+start<0&&(start=0),void 0!==length){if(length<=0)return"";var end=start>=0?start+length:strLength+start+length;return strArray.slice(start,end).join("")}return strArray.slice(start).join("")}}function substringBefore(str,chars){if(void 0!==str){var pos=str.indexOf(chars);return pos>-1?str.substr(0,pos):str}}function substringAfter(str,chars){if(void 0!==str){var pos=str.indexOf(chars);return pos>-1?str.substr(pos+chars.length):str}}function lowercase(str){if(void 0!==str)return str.toLowerCase()}function uppercase(str){if(void 0!==str)return str.toUpperCase()}function length(str){if(void 0!==str)return stringToArray(str).length}function trim(str){if(void 0!==str){var result=str.replace(/[ \t\n\r]+/gm," ");return" "===result.charAt(0)&&(result=result.substring(1))," "===result.charAt(result.length-1)&&(result=result.substring(0,result.length-1)),result}}function pad(str,width,char){if(void 0!==str){var result;void 0!==char&&0!==char.length||(char=" ");var padLength=Math.abs(width)-length(str);if(padLength>0){var padding=new Array(padLength+1).join(char);char.length>1&&(padding=substring(padding,0,padLength)),result=width>0?str+padding:padding+str}else result=str;return result}}function*evaluateMatcher(matcher,str){var result=matcher.apply(this,[str]);if(isIterable(result)&&(result=yield*result),result&&"number"!=typeof result.start&&"number"!==result.end&&!Array.isArray(result.groups)&&!isFunction(result.next))throw{code:"T1010",stack:(new Error).stack};return result}function*contains(str,token){if(void 0!==str)return"string"==typeof token?-1!==str.indexOf(token):void 0!==(yield*evaluateMatcher(token,str))}function*match(str,regex,limit){if(void 0!==str){if(limit<0)throw{stack:(new Error).stack,value:limit,code:"D3040",index:3};var result=createSequence();if(void 0===limit||limit>0){var count=0,matches=yield*evaluateMatcher(regex,str);if(void 0!==matches)for(;void 0!==matches&&(void 0===limit||count<limit);)result.push({match:matches.match,index:matches.start,groups:matches.groups}),matches=yield*evaluateMatcher(matches.next),count++}return result}}function*replace(str,pattern,replacement,limit){if(void 0!==str){var replacer,self=this;if(""===pattern)throw{code:"D3010",stack:(new Error).stack,value:pattern,index:2};if(limit<0)throw{code:"D3011",stack:(new Error).stack,value:limit,index:4};replacer="string"==typeof replacement?function(regexMatch){for(var substitute="",position=0,index=replacement.indexOf("$",position);-1!==index&&position<replacement.length;){substitute+=replacement.substring(position,index),position=index+1;var dollarVal=replacement.charAt(position);if("$"===dollarVal)substitute+="$",position++;else if("0"===dollarVal)substitute+=regexMatch.match,position++;else{var maxDigits;if(maxDigits=0===regexMatch.groups.length?1:Math.floor(Math.log(regexMatch.groups.length)*Math.LOG10E)+1,index=parseInt(replacement.substring(position,position+maxDigits),10),maxDigits>1&&index>regexMatch.groups.length&&(index=parseInt(replacement.substring(position,position+maxDigits-1),10)),isNaN(index))substitute+="$";else{if(regexMatch.groups.length>0){var submatch=regexMatch.groups[index-1];void 0!==submatch&&(substitute+=submatch)}position+=index.toString().length}}index=replacement.indexOf("$",position)}return substitute+=replacement.substring(position)}:replacement;var result="",position=0;if(void 0===limit||limit>0){var count=0;if("string"==typeof pattern){for(var index=str.indexOf(pattern,position);-1!==index&&(void 0===limit||count<limit);)result+=str.substring(position,index),result+=replacement,position=index+pattern.length,count++,index=str.indexOf(pattern,position);result+=str.substring(position)}else{var matches=yield*evaluateMatcher(pattern,str);if(void 0!==matches){for(;void 0!==matches&&(void 0===limit||count<limit);){result+=str.substring(position,matches.start);var replacedWith=replacer.apply(self,[matches]);if(isIterable(replacedWith)&&(replacedWith=yield*replacedWith),"string"!=typeof replacedWith)throw{code:"D3012",stack:(new Error).stack,value:replacedWith};result+=replacedWith,position=matches.start+matches.match.length,count++,matches=yield*evaluateMatcher(matches.next)}result+=str.substring(position)}else result=str}}else result=str;return result}}function base64encode(str){if(void 0!==str){var btoa="undefined"!=typeof window?window.btoa:function(str){return new global.Buffer.from(str,"binary").toString("base64")};return btoa(str)}}function base64decode(str){if(void 0!==str){var atob="undefined"!=typeof window?window.atob:function(str){return new global.Buffer.from(str,"base64").toString("binary")};return atob(str)}}function encodeUrlComponent(str){if(void 0!==str){var returnVal;try{returnVal=encodeURIComponent(str)}catch(e){throw{code:"D3140",stack:(new Error).stack,value:str,functionName:"encodeUrlComponent"}}return returnVal}}function encodeUrl(str){if(void 0!==str){var returnVal;try{returnVal=encodeURI(str)}catch(e){throw{code:"D3140",stack:(new Error).stack,value:str,functionName:"encodeUrl"}}return returnVal}}function decodeUrlComponent(str){if(void 0!==str){var returnVal;try{returnVal=decodeURIComponent(str)}catch(e){throw{code:"D3140",stack:(new Error).stack,value:str,functionName:"decodeUrlComponent"}}return returnVal}}function decodeUrl(str){if(void 0!==str){var returnVal;try{returnVal=decodeURI(str)}catch(e){throw{code:"D3140",stack:(new Error).stack,value:str,functionName:"decodeUrl"}}return returnVal}}function*split(str,separator,limit){if(void 0!==str){if(limit<0)throw{code:"D3020",stack:(new Error).stack,value:limit,index:3};var result=[];if(void 0===limit||limit>0)if("string"==typeof separator)result=str.split(separator,limit);else{var count=0,matches=yield*evaluateMatcher(separator,str);if(void 0!==matches){for(var start=0;void 0!==matches&&(void 0===limit||count<limit);)result.push(str.substring(start,matches.start)),start=matches.end,matches=yield*evaluateMatcher(matches.next),count++;(void 0===limit||count<limit)&&result.push(str.substring(start))}else result.push(str)}return result}}function join(strs,separator){if(void 0!==strs)return void 0===separator&&(separator=""),strs.join(separator)}function formatNumber(value,picture,options){if(void 0!==value){var properties={"decimal-separator":".","grouping-separator":",","exponent-separator":"e",infinity:"Infinity","minus-sign":"-",NaN:"NaN",percent:"%","per-mille":"‰","zero-digit":"0",digit:"#","pattern-separator":";"};void 0!==options&&Object.keys(options).forEach((function(key){properties[key]=options[key]}));for(var decimalDigitFamily=[],zeroCharCode=properties["zero-digit"].charCodeAt(0),ii=zeroCharCode;ii<zeroCharCode+10;ii++)decimalDigitFamily.push(String.fromCharCode(ii));var activeChars=decimalDigitFamily.concat([properties["decimal-separator"],properties["exponent-separator"],properties["grouping-separator"],properties.digit,properties["pattern-separator"]]),subPictures=picture.split(properties["pattern-separator"]);if(subPictures.length>2)throw{code:"D3080",stack:(new Error).stack};var splitParts=function(subpicture){var mantissaPart,exponentPart,integerPart,fractionalPart,prefix=function(){for(var ch,ii=0;ii<subpicture.length;ii++)if(ch=subpicture.charAt(ii),-1!==activeChars.indexOf(ch)&&ch!==properties["exponent-separator"])return subpicture.substring(0,ii)}(),suffix=function(){for(var ch,ii=subpicture.length-1;ii>=0;ii--)if(ch=subpicture.charAt(ii),-1!==activeChars.indexOf(ch)&&ch!==properties["exponent-separator"])return subpicture.substring(ii+1)}(),activePart=subpicture.substring(prefix.length,subpicture.length-suffix.length),exponentPosition=subpicture.indexOf(properties["exponent-separator"],prefix.length);-1===exponentPosition||exponentPosition>subpicture.length-suffix.length?(mantissaPart=activePart,exponentPart=void 0):(mantissaPart=activePart.substring(0,exponentPosition),exponentPart=activePart.substring(exponentPosition+1));var decimalPosition=mantissaPart.indexOf(properties["decimal-separator"]);return-1===decimalPosition?(integerPart=mantissaPart,fractionalPart=suffix):(integerPart=mantissaPart.substring(0,decimalPosition),fractionalPart=mantissaPart.substring(decimalPosition+1)),{prefix,suffix,activePart,mantissaPart,exponentPart,integerPart,fractionalPart,subpicture}},validate=function(parts){var error,ii,subpicture=parts.subpicture,decimalPos=subpicture.indexOf(properties["decimal-separator"]);decimalPos!==subpicture.lastIndexOf(properties["decimal-separator"])&&(error="D3081"),subpicture.indexOf(properties.percent)!==subpicture.lastIndexOf(properties.percent)&&(error="D3082"),subpicture.indexOf(properties["per-mille"])!==subpicture.lastIndexOf(properties["per-mille"])&&(error="D3083"),-1!==subpicture.indexOf(properties.percent)&&-1!==subpicture.indexOf(properties["per-mille"])&&(error="D3084");var valid=!1;for(ii=0;ii<parts.mantissaPart.length;ii++){var ch=parts.mantissaPart.charAt(ii);if(-1!==decimalDigitFamily.indexOf(ch)||ch===properties.digit){valid=!0;break}}valid||(error="D3085"),-1!==parts.activePart.split("").map((function(char){return-1===activeChars.indexOf(char)?"p":"a"})).join("").indexOf("p")&&(error="D3086"),-1!==decimalPos?subpicture.charAt(decimalPos-1)!==properties["grouping-separator"]&&subpicture.charAt(decimalPos+1)!==properties["grouping-separator"]||(error="D3087"):parts.integerPart.charAt(parts.integerPart.length-1)===properties["grouping-separator"]&&(error="D3088"),-1!==subpicture.indexOf(properties["grouping-separator"]+properties["grouping-separator"])&&(error="D3089");var optionalDigitPos=parts.integerPart.indexOf(properties.digit);-1!==optionalDigitPos&&parts.integerPart.substring(0,optionalDigitPos).split("").filter((function(char){return decimalDigitFamily.indexOf(char)>-1})).length>0&&(error="D3090"),-1!==(optionalDigitPos=parts.fractionalPart.lastIndexOf(properties.digit))&&parts.fractionalPart.substring(optionalDigitPos).split("").filter((function(char){return decimalDigitFamily.indexOf(char)>-1})).length>0&&(error="D3091");var exponentExists="string"==typeof parts.exponentPart;if(exponentExists&&parts.exponentPart.length>0&&(-1!==subpicture.indexOf(properties.percent)||-1!==subpicture.indexOf(properties["per-mille"]))&&(error="D3092"),exponentExists&&(0===parts.exponentPart.length||parts.exponentPart.split("").filter((function(char){return-1===decimalDigitFamily.indexOf(char)})).length>0)&&(error="D3093"),error)throw{code:error,stack:(new Error).stack}},analyse=function(parts){var getGroupingPositions=function(part,toLeft){for(var positions=[],groupingPosition=part.indexOf(properties["grouping-separator"]);-1!==groupingPosition;){var charsToTheRight=(toLeft?part.substring(0,groupingPosition):part.substring(groupingPosition)).split("").filter((function(char){return-1!==decimalDigitFamily.indexOf(char)||char===properties.digit})).length;positions.push(charsToTheRight),groupingPosition=parts.integerPart.indexOf(properties["grouping-separator"],groupingPosition+1)}return positions},integerPartGroupingPositions=getGroupingPositions(parts.integerPart),regularGrouping=function(indexes){if(0===indexes.length)return 0;for(var gcd=function(a,b){return 0===b?a:gcd(b,a%b)},factor=indexes.reduce(gcd),index=1;index<=indexes.length;index++)if(-1===indexes.indexOf(index*factor))return 0;return factor}(integerPartGroupingPositions),fractionalPartGroupingPositions=getGroupingPositions(parts.fractionalPart,!0),minimumIntegerPartSize=parts.integerPart.split("").filter((function(char){return-1!==decimalDigitFamily.indexOf(char)})).length,scalingFactor=minimumIntegerPartSize,fractionalPartArray=parts.fractionalPart.split(""),minimumFactionalPartSize=fractionalPartArray.filter((function(char){return-1!==decimalDigitFamily.indexOf(char)})).length,maximumFactionalPartSize=fractionalPartArray.filter((function(char){return-1!==decimalDigitFamily.indexOf(char)||char===properties.digit})).length,exponentPresent="string"==typeof parts.exponentPart;0===minimumIntegerPartSize&&0===maximumFactionalPartSize&&(exponentPresent?(minimumFactionalPartSize=1,maximumFactionalPartSize=1):minimumIntegerPartSize=1),exponentPresent&&0===minimumIntegerPartSize&&-1!==parts.integerPart.indexOf(properties.digit)&&(minimumIntegerPartSize=1),0===minimumIntegerPartSize&&0===minimumFactionalPartSize&&(minimumFactionalPartSize=1);var minimumExponentSize=0;return exponentPresent&&(minimumExponentSize=parts.exponentPart.split("").filter((function(char){return-1!==decimalDigitFamily.indexOf(char)})).length),{integerPartGroupingPositions,regularGrouping,minimumIntegerPartSize,scalingFactor,prefix:parts.prefix,fractionalPartGroupingPositions,minimumFactionalPartSize,maximumFactionalPartSize,minimumExponentSize,suffix:parts.suffix,picture:parts.subpicture}},parts=subPictures.map(splitParts);parts.forEach(validate);var pic,adjustedNumber,mantissa,exponent,variables=parts.map(analyse),minus_sign=properties["minus-sign"],zero_digit=properties["zero-digit"],decimal_separator=properties["decimal-separator"],grouping_separator=properties["grouping-separator"];if(1===variables.length&&(variables.push(JSON.parse(JSON.stringify(variables[0]))),variables[1].prefix=minus_sign+variables[1].prefix),adjustedNumber=-1!==(pic=value>=0?variables[0]:variables[1]).picture.indexOf(properties.percent)?100*value:-1!==pic.picture.indexOf(properties["per-mille"])?1e3*value:value,0===pic.minimumExponentSize)mantissa=adjustedNumber;else{var maxMantissa=Math.pow(10,pic.scalingFactor),minMantissa=Math.pow(10,pic.scalingFactor-1);for(mantissa=adjustedNumber,exponent=0;mantissa<minMantissa;)mantissa*=10,exponent-=1;for(;mantissa>maxMantissa;)mantissa/=10,exponent+=1}var makeString=function(value,dp){var str=Math.abs(value).toFixed(dp);return"0"!==zero_digit&&(str=str.split("").map((function(digit){return digit>="0"&&digit<="9"?decimalDigitFamily[digit.charCodeAt(0)-48]:digit})).join("")),str},stringValue=makeString(round(mantissa,pic.maximumFactionalPartSize),pic.maximumFactionalPartSize),decimalPos=stringValue.indexOf(".");for(-1===decimalPos?stringValue+=decimal_separator:stringValue=stringValue.replace(".",decimal_separator);stringValue.charAt(0)===zero_digit;)stringValue=stringValue.substring(1);for(;stringValue.charAt(stringValue.length-1)===zero_digit;)stringValue=stringValue.substring(0,stringValue.length-1);decimalPos=stringValue.indexOf(decimal_separator);var padLeft=pic.minimumIntegerPartSize-decimalPos,padRight=pic.minimumFactionalPartSize-(stringValue.length-decimalPos-1);if(stringValue=(padLeft>0?new Array(padLeft+1).join(zero_digit):"")+stringValue,stringValue+=padRight>0?new Array(padRight+1).join(zero_digit):"",decimalPos=stringValue.indexOf(decimal_separator),pic.regularGrouping>0)for(var groupCount=Math.floor((decimalPos-1)/pic.regularGrouping),group=1;group<=groupCount;group++)stringValue=[stringValue.slice(0,decimalPos-group*pic.regularGrouping),grouping_separator,stringValue.slice(decimalPos-group*pic.regularGrouping)].join("");else pic.integerPartGroupingPositions.forEach((function(pos){stringValue=[stringValue.slice(0,decimalPos-pos),grouping_separator,stringValue.slice(decimalPos-pos)].join(""),decimalPos++}));if(decimalPos=stringValue.indexOf(decimal_separator),pic.fractionalPartGroupingPositions.forEach((function(pos){stringValue=[stringValue.slice(0,pos+decimalPos+1),grouping_separator,stringValue.slice(pos+decimalPos+1)].join("")})),decimalPos=stringValue.indexOf(decimal_separator),-1!==pic.picture.indexOf(decimal_separator)&&decimalPos!==stringValue.length-1||(stringValue=stringValue.substring(0,stringValue.length-1)),void 0!==exponent){var stringExponent=makeString(exponent,0);(padLeft=pic.minimumExponentSize-stringExponent.length)>0&&(stringExponent=new Array(padLeft+1).join(zero_digit)+stringExponent),stringValue=stringValue+properties["exponent-separator"]+(exponent<0?minus_sign:"")+stringExponent}return stringValue=pic.prefix+stringValue+pic.suffix}}function formatBase(value,radix){if(void 0!==value){if(value=round(value),(radix=void 0===radix?10:round(radix))<2||radix>36)throw{code:"D3100",stack:(new Error).stack,value:radix};return value.toString(radix)}}function number(arg){var result;if(void 0!==arg){if("number"==typeof arg)result=arg;else if("string"==typeof arg&&/^-?[0-9]+(\.[0-9]+)?([Ee][-+]?[0-9]+)?$/.test(arg)&&!isNaN(parseFloat(arg))&&isFinite(arg))result=parseFloat(arg);else if(!0===arg)result=1;else{if(!1!==arg)throw{code:"D3030",value:arg,stack:(new Error).stack,index:1};result=0}return result}}function abs(arg){if(void 0!==arg)return Math.abs(arg)}function floor(arg){if(void 0!==arg)return Math.floor(arg)}function ceil(arg){if(void 0!==arg)return Math.ceil(arg)}function round(arg,precision){var result;if(void 0!==arg){if(precision){var value=arg.toString().split("e");arg=+(value[0]+"e"+(value[1]?+value[1]+precision:precision))}var diff=(result=Math.round(arg))-arg;return.5===Math.abs(diff)&&1===Math.abs(result%2)&&(result-=1),precision&&(value=result.toString().split("e"),result=+(value[0]+"e"+(value[1]?+value[1]-precision:-precision))),Object.is(result,-0)&&(result=0),result}}function sqrt(arg){if(void 0!==arg){if(arg<0)throw{stack:(new Error).stack,code:"D3060",index:1,value:arg};return Math.sqrt(arg)}}function power(arg,exp){var result;if(void 0!==arg){if(result=Math.pow(arg,exp),!isFinite(result))throw{stack:(new Error).stack,code:"D3061",index:1,value:arg,exp};return result}}function random(){return Math.random()}function boolean(arg){if(void 0!==arg){var result=!1;return Array.isArray(arg)?1===arg.length?result=boolean(arg[0]):arg.length>1&&(result=arg.filter((function(val){return boolean(val)})).length>0):"string"==typeof arg?arg.length>0&&(result=!0):isNumeric(arg)?0!==arg&&(result=!0):null!==arg&&"object"==typeof arg?Object.keys(arg).length>0&&(result=!0):"boolean"==typeof arg&&!0===arg&&(result=!0),result}}function not(arg){if(void 0!==arg)return!boolean(arg)}function hofFuncArgs(func,arg1,arg2,arg3){var func_args=[arg1],length=getFunctionArity(func);return length>=2&&func_args.push(arg2),length>=3&&func_args.push(arg3),func_args}function*map(arr,func){if(void 0!==arr){for(var result=createSequence(),i=0;i<arr.length;i++){var func_args=hofFuncArgs(func,arr[i],i,arr),res=yield*func.apply(this,func_args);void 0!==res&&result.push(res)}return result}}function*filter(arr,func){if(void 0!==arr){for(var result=createSequence(),i=0;i<arr.length;i++){var entry=arr[i],func_args=hofFuncArgs(func,entry,i,arr);boolean(yield*func.apply(this,func_args))&&result.push(entry)}return result}}function*single(arr,func){if(void 0!==arr){for(var result,hasFoundMatch=!1,i=0;i<arr.length;i++){var entry=arr[i],positiveResult=!0;if(void 0!==func){var func_args=hofFuncArgs(func,entry,i,arr);positiveResult=boolean(yield*func.apply(this,func_args))}if(positiveResult){if(hasFoundMatch)throw{stack:(new Error).stack,code:"D3138",index:i};result=entry,hasFoundMatch=!0}}if(!hasFoundMatch)throw{stack:(new Error).stack,code:"D3139"};return result}}function zip(){for(var result=[],args=Array.prototype.slice.call(arguments),length=Math.min.apply(Math,args.map((function(arg){return Array.isArray(arg)?arg.length:0}))),i=0;i<length;i++){var tuple=args.map((arg=>arg[i]));result.push(tuple)}return result}function*foldLeft(sequence,func,init){if(void 0!==sequence){var result,index,arity=getFunctionArity(func);if(arity<2)throw{stack:(new Error).stack,code:"D3050",index:1};for(void 0===init&&sequence.length>0?(result=sequence[0],index=1):(result=init,index=0);index<sequence.length;){var args=[result,sequence[index]];arity>=3&&args.push(index),arity>=4&&args.push(sequence),result=yield*func.apply(this,args),index++}return result}}function keys(arg){var result=createSequence();if(Array.isArray(arg)){var merge={};arg.forEach((function(item){keys(item).forEach((function(key){merge[key]=!0}))})),result=keys(merge)}else null===arg||"object"!=typeof arg||isLambda(arg)||Object.keys(arg).forEach((key=>result.push(key)));return result}function lookup(input,key){var result;if(Array.isArray(input)){result=createSequence();for(var ii=0;ii<input.length;ii++){var res=lookup(input[ii],key);void 0!==res&&(Array.isArray(res)?res.forEach((val=>result.push(val))):result.push(res))}}else null!==input&&"object"==typeof input&&(result=input[key]);return result}function append(arg1,arg2){return void 0===arg1?arg2:void 0===arg2?arg1:(Array.isArray(arg1)||(arg1=createSequence(arg1)),Array.isArray(arg2)||(arg2=[arg2]),arg1.concat(arg2))}function exists(arg){return void 0!==arg}function spread(arg){var result=createSequence();if(Array.isArray(arg))arg.forEach((function(item){result=append(result,spread(item))}));else if(null===arg||"object"!=typeof arg||isLambda(arg))result=arg;else for(var key in arg){var obj={};obj[key]=arg[key],result.push(obj)}return result}function merge(arg){if(void 0!==arg){var result={};return arg.forEach((function(obj){for(var prop in obj)result[prop]=obj[prop]})),result}}function reverse(arr){if(void 0!==arr){if(arr.length<=1)return arr;for(var length=arr.length,result=new Array(length),i=0;i<length;i++)result[length-i-1]=arr[i];return result}}function*each(obj,func){var result=createSequence();for(var key in obj){var func_args=hofFuncArgs(func,obj[key],key,obj),val=yield*func.apply(this,func_args);void 0!==val&&result.push(val)}return result}function error(message){throw{code:"D3137",stack:(new Error).stack,message:message||"$error() function evaluated"}}function assert(condition,message){if(!condition)throw{code:"D3141",stack:(new Error).stack,message:message||"$assert() statement failed"}}function type(value){if(void 0!==value)return null===value?"null":isNumeric(value)?"number":"string"==typeof value?"string":"boolean"==typeof value?"boolean":Array.isArray(value)?"array":isFunction(value)?"function":"object"}function*sort(arr,comparator){if(void 0!==arr){if(arr.length<=1)return arr;var comp;if(void 0===comparator){if(!isArrayOfNumbers(arr)&&!isArrayOfStrings(arr))throw{stack:(new Error).stack,code:"D3070",index:1};comp=function*(a,b){return a>b}}else comp=comparator;var merge=function*(l,r){var merge_iter=function*(result,left,right){0===left.length?Array.prototype.push.apply(result,right):0===right.length?Array.prototype.push.apply(result,left):(yield*comp(left[0],right[0]))?(result.push(right[0]),yield*merge_iter(result,left,right.slice(1))):(result.push(left[0]),yield*merge_iter(result,left.slice(1),right))},merged=[];return yield*merge_iter(merged,l,r),merged},msort=function*(array){if(!Array.isArray(array)||array.length<=1)return array;var middle=Math.floor(array.length/2),left=array.slice(0,middle),right=array.slice(middle);return left=yield*msort(left),right=yield*msort(right),yield*merge(left,right)};return yield*msort(arr)}}function shuffle(arr){if(void 0!==arr){if(arr.length<=1)return arr;for(var result=new Array(arr.length),i=0;i<arr.length;i++){var j=Math.floor(Math.random()*(i+1));i!==j&&(result[i]=result[j]),result[j]=arr[i]}return result}}function distinct(arr){if(void 0!==arr){if(!Array.isArray(arr)||arr.length<=1)return arr;for(var results=isSequence(arr)?createSequence():[],ii=0;ii<arr.length;ii++){for(var value=arr[ii],includes=!1,jj=0;jj<results.length;jj++)if(deepEquals(value,results[jj])){includes=!0;break}includes||results.push(value)}return results}}function*sift(arg,func){var result={};for(var item in arg){var entry=arg[item],func_args=hofFuncArgs(func,entry,item,arg);boolean(yield*func.apply(this,func_args))&&(result[item]=entry)}return 0===Object.keys(result).length&&(result=void 0),result}return{sum,count,max,min,average,string,substring,substringBefore,substringAfter,lowercase,uppercase,length,trim,pad,match,contains,replace,split,join,formatNumber,formatBase,number,floor,ceil,round,abs,sqrt,power,random,boolean,not,map,zip,filter,single,foldLeft,sift,keys,lookup,append,exists,spread,merge,reverse,each,error,assert,type,sort,shuffle,distinct,base64encode,base64decode,encodeUrlComponent,encodeUrl,decodeUrlComponent,decodeUrl}})();module.exports=functions}).call(this)}).call(this,void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":6}],3:[function(require,module,exports){var datetime=require("./datetime"),fn=require("./functions"),utils=require("./utils"),parser=require("./parser"),parseSignature=require("./signature"),jsonata=function(){"use strict";var isNumeric=utils.isNumeric,isArrayOfStrings=utils.isArrayOfStrings,isArrayOfNumbers=utils.isArrayOfNumbers,createSequence=utils.createSequence,isSequence=utils.isSequence,isFunction=utils.isFunction,isLambda=utils.isLambda,isIterable=utils.isIterable,getFunctionArity=utils.getFunctionArity,isDeepEqual=utils.isDeepEqual,staticFrame=createFrame(null);function*evaluate(expr,input,environment){var result,entryCallback=environment.lookup("__evaluate_entry");switch(entryCallback&&entryCallback(expr,input,environment),expr.type){case"path":result=yield*evaluatePath(expr,input,environment);break;case"binary":result=yield*evaluateBinary(expr,input,environment);break;case"unary":result=yield*evaluateUnary(expr,input,environment);break;case"name":result=evaluateName(expr,input,environment);break;case"string":case"number":case"value":result=evaluateLiteral(expr,input,environment);break;case"wildcard":result=evaluateWildcard(expr,input,environment);break;case"descendant":result=evaluateDescendants(expr,input,environment);break;case"parent":result=environment.lookup(expr.slot.label);break;case"condition":result=yield*evaluateCondition(expr,input,environment);break;case"block":result=yield*evaluateBlock(expr,input,environment);break;case"bind":result=yield*evaluateBindExpression(expr,input,environment);break;case"regex":result=evaluateRegex(expr,input,environment);break;case"function":result=yield*evaluateFunction(expr,input,environment);break;case"variable":result=evaluateVariable(expr,input,environment);break;case"lambda":result=evaluateLambda(expr,input,environment);break;case"partial":result=yield*evaluatePartialApplication(expr,input,environment);break;case"apply":result=yield*evaluateApplyExpression(expr,input,environment);break;case"transform":result=evaluateTransformExpression(expr,input,environment)}if(!environment.async||null!=result&&"function"==typeof result.then||(result=Promise.resolve(result)),environment.async&&"function"==typeof result.then&&expr.nextFunction&&"function"==typeof result[expr.nextFunction]||(result=yield result),Object.prototype.hasOwnProperty.call(expr,"predicate"))for(var ii=0;ii<expr.predicate.length;ii++)result=yield*evaluateFilter(expr.predicate[ii].expr,result,environment);"path"!==expr.type&&Object.prototype.hasOwnProperty.call(expr,"group")&&(result=yield*evaluateGroupExpression(expr.group,result,environment));var exitCallback=environment.lookup("__evaluate_exit");return exitCallback&&exitCallback(expr,input,environment,result),result&&isSequence(result)&&!result.tupleStream&&(expr.keepArray&&(result.keepSingleton=!0),0===result.length?result=void 0:1===result.length&&(result=result.keepSingleton?result:result[0])),result}function*evaluatePath(expr,input,environment){var inputSequence,resultSequence;inputSequence=Array.isArray(input)&&"variable"!==expr.steps[0].type?input:createSequence(input);for(var isTupleStream=!1,tupleBindings=void 0,ii=0;ii<expr.steps.length;ii++){var step=expr.steps[ii];if(step.tuple&&(isTupleStream=!0),0===ii&&step.consarray?resultSequence=yield*evaluate(step,inputSequence,environment):isTupleStream?tupleBindings=yield*evaluateTupleStep(step,inputSequence,tupleBindings,environment):resultSequence=yield*evaluateStep(step,inputSequence,environment,ii===expr.steps.length-1),!isTupleStream&&(void 0===resultSequence||0===resultSequence.length))break;void 0===step.focus&&(inputSequence=resultSequence)}if(isTupleStream)if(expr.tuple)resultSequence=tupleBindings;else for(resultSequence=createSequence(),ii=0;ii<tupleBindings.length;ii++)resultSequence.push(tupleBindings[ii]["@"]);return expr.keepSingletonArray&&(Array.isArray(resultSequence)&&resultSequence.cons&&!resultSequence.sequence&&(resultSequence=createSequence(resultSequence)),resultSequence.keepSingleton=!0),expr.hasOwnProperty("group")&&(resultSequence=yield*evaluateGroupExpression(expr.group,isTupleStream?tupleBindings:resultSequence,environment)),resultSequence}function createFrameFromTuple(environment,tuple){var frame=createFrame(environment);for(const prop in tuple)frame.bind(prop,tuple[prop]);return frame}function*evaluateStep(expr,input,environment,lastStep){var result;if("sort"===expr.type)return result=yield*evaluateSortExpression(expr,input,environment),expr.stages&&(result=yield*evaluateStages(expr.stages,result,environment)),result;result=createSequence();for(var ii=0;ii<input.length;ii++){var res=yield*evaluate(expr,input[ii],environment);if(expr.stages)for(var ss=0;ss<expr.stages.length;ss++)res=yield*evaluateFilter(expr.stages[ss].expr,res,environment);void 0!==res&&result.push(res)}var resultSequence=createSequence();return lastStep&&1===result.length&&Array.isArray(result[0])&&!isSequence(result[0])?resultSequence=result[0]:result.forEach((function(res){!Array.isArray(res)||res.cons?resultSequence.push(res):res.forEach((val=>resultSequence.push(val)))})),resultSequence}function*evaluateStages(stages,input,environment){for(var result=input,ss=0;ss<stages.length;ss++){var stage=stages[ss];switch(stage.type){case"filter":result=yield*evaluateFilter(stage.expr,result,environment);break;case"index":for(var ee=0;ee<result.length;ee++)result[ee][stage.value]=ee}}return result}function*evaluateTupleStep(expr,input,tupleBindings,environment){var result;if("sort"===expr.type){if(tupleBindings)result=yield*evaluateSortExpression(expr,tupleBindings,environment);else{var sorted=yield*evaluateSortExpression(expr,input,environment);(result=createSequence()).tupleStream=!0;for(var ss=0;ss<sorted.length;ss++){var tuple={"@":sorted[ss]};tuple[expr.index]=ss,result.push(tuple)}}return expr.stages&&(result=yield*evaluateStages(expr.stages,result,environment)),result}(result=createSequence()).tupleStream=!0;var stepEnv=environment;void 0===tupleBindings&&(tupleBindings=input.map((item=>({"@":item}))));for(var ee=0;ee<tupleBindings.length;ee++){stepEnv=createFrameFromTuple(environment,tupleBindings[ee]);var res=yield*evaluate(expr,tupleBindings[ee]["@"],stepEnv);if(void 0!==res){Array.isArray(res)||(res=[res]);for(var bb=0;bb<res.length;bb++)tuple={},Object.assign(tuple,tupleBindings[ee]),res.tupleStream?Object.assign(tuple,res[bb]):(expr.focus?(tuple[expr.focus]=res[bb],tuple["@"]=tupleBindings[ee]["@"]):tuple["@"]=res[bb],expr.index&&(tuple[expr.index]=bb),expr.ancestor&&(tuple[expr.ancestor.label]=tupleBindings[ee]["@"])),result.push(tuple)}}return expr.stages&&(result=yield*evaluateStages(expr.stages,result,environment)),result}function*evaluateFilter(predicate,input,environment){var results=createSequence();if(input&&input.tupleStream&&(results.tupleStream=!0),Array.isArray(input)||(input=createSequence(input)),"number"===predicate.type){var index=Math.floor(predicate.value);index<0&&(index=input.length+index),void 0!==(item=input[index])&&(Array.isArray(item)?results=item:results.push(item))}else for(index=0;index<input.length;index++){var item,context=item=input[index],env=environment;input.tupleStream&&(context=item["@"],env=createFrameFromTuple(environment,item));var res=yield*evaluate(predicate,context,env);isNumeric(res)&&(res=[res]),isArrayOfNumbers(res)?res.forEach((function(ires){var ii=Math.floor(ires);ii<0&&(ii=input.length+ii),ii===index&&results.push(item)})):fn.boolean(res)&&results.push(item)}return results}function*evaluateBinary(expr,input,environment){var result,lhs=yield*evaluate(expr.lhs,input,environment),op=expr.value,evalrhs=function*(){return yield*evaluate(expr.rhs,input,environment)};if("and"===op||"or"===op)try{return yield*evaluateBooleanExpression(lhs,evalrhs,op)}catch(err){throw err.position=expr.position,err.token=op,err}var rhs=yield*evalrhs();try{switch(op){case"+":case"-":case"*":case"/":case"%":result=evaluateNumericExpression(lhs,rhs,op);break;case"=":case"!=":result=evaluateEqualityExpression(lhs,rhs,op);break;case"<":case"<=":case">":case">=":result=evaluateComparisonExpression(lhs,rhs,op);break;case"&":result=evaluateStringConcat(lhs,rhs);break;case"..":result=evaluateRangeExpression(lhs,rhs);break;case"in":result=evaluateIncludesExpression(lhs,rhs)}}catch(err){throw err.position=expr.position,err.token=op,err}return result}function*evaluateUnary(expr,input,environment){var result;switch(expr.value){case"-":if(void 0===(result=yield*evaluate(expr.expression,input,environment)))result=void 0;else{if(!isNumeric(result))throw{code:"D1002",stack:(new Error).stack,position:expr.position,token:expr.value,value:result};result=-result}break;case"[":result=[];for(var ii=0;ii<expr.expressions.length;ii++){var item=expr.expressions[ii],value=yield*evaluate(item,input,environment);void 0!==value&&("["===item.value?result.push(value):result=fn.append(result,value))}expr.consarray&&Object.defineProperty(result,"cons",{enumerable:!1,configurable:!1,value:!0});break;case"{":result=yield*evaluateGroupExpression(expr,input,environment)}return result}function evaluateName(expr,input,environment){return fn.lookup(input,expr.value)}function evaluateLiteral(expr){return expr.value}function evaluateWildcard(expr,input){var results=createSequence();return Array.isArray(input)&&input.outerWrapper&&input.length>0&&(input=input[0]),null!==input&&"object"==typeof input&&Object.keys(input).forEach((function(key){var value=input[key];Array.isArray(value)?(value=flatten(value),results=fn.append(results,value)):results.push(value)})),results}function flatten(arg,flattened){return void 0===flattened&&(flattened=[]),Array.isArray(arg)?arg.forEach((function(item){flatten(item,flattened)})):flattened.push(arg),flattened}function evaluateDescendants(expr,input){var result,resultSequence=createSequence();return void 0!==input&&(recurseDescendants(input,resultSequence),result=1===resultSequence.length?resultSequence[0]:resultSequence),result}function recurseDescendants(input,results){Array.isArray(input)||results.push(input),Array.isArray(input)?input.forEach((function(member){recurseDescendants(member,results)})):null!==input&&"object"==typeof input&&Object.keys(input).forEach((function(key){recurseDescendants(input[key],results)}))}function evaluateNumericExpression(lhs,rhs,op){var result;if(void 0!==lhs&&!isNumeric(lhs))throw{code:"T2001",stack:(new Error).stack,value:lhs};if(void 0!==rhs&&!isNumeric(rhs))throw{code:"T2002",stack:(new Error).stack,value:rhs};if(void 0===lhs||void 0===rhs)return result;switch(op){case"+":result=lhs+rhs;break;case"-":result=lhs-rhs;break;case"*":result=lhs*rhs;break;case"/":result=lhs/rhs;break;case"%":result=lhs%rhs}return result}function evaluateEqualityExpression(lhs,rhs,op){var result;if(void 0===lhs||void 0===rhs)return!1;switch(op){case"=":result=isDeepEqual(lhs,rhs);break;case"!=":result=!isDeepEqual(lhs,rhs)}return result}function evaluateComparisonExpression(lhs,rhs,op){var result,ltype=typeof lhs,rtype=typeof rhs;if("undefined"!==ltype&&"string"!==ltype&&"number"!==ltype||"undefined"!==rtype&&"string"!==rtype&&"number"!==rtype)throw{code:"T2010",stack:(new Error).stack,value:"string"!==ltype&&"number"!==ltype?lhs:rhs};if("undefined"!==ltype&&"undefined"!==rtype){if(ltype!==rtype)throw{code:"T2009",stack:(new Error).stack,value:lhs,value2:rhs};switch(op){case"<":result=lhs<rhs;break;case"<=":result=lhs<=rhs;break;case">":result=lhs>rhs;break;case">=":result=lhs>=rhs}return result}}function evaluateIncludesExpression(lhs,rhs){var result=!1;if(void 0===lhs||void 0===rhs)return!1;Array.isArray(rhs)||(rhs=[rhs]);for(var i=0;i<rhs.length;i++)if(rhs[i]===lhs){result=!0;break}return result}function*evaluateBooleanExpression(lhs,evalrhs,op){var result,lBool=boolize(lhs);switch(op){case"and":result=lBool&&boolize(yield*evalrhs());break;case"or":result=lBool||boolize(yield*evalrhs())}return result}function boolize(value){var booledValue=fn.boolean(value);return void 0!==booledValue&&booledValue}function evaluateStringConcat(lhs,rhs){var lstr="",rstr="";return void 0!==lhs&&(lstr=fn.string(lhs)),void 0!==rhs&&(rstr=fn.string(rhs)),lstr.concat(rstr)}function*evaluateGroupExpression(expr,input,environment){var result={},groups={},reduce=!(!input||!input.tupleStream);Array.isArray(input)||(input=createSequence(input)),0===input.length&&input.push(void 0);for(var itemIndex=0;itemIndex<input.length;itemIndex++)for(var item=input[itemIndex],env=reduce?createFrameFromTuple(environment,item):environment,pairIndex=0;pairIndex<expr.lhs.length;pairIndex++){var pair=expr.lhs[pairIndex],key=yield*evaluate(pair[0],reduce?item["@"]:item,env);if("string"!=typeof key&&void 0!==key)throw{code:"T1003",stack:(new Error).stack,position:expr.position,value:key};if(void 0!==key){var entry={data:item,exprIndex:pairIndex};if(groups.hasOwnProperty(key)){if(groups[key].exprIndex!==pairIndex)throw{code:"D1009",stack:(new Error).stack,position:expr.position,value:key};groups[key].data=fn.append(groups[key].data,item)}else groups[key]=entry}}for(key in groups){var context=(entry=groups[key]).data;if(env=environment,reduce){var tuple=reduceTupleStream(entry.data);context=tuple["@"],delete tuple["@"],env=createFrameFromTuple(environment,tuple)}var value=yield*evaluate(expr.lhs[entry.exprIndex][1],context,env);void 0!==value&&(result[key]=value)}return result}function reduceTupleStream(tupleStream){if(!Array.isArray(tupleStream))return tupleStream;var result={};Object.assign(result,tupleStream[0]);for(var ii=1;ii<tupleStream.length;ii++)for(const prop in tupleStream[ii])result[prop]=fn.append(result[prop],tupleStream[ii][prop]);return result}function evaluateRangeExpression(lhs,rhs){var result;if(void 0!==lhs&&!Number.isInteger(lhs))throw{code:"T2003",stack:(new Error).stack,value:lhs};if(void 0!==rhs&&!Number.isInteger(rhs))throw{code:"T2004",stack:(new Error).stack,value:rhs};if(void 0===lhs||void 0===rhs)return result;if(lhs>rhs)return result;var size=rhs-lhs+1;if(size>1e7)throw{code:"D2014",stack:(new Error).stack,value:size};result=new Array(size);for(var item=lhs,index=0;item<=rhs;item++,index++)result[index]=item;return result.sequence=!0,result}function*evaluateBindExpression(expr,input,environment){var value=yield*evaluate(expr.rhs,input,environment);return environment.bind(expr.lhs.value,value),value}function*evaluateCondition(expr,input,environment){var result,condition=yield*evaluate(expr.condition,input,environment);return fn.boolean(condition)?result=yield*evaluate(expr.then,input,environment):void 0!==expr.else&&(result=yield*evaluate(expr.else,input,environment)),result}function*evaluateBlock(expr,input,environment){for(var result,frame=createFrame(environment),ii=0;ii<expr.expressions.length;ii++)result=yield*evaluate(expr.expressions[ii],input,frame);return result}function evaluateRegex(expr){var re=new jsonata.RegexEngine(expr.value),closure=function(str,fromIndex){var result;re.lastIndex=fromIndex||0;var match=re.exec(str);if(null!==match){if(result={match:match[0],start:match.index,end:match.index+match[0].length,groups:[]},match.length>1)for(var i=1;i<match.length;i++)result.groups.push(match[i]);result.next=function(){if(!(re.lastIndex>=str.length)){var next=closure(str,re.lastIndex);if(next&&""===next.match)throw{code:"D1004",stack:(new Error).stack,position:expr.position,value:expr.value.source};return next}}}return result};return closure}function evaluateVariable(expr,input,environment){return""===expr.value?input&&input.outerWrapper?input[0]:input:environment.lookup(expr.value)}function*evaluateSortExpression(expr,input,environment){var lhs=input,isTupleSort=!!input.tupleStream,comparator=function*(a,b){for(var comp=0,index=0;0===comp&&index<expr.terms.length;index++){var term=expr.terms[index],context=a,env=environment;isTupleSort&&(context=a["@"],env=createFrameFromTuple(environment,a));var aa=yield*evaluate(term.expression,context,env);context=b,env=environment,isTupleSort&&(context=b["@"],env=createFrameFromTuple(environment,b));var bb=yield*evaluate(term.expression,context,env),atype=typeof aa,btype=typeof bb;if("undefined"!==atype)if("undefined"!==btype){if("string"!==atype&&"number"!==atype||"string"!==btype&&"number"!==btype)throw{code:"T2008",stack:(new Error).stack,position:expr.position,value:"string"!==atype&&"number"!==atype?aa:bb};if(atype!==btype)throw{code:"T2007",stack:(new Error).stack,position:expr.position,value:aa,value2:bb};aa!==bb&&(comp=aa<bb?-1:1,!0===term.descending&&(comp=-comp))}else comp=-1;else comp="undefined"===btype?0:1}return 1===comp},focus={environment,input};return yield*fn.sort.apply(focus,[lhs,comparator])}function evaluateTransformExpression(expr,input,environment){return defineFunction((function*(obj){if(void 0!==obj){var cloneFunction=environment.lookup("clone");if(!isFunction(cloneFunction))throw{code:"T2013",stack:(new Error).stack,position:expr.position};var result=yield*apply(cloneFunction,[obj],null,environment),matches=yield*evaluate(expr.pattern,result,environment);if(void 0!==matches){Array.isArray(matches)||(matches=[matches]);for(var ii=0;ii<matches.length;ii++){var match=matches[ii],update=yield*evaluate(expr.update,match,environment),updateType=typeof update;if("undefined"!==updateType){if("object"!==updateType||null===update||Array.isArray(update))throw{code:"T2011",stack:(new Error).stack,position:expr.update.position,value:update};for(var prop in update)match[prop]=update[prop]}if(void 0!==expr.delete){var deletions=yield*evaluate(expr.delete,match,environment);if(void 0!==deletions){var val=deletions;if(Array.isArray(deletions)||(deletions=[deletions]),!isArrayOfStrings(deletions))throw{code:"T2012",stack:(new Error).stack,position:expr.delete.position,value:val};for(var jj=0;jj<deletions.length;jj++)"object"==typeof match&&null!==match&&delete match[deletions[jj]]}}}}return result}}),"<(oa):o>")}var chainAST=parser("function($f, $g) { function($x){ $g($f($x)) } }");function*evaluateApplyExpression(expr,input,environment){var result,lhs=yield*evaluate(expr.lhs,input,environment);if("function"===expr.rhs.type)result=yield*evaluateFunction(expr.rhs,input,environment,{context:lhs});else{var func=yield*evaluate(expr.rhs,input,environment);if(!isFunction(func))throw{code:"T2006",stack:(new Error).stack,position:expr.position,value:func};if(isFunction(lhs)){var chain=yield*evaluate(chainAST,null,environment);result=yield*apply(chain,[lhs,func],null,environment)}else result=yield*apply(func,[lhs],null,environment)}return result}function*evaluateFunction(expr,input,environment,applyto){var result,proc=yield*evaluate(expr.procedure,input,environment);if(void 0===proc&&"path"===expr.procedure.type&&environment.lookup(expr.procedure.steps[0].value))throw{code:"T1005",stack:(new Error).stack,position:expr.position,token:expr.procedure.steps[0].value};var evaluatedArgs=[];void 0!==applyto&&evaluatedArgs.push(applyto.context);for(var jj=0;jj<expr.arguments.length;jj++){const arg=yield*evaluate(expr.arguments[jj],input,environment);if(isFunction(arg)){const closure=function*(...params){return yield*apply(arg,params,null,environment)};closure.arity=getFunctionArity(arg),evaluatedArgs.push(closure)}else evaluatedArgs.push(arg)}var procName="path"===expr.procedure.type?expr.procedure.steps[0].value:expr.procedure.value;try{"object"==typeof proc&&(proc.token=procName,proc.position=expr.position),result=yield*apply(proc,evaluatedArgs,input,environment)}catch(err){throw err.position||(err.position=expr.position),err.token||(err.token=procName),err}return result}function*apply(proc,args,input,environment){var result;for(result=yield*applyInner(proc,args,input,environment);isLambda(result)&&!0===result.thunk;){var next=yield*evaluate(result.body.procedure,result.input,result.environment);"variable"===result.body.procedure.type&&(next.token=result.body.procedure.value),next.position=result.body.procedure.position;for(var evaluatedArgs=[],ii=0;ii<result.body.arguments.length;ii++)evaluatedArgs.push(yield*evaluate(result.body.arguments[ii],result.input,result.environment));result=yield*applyInner(next,evaluatedArgs,input,environment)}return result}function*applyInner(proc,args,input,environment){var result;try{var validatedArgs=args;if(proc&&(validatedArgs=validateArguments(proc.signature,args,input)),isLambda(proc))result=yield*applyProcedure(proc,validatedArgs);else if(proc&&!0===proc._jsonata_function){var focus={environment,input};result=proc.implementation.apply(focus,validatedArgs),isIterable(result)&&(result=yield*result)}else{if("function"!=typeof proc)throw{code:"T1006",stack:(new Error).stack};result=proc.apply(input,validatedArgs),isIterable(result)&&(result=yield*result)}}catch(err){throw proc&&(void 0===err.token&&void 0!==proc.token&&(err.token=proc.token),err.position=proc.position),err}return result}function evaluateLambda(expr,input,environment){var procedure={_jsonata_lambda:!0,input,environment,arguments:expr.arguments,signature:expr.signature,body:expr.body};return!0===expr.thunk&&(procedure.thunk=!0),procedure.apply=function*(self,args){return yield*apply(procedure,args,input,self.environment)},procedure}function*evaluatePartialApplication(expr,input,environment){for(var result,evaluatedArgs=[],ii=0;ii<expr.arguments.length;ii++){var arg=expr.arguments[ii];"operator"===arg.type&&"?"===arg.value?evaluatedArgs.push(arg):evaluatedArgs.push(yield*evaluate(arg,input,environment))}var proc=yield*evaluate(expr.procedure,input,environment);if(void 0===proc&&"path"===expr.procedure.type&&environment.lookup(expr.procedure.steps[0].value))throw{code:"T1007",stack:(new Error).stack,position:expr.position,token:expr.procedure.steps[0].value};if(isLambda(proc))result=partialApplyProcedure(proc,evaluatedArgs);else if(proc&&!0===proc._jsonata_function)result=partialApplyNativeFunction(proc.implementation,evaluatedArgs);else{if("function"!=typeof proc)throw{code:"T1008",stack:(new Error).stack,position:expr.position,token:"path"===expr.procedure.type?expr.procedure.steps[0].value:expr.procedure.value};result=partialApplyNativeFunction(proc,evaluatedArgs)}return result}function validateArguments(signature,args,context){return void 0===signature?args:signature.validate(args,context)}function*applyProcedure(proc,args){var env=createFrame(proc.environment);return proc.arguments.forEach((function(param,index){env.bind(param.value,args[index])})),"function"==typeof proc.body?yield*applyNativeFunction(proc.body,env):yield*evaluate(proc.body,proc.input,env)}function partialApplyProcedure(proc,args){var env=createFrame(proc.environment),unboundArgs=[];return proc.arguments.forEach((function(param,index){var arg=args[index];arg&&"operator"===arg.type&&"?"===arg.value?unboundArgs.push(param):env.bind(param.value,arg)})),{_jsonata_lambda:!0,input:proc.input,environment:env,arguments:unboundArgs,body:proc.body}}function partialApplyNativeFunction(native,args){var sigArgs=getNativeFunctionArguments(native),body="function("+(sigArgs=sigArgs.map((function(sigArg){return"$"+sigArg.trim()}))).join(", ")+"){ _ }",bodyAST=parser(body);return bodyAST.body=native,partialApplyProcedure(bodyAST,args)}function*applyNativeFunction(proc,env){var args=getNativeFunctionArguments(proc).map((function(sigArg){return env.lookup(sigArg.trim())})),focus={environment:env},result=proc.apply(focus,args);return isIterable(result)&&(result=yield*result),result}function getNativeFunctionArguments(func){var signature=func.toString();return/\(([^)]*)\)/.exec(signature)[1].split(",")}function defineFunction(func,signature){var definition={_jsonata_function:!0,implementation:func};return void 0!==signature&&(definition.signature=parseSignature(signature)),definition}function*functionEval(expr,focus){if(void 0!==expr){var input=this.input;void 0!==focus&&(input=focus,Array.isArray(input)&&!isSequence(input)&&((input=createSequence(input)).outerWrapper=!0));try{var ast=parser(expr,!1)}catch(err){throw populateMessage(err),{stack:(new Error).stack,code:"D3120",value:err.message,error:err}}try{var result=yield*evaluate(ast,input,this.environment)}catch(err){throw populateMessage(err),{stack:(new Error).stack,code:"D3121",value:err.message,error:err}}return result}}function functionClone(arg){if(void 0!==arg)return JSON.parse(fn.string(arg))}function createFrame(enclosingEnvironment){var bindings={};return{bind:function(name,value){bindings[name]=value},lookup:function(name){var value;return bindings.hasOwnProperty(name)?value=bindings[name]:enclosingEnvironment&&(value=enclosingEnvironment.lookup(name)),value},timestamp:enclosingEnvironment?enclosingEnvironment.timestamp:null,async:!!enclosingEnvironment&&enclosingEnvironment.async,global:enclosingEnvironment?enclosingEnvironment.global:{ancestry:[null]}}}staticFrame.bind("sum",defineFunction(fn.sum,"<a<n>:n>")),staticFrame.bind("count",defineFunction(fn.count,"<a:n>")),staticFrame.bind("max",defineFunction(fn.max,"<a<n>:n>")),staticFrame.bind("min",defineFunction(fn.min,"<a<n>:n>")),staticFrame.bind("average",defineFunction(fn.average,"<a<n>:n>")),staticFrame.bind("string",defineFunction(fn.string,"<x-b?:s>")),staticFrame.bind("substring",defineFunction(fn.substring,"<s-nn?:s>")),staticFrame.bind("substringBefore",defineFunction(fn.substringBefore,"<s-s:s>")),staticFrame.bind("substringAfter",defineFunction(fn.substringAfter,"<s-s:s>")),staticFrame.bind("lowercase",defineFunction(fn.lowercase,"<s-:s>")),staticFrame.bind("uppercase",defineFunction(fn.uppercase,"<s-:s>")),staticFrame.bind("length",defineFunction(fn.length,"<s-:n>")),staticFrame.bind("trim",defineFunction(fn.trim,"<s-:s>")),staticFrame.bind("pad",defineFunction(fn.pad,"<s-ns?:s>")),staticFrame.bind("match",defineFunction(fn.match,"<s-f<s:o>n?:a<o>>")),staticFrame.bind("contains",defineFunction(fn.contains,"<s-(sf):b>")),staticFrame.bind("replace",defineFunction(fn.replace,"<s-(sf)(sf)n?:s>")),staticFrame.bind("split",defineFunction(fn.split,"<s-(sf)n?:a<s>>")),staticFrame.bind("join",defineFunction(fn.join,"<a<s>s?:s>")),staticFrame.bind("formatNumber",defineFunction(fn.formatNumber,"<n-so?:s>")),staticFrame.bind("formatBase",defineFunction(fn.formatBase,"<n-n?:s>")),staticFrame.bind("formatInteger",defineFunction(datetime.formatInteger,"<n-s:s>")),staticFrame.bind("parseInteger",defineFunction(datetime.parseInteger,"<s-s:n>")),staticFrame.bind("number",defineFunction(fn.number,"<(nsb)-:n>")),staticFrame.bind("floor",defineFunction(fn.floor,"<n-:n>")),staticFrame.bind("ceil",defineFunction(fn.ceil,"<n-:n>")),staticFrame.bind("round",defineFunction(fn.round,"<n-n?:n>")),staticFrame.bind("abs",defineFunction(fn.abs,"<n-:n>")),staticFrame.bind("sqrt",defineFunction(fn.sqrt,"<n-:n>")),staticFrame.bind("power",defineFunction(fn.power,"<n-n:n>")),staticFrame.bind("random",defineFunction(fn.random,"<:n>")),staticFrame.bind("boolean",defineFunction(fn.boolean,"<x-:b>")),staticFrame.bind("not",defineFunction(fn.not,"<x-:b>")),staticFrame.bind("map",defineFunction(fn.map,"<af>")),staticFrame.bind("zip",defineFunction(fn.zip,"<a+>")),staticFrame.bind("filter",defineFunction(fn.filter,"<af>")),staticFrame.bind("single",defineFunction(fn.single,"<af?>")),staticFrame.bind("reduce",defineFunction(fn.foldLeft,"<afj?:j>")),staticFrame.bind("sift",defineFunction(fn.sift,"<o-f?:o>")),staticFrame.bind("keys",defineFunction(fn.keys,"<x-:a<s>>")),staticFrame.bind("lookup",defineFunction(fn.lookup,"<x-s:x>")),staticFrame.bind("append",defineFunction(fn.append,"<xx:a>")),staticFrame.bind("exists",defineFunction(fn.exists,"<x:b>")),staticFrame.bind("spread",defineFunction(fn.spread,"<x-:a<o>>")),staticFrame.bind("merge",defineFunction(fn.merge,"<a<o>:o>")),staticFrame.bind("reverse",defineFunction(fn.reverse,"<a:a>")),staticFrame.bind("each",defineFunction(fn.each,"<o-f:a>")),staticFrame.bind("error",defineFunction(fn.error,"<s?:x>")),staticFrame.bind("assert",defineFunction(fn.assert,"<bs?:x>")),staticFrame.bind("type",defineFunction(fn.type,"<x:s>")),staticFrame.bind("sort",defineFunction(fn.sort,"<af?:a>")),staticFrame.bind("shuffle",defineFunction(fn.shuffle,"<a:a>")),staticFrame.bind("distinct",defineFunction(fn.distinct,"<x:x>")),staticFrame.bind("base64encode",defineFunction(fn.base64encode,"<s-:s>")),staticFrame.bind("base64decode",defineFunction(fn.base64decode,"<s-:s>")),staticFrame.bind("encodeUrlComponent",defineFunction(fn.encodeUrlComponent,"<s-:s>")),staticFrame.bind("encodeUrl",defineFunction(fn.encodeUrl,"<s-:s>")),staticFrame.bind("decodeUrlComponent",defineFunction(fn.decodeUrlComponent,"<s-:s>")),staticFrame.bind("decodeUrl",defineFunction(fn.decodeUrl,"<s-:s>")),staticFrame.bind("eval",defineFunction(functionEval,"<sx?:x>")),staticFrame.bind("toMillis",defineFunction(datetime.toMillis,"<s-s?:n>")),staticFrame.bind("fromMillis",defineFunction(datetime.fromMillis,"<n-s?s?:s>")),staticFrame.bind("clone",defineFunction(functionClone,"<(oa)-:o>"));var errorCodes={S0101:"String literal must be terminated by a matching quote",S0102:"Number out of range: {{token}}",S0103:"Unsupported escape sequence: \\{{token}}",S0104:"The escape sequence \\u must be followed by 4 hex digits",S0105:"Quoted property name must be terminated with a backquote (`)",S0106:"Comment has no closing tag",S0201:"Syntax error: {{token}}",S0202:"Expected {{value}}, got {{token}}",S0203:"Expected {{value}} before end of expression",S0204:"Unknown operator: {{token}}",S0205:"Unexpected token: {{token}}",S0206:"Unknown expression type: {{token}}",S0207:"Unexpected end of expression",S0208:"Parameter {{value}} of function definition must be a variable name (start with $)",S0209:"A predicate cannot follow a grouping expression in a step",S0210:"Each step can only have one grouping expression",S0211:"The symbol {{token}} cannot be used as a unary operator",S0212:"The left side of := must be a variable name (start with $)",S0213:"The literal value {{value}} cannot be used as a step within a path expression",S0214:"The right side of {{token}} must be a variable name (start with $)",S0215:"A context variable binding must precede any predicates on a step",S0216:"A context variable binding must precede the 'order-by' clause on a step",S0217:"The object representing the 'parent' cannot be derived from this expression",S0301:"Empty regular expressions are not allowed",S0302:"No terminating / in regular expression",S0402:"Choice groups containing parameterized types are not supported",S0401:"Type parameters can only be applied to functions and arrays",S0500:"Attempted to evaluate an expression containing syntax error(s)",T0410:"Argument {{index}} of function {{token}} does not match function signature",T0411:"Context value is not a compatible type with argument {{index}} of function {{token}}",T0412:"Argument {{index}} of function {{token}} must be an array of {{type}}",D1001:"Number out of range: {{value}}",D1002:"Cannot negate a non-numeric value: {{value}}",T1003:"Key in object structure must evaluate to a string; got: {{value}}",D1004:"Regular expression matches zero length string",T1005:"Attempted to invoke a non-function. Did you mean ${{{token}}}?",T1006:"Attempted to invoke a non-function",T1007:"Attempted to partially apply a non-function. Did you mean ${{{token}}}?",T1008:"Attempted to partially apply a non-function",D1009:"Multiple key definitions evaluate to same key: {{value}}",T1010:"The matcher function argument passed to function {{token}} does not return the correct object structure",T2001:"The left side of the {{token}} operator must evaluate to a number",T2002:"The right side of the {{token}} operator must evaluate to a number",T2003:"The left side of the range operator (..) must evaluate to an integer",T2004:"The right side of the range operator (..) must evaluate to an integer",D2005:"The left side of := must be a variable name (start with $)",T2006:"The right side of the function application operator ~> must be a function",T2007:"Type mismatch when comparing values {{value}} and {{value2}} in order-by clause",T2008:"The expressions within an order-by clause must evaluate to numeric or string values",T2009:"The values {{value}} and {{value2}} either side of operator {{token}} must be of the same data type",T2010:"The expressions either side of operator {{token}} must evaluate to numeric or string values",T2011:"The insert/update clause of the transform expression must evaluate to an object: {{value}}",T2012:"The delete clause of the transform expression must evaluate to a string or array of strings: {{value}}",T2013:"The transform expression clones the input object using the $clone() function.  This has been overridden in the current scope by a non-function.",D2014:"The size of the sequence allocated by the range operator (..) must not exceed 1e6.  Attempted to allocate {{value}}.",D3001:"Attempting to invoke string function on Infinity or NaN",D3010:"Second argument of replace function cannot be an empty string",D3011:"Fourth argument of replace function must evaluate to a positive number",D3012:"Attempted to replace a matched string with a non-string value",D3020:"Third argument of split function must evaluate to a positive number",D3030:"Unable to cast value to a number: {{value}}",D3040:"Third argument of match function must evaluate to a positive number",D3050:"The second argument of reduce function must be a function with at least two arguments",D3060:"The sqrt function cannot be applied to a negative number: {{value}}",D3061:"The power function has resulted in a value that cannot be represented as a JSON number: base={{value}}, exponent={{exp}}",D3070:"The single argument form of the sort function can only be applied to an array of strings or an array of numbers.  Use the second argument to specify a comparison function",D3080:"The picture string must only contain a maximum of two sub-pictures",D3081:"The sub-picture must not contain more than one instance of the 'decimal-separator' character",D3082:"The sub-picture must not contain more than one instance of the 'percent' character",D3083:"The sub-picture must not contain more than one instance of the 'per-mille' character",D3084:"The sub-picture must not contain both a 'percent' and a 'per-mille' character",D3085:"The mantissa part of a sub-picture must contain at least one character that is either an 'optional digit character' or a member of the 'decimal digit family'",D3086:"The sub-picture must not contain a passive character that is preceded by an active character and that is followed by another active character",D3087:"The sub-picture must not contain a 'grouping-separator' character that appears adjacent to a 'decimal-separator' character",D3088:"The sub-picture must not contain a 'grouping-separator' at the end of the integer part",D3089:"The sub-picture must not contain two adjacent instances of the 'grouping-separator' character",D3090:"The integer part of the sub-picture must not contain a member of the 'decimal digit family' that is followed by an instance of the 'optional digit character'",D3091:"The fractional part of the sub-picture must not contain an instance of the 'optional digit character' that is followed by a member of the 'decimal digit family'",D3092:"A sub-picture that contains a 'percent' or 'per-mille' character must not contain a character treated as an 'exponent-separator'",D3093:"The exponent part of the sub-picture must comprise only of one or more characters that are members of the 'decimal digit family'",D3100:"The radix of the formatBase function must be between 2 and 36.  It was given {{value}}",D3110:"The argument of the toMillis function must be an ISO 8601 formatted timestamp. Given {{value}}",D3120:"Syntax error in expression passed to function eval: {{value}}",D3121:"Dynamic error evaluating the expression passed to function eval: {{value}}",D3130:"Formatting or parsing an integer as a sequence starting with {{value}} is not supported by this implementation",D3131:"In a decimal digit pattern, all digits must be from the same decimal group",D3132:"Unknown component specifier {{value}} in date/time picture string",D3133:"The 'name' modifier can only be applied to months and days in the date/time picture string, not {{value}}",D3134:"The timezone integer format specifier cannot have more than four digits",D3135:"No matching closing bracket ']' in date/time picture string",D3136:"The date/time picture string is missing specifiers required to parse the timestamp",D3137:"{{{message}}}",D3138:"The $single() function expected exactly 1 matching result.  Instead it matched more.",D3139:"The $single() function expected exactly 1 matching result.  Instead it matched 0.",D3140:"Malformed URL passed to ${{{functionName}}}(): {{value}}",D3141:"{{{message}}}"};function populateMessage(err){var template=errorCodes[err.code];if(void 0!==template){var message=template.replace(/\{\{\{([^}]+)}}}/g,(function(){return err[arguments[1]]}));message=message.replace(/\{\{([^}]+)}}/g,(function(){return JSON.stringify(err[arguments[1]])})),err.message=message}}function jsonata(expr,options){var ast,errors;try{ast=parser(expr,options&&options.recover),errors=ast.errors,delete ast.errors}catch(err){throw populateMessage(err),err}var environment=createFrame(staticFrame),timestamp=new Date;return environment.bind("now",defineFunction((function(picture,timezone){return datetime.fromMillis(timestamp.getTime(),picture,timezone)}),"<s?s?:s>")),environment.bind("millis",defineFunction((function(){return timestamp.getTime()}),"<:n>")),options&&options.RegexEngine?jsonata.RegexEngine=options.RegexEngine:jsonata.RegexEngine=RegExp,{evaluate:function(input,bindings,callback){if(void 0!==errors){var err={code:"S0500",position:0};throw populateMessage(err),err}var exec_env,result,it;if(void 0!==bindings)for(var v in exec_env=createFrame(environment),bindings)exec_env.bind(v,bindings[v]);else exec_env=environment;if(exec_env.bind("$",input),timestamp=new Date,exec_env.timestamp=timestamp,Array.isArray(input)&&!isSequence(input)&&((input=createSequence(input)).outerWrapper=!0),"function"==typeof callback){exec_env.async=!0;var catchHandler=function(err){populateMessage(err),callback(err,null)},thenHandler=function(response){(result=it.next(response)).done?callback(null,result.value):result.value.then(thenHandler).catch(catchHandler)};it=evaluate(ast,input,exec_env),(result=it.next()).value.then(thenHandler).catch(catchHandler)}else try{for(it=evaluate(ast,input,exec_env),result=it.next();!result.done;)result=it.next(result.value);return result.value}catch(err){throw populateMessage(err),err}},assign:function(name,value){environment.bind(name,value)},registerFunction:function(name,implementation,signature){var func=defineFunction(implementation,signature);environment.bind(name,func)},ast:function(){return ast},errors:function(){return errors}}}return jsonata.parser=parser,jsonata}();module.exports=jsonata},{"./datetime":1,"./functions":2,"./parser":4,"./signature":5,"./utils":6}],4:[function(require,module,exports){var parseSignature=require("./signature");const parser=(()=>{"use strict";var operators={".":75,"[":80,"]":0,"{":70,"}":0,"(":80,")":0,",":0,"@":80,"#":80,";":80,":":80,"?":20,"+":50,"-":50,"*":60,"/":60,"%":60,"|":20,"=":40,"<":40,">":40,"^":40,"**":60,"..":20,":=":10,"!=":40,"<=":40,">=":40,"~>":40,and:30,or:25,in:40,"&":50,"!":0,"~":0},escapes={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},tokenizer=function(path){var position=0,length=path.length,create=function(type,value){return{type,value,position}},scanRegex=function(){for(var pattern,flags,start=position,depth=0;position<length;){var currentChar=path.charAt(position);if("/"===currentChar&&"\\"!==path.charAt(position-1)&&0===depth){if(""===(pattern=path.substring(start,position)))throw{code:"S0301",stack:(new Error).stack,position};for(position++,currentChar=path.charAt(position),start=position;"i"===currentChar||"m"===currentChar;)position++,currentChar=path.charAt(position);return flags=path.substring(start,position)+"g",new RegExp(pattern,flags)}"("!==currentChar&&"["!==currentChar&&"{"!==currentChar||"\\"===path.charAt(position-1)||depth++,")"!==currentChar&&"]"!==currentChar&&"}"!==currentChar||"\\"===path.charAt(position-1)||depth--,position++}throw{code:"S0302",stack:(new Error).stack,position}},next=function(prefix){if(position>=length)return null;for(var currentChar=path.charAt(position);position<length&&" \t\n\r\v".indexOf(currentChar)>-1;)position++,currentChar=path.charAt(position);if("/"===currentChar&&"*"===path.charAt(position+1)){var commentStart=position;for(position+=2,currentChar=path.charAt(position);"*"!==currentChar||"/"!==path.charAt(position+1);)if(currentChar=path.charAt(++position),position>=length)throw{code:"S0106",stack:(new Error).stack,position:commentStart};return position+=2,currentChar=path.charAt(position),next(prefix)}if(!0!==prefix&&"/"===currentChar)return position++,create("regex",scanRegex());if("."===currentChar&&"."===path.charAt(position+1))return position+=2,create("operator","..");if(":"===currentChar&&"="===path.charAt(position+1))return position+=2,create("operator",":=");if("!"===currentChar&&"="===path.charAt(position+1))return position+=2,create("operator","!=");if(">"===currentChar&&"="===path.charAt(position+1))return position+=2,create("operator",">=");if("<"===currentChar&&"="===path.charAt(position+1))return position+=2,create("operator","<=");if("*"===currentChar&&"*"===path.charAt(position+1))return position+=2,create("operator","**");if("~"===currentChar&&">"===path.charAt(position+1))return position+=2,create("operator","~>");if(Object.prototype.hasOwnProperty.call(operators,currentChar))return position++,create("operator",currentChar);if('"'===currentChar||"'"===currentChar){var quoteType=currentChar;position++;for(var qstr="";position<length;){if("\\"===(currentChar=path.charAt(position)))if(position++,currentChar=path.charAt(position),Object.prototype.hasOwnProperty.call(escapes,currentChar))qstr+=escapes[currentChar];else{if("u"!==currentChar)throw{code:"S0103",stack:(new Error).stack,position,token:currentChar};var octets=path.substr(position+1,4);if(!/^[0-9a-fA-F]+$/.test(octets))throw{code:"S0104",stack:(new Error).stack,position};var codepoint=parseInt(octets,16);qstr+=String.fromCharCode(codepoint),position+=4}else{if(currentChar===quoteType)return position++,create("string",qstr);qstr+=currentChar}position++}throw{code:"S0101",stack:(new Error).stack,position}}var name,match=/^-?(0|([1-9][0-9]*))(\.[0-9]+)?([Ee][-+]?[0-9]+)?/.exec(path.substring(position));if(null!==match){var num=parseFloat(match[0]);if(!isNaN(num)&&isFinite(num))return position+=match[0].length,create("number",num);throw{code:"S0102",stack:(new Error).stack,position,token:match[0]}}if("`"===currentChar){position++;var end=path.indexOf("`",position);if(-1!==end)return name=path.substring(position,end),position=end+1,create("name",name);throw position=length,{code:"S0105",stack:(new Error).stack,position}}for(var ch,i=position;;)if(ch=path.charAt(i),i===length||" \t\n\r\v".indexOf(ch)>-1||Object.prototype.hasOwnProperty.call(operators,ch)){if("$"===path.charAt(position))return name=path.substring(position+1,i),position=i,create("variable",name);switch(name=path.substring(position,i),position=i,name){case"or":case"in":case"and":return create("operator",name);case"true":return create("value",!0);case"false":return create("value",!1);case"null":return create("value",null);default:return position===length&&""===name?null:create("name",name)}}else i++};return next};return function(source,recover){var node,lexer,symbol_table={},errors=[],remainingTokens=function(){var remaining=[];"(end)"!==node.id&&remaining.push({type:node.type,value:node.value,position:node.position});for(var nxt=lexer();null!==nxt;)remaining.push(nxt),nxt=lexer();return remaining},base_symbol={nud:function(){var err={code:"S0211",token:this.value,position:this.position};if(recover)return err.remaining=remainingTokens(),err.type="error",errors.push(err),err;throw err.stack=(new Error).stack,err}},symbol=function(id,bp){var s=symbol_table[id];return bp=bp||0,s?bp>=s.lbp&&(s.lbp=bp):((s=Object.create(base_symbol)).id=s.value=id,s.lbp=bp,symbol_table[id]=s),s},handleError=function(err){if(recover){err.remaining=remainingTokens(),errors.push(err);var symbol=symbol_table["(error)"];return(node=Object.create(symbol)).error=err,node.type="(error)",node}throw err.stack=(new Error).stack,err},advance=function(id,infix){if(id&&node.id!==id){var err={code:"(end)"===node.id?"S0203":"S0202",position:node.position,token:node.value,value:id};return handleError(err)}var next_token=lexer(infix);if(null===next_token)return(node=symbol_table["(end)"]).position=source.length,node;var symbol,value=next_token.value,type=next_token.type;switch(type){case"name":case"variable":symbol=symbol_table["(name)"];break;case"operator":if(!(symbol=symbol_table[value]))return handleError({code:"S0204",stack:(new Error).stack,position:next_token.position,token:value});break;case"string":case"number":case"value":symbol=symbol_table["(literal)"];break;case"regex":type="regex",symbol=symbol_table["(regex)"];break;default:return handleError({code:"S0205",stack:(new Error).stack,position:next_token.position,token:value})}return(node=Object.create(symbol)).value=value,node.type=type,node.position=next_token.position,node},expression=function(rbp){var left,t=node;for(advance(null,!0),left=t.nud();rbp<node.lbp;)t=node,advance(),left=t.led(left);return left},terminal=function(id){symbol(id,0).nud=function(){return this}},infix=function(id,bp,led){var bindingPower=bp||operators[id],s=symbol(id,bindingPower);return s.led=led||function(left){return this.lhs=left,this.rhs=expression(bindingPower),this.type="binary",this},s},infixr=function(id,bp,led){var s=symbol(id,bp);return s.led=led,s},prefix=function(id,nud){var s=symbol(id);return s.nud=nud||function(){return this.expression=expression(70),this.type="unary",this},s};terminal("(end)"),terminal("(name)"),terminal("(literal)"),terminal("(regex)"),symbol(":"),symbol(";"),symbol(","),symbol(")"),symbol("]"),symbol("}"),symbol(".."),infix("."),infix("+"),infix("-"),infix("*"),infix("/"),infix("%"),infix("="),infix("<"),infix(">"),infix("!="),infix("<="),infix(">="),infix("&"),infix("and"),infix("or"),infix("in"),terminal("and"),terminal("or"),terminal("in"),prefix("-"),infix("~>"),infixr("(error)",10,(function(left){return this.lhs=left,this.error=node.error,this.remaining=remainingTokens(),this.type="error",this})),prefix("*",(function(){return this.type="wildcard",this})),prefix("**",(function(){return this.type="descendant",this})),prefix("%",(function(){return this.type="parent",this})),infix("(",operators["("],(function(left){if(this.procedure=left,this.type="function",this.arguments=[],")"!==node.id)for(;"operator"===node.type&&"?"===node.id?(this.type="partial",this.arguments.push(node),advance("?")):this.arguments.push(expression(0)),","===node.id;)advance(",");if(advance(")",!0),"name"===left.type&&("function"===left.value||"λ"===left.value)){if(this.arguments.forEach((function(arg,index){if("variable"!==arg.type)return handleError({code:"S0208",stack:(new Error).stack,position:arg.position,token:arg.value,value:index+1})})),this.type="lambda","<"===node.id){for(var sigPos=node.position,depth=1,sig="<";depth>0&&"{"!==node.id&&"(end)"!==node.id;){var tok=advance();">"===tok.id?depth--:"<"===tok.id&&depth++,sig+=tok.value}advance(">");try{this.signature=parseSignature(sig)}catch(err){return err.position=sigPos+err.offset,handleError(err)}}advance("{"),this.body=expression(0),advance("}")}return this})),prefix("(",(function(){for(var expressions=[];")"!==node.id&&(expressions.push(expression(0)),";"===node.id);)advance(";");return advance(")",!0),this.type="block",this.expressions=expressions,this})),prefix("[",(function(){var a=[];if("]"!==node.id)for(;;){var item=expression(0);if(".."===node.id){var range={type:"binary",value:"..",position:node.position,lhs:item};advance(".."),range.rhs=expression(0),item=range}if(a.push(item),","!==node.id)break;advance(",")}return advance("]",!0),this.expressions=a,this.type="unary",this})),infix("[",operators["["],(function(left){if("]"===node.id){for(var step=left;step&&"binary"===step.type&&"["===step.value;)step=step.lhs;return step.keepArray=!0,advance("]"),left}return this.lhs=left,this.rhs=expression(operators["]"]),this.type="binary",advance("]",!0),this})),infix("^",operators["^"],(function(left){advance("(");for(var terms=[];;){var term={descending:!1};if("<"===node.id?advance("<"):">"===node.id&&(term.descending=!0,advance(">")),term.expression=expression(0),terms.push(term),","!==node.id)break;advance(",")}return advance(")"),this.lhs=left,this.rhs=terms,this.type="binary",this}));var objectParser=function(left){var a=[];if("}"!==node.id)for(;;){var n=expression(0);advance(":");var v=expression(0);if(a.push([n,v]),","!==node.id)break;advance(",")}return advance("}",!0),void 0===left?(this.lhs=a,this.type="unary"):(this.lhs=left,this.rhs=a,this.type="binary"),this};prefix("{",objectParser),infix("{",operators["{"],objectParser),infixr(":=",operators[":="],(function(left){return"variable"!==left.type?handleError({code:"S0212",stack:(new Error).stack,position:left.position,token:left.value}):(this.lhs=left,this.rhs=expression(operators[":="]-1),this.type="binary",this)})),infix("@",operators["@"],(function(left){return this.lhs=left,this.rhs=expression(operators["@"]),"variable"!==this.rhs.type?handleError({code:"S0214",stack:(new Error).stack,position:this.rhs.position,token:"@"}):(this.type="binary",this)})),infix("#",operators["#"],(function(left){return this.lhs=left,this.rhs=expression(operators["#"]),"variable"!==this.rhs.type?handleError({code:"S0214",stack:(new Error).stack,position:this.rhs.position,token:"#"}):(this.type="binary",this)})),infix("?",operators["?"],(function(left){return this.type="condition",this.condition=left,this.then=expression(0),":"===node.id&&(advance(":"),this.else=expression(0)),this})),prefix("|",(function(){return this.type="transform",this.pattern=expression(0),advance("|"),this.update=expression(0),","===node.id&&(advance(","),this.delete=expression(0)),advance("|"),this}));var tailCallOptimize=function(expr){var result;if("function"!==expr.type||expr.predicate)if("condition"===expr.type)expr.then=tailCallOptimize(expr.then),void 0!==expr.else&&(expr.else=tailCallOptimize(expr.else)),result=expr;else if("block"===expr.type){var length=expr.expressions.length;length>0&&(expr.expressions[length-1]=tailCallOptimize(expr.expressions[length-1])),result=expr}else result=expr;else{var thunk={type:"lambda",thunk:!0,arguments:[],position:expr.position};thunk.body=expr,result=thunk}return result},ancestorLabel=0,ancestorIndex=0,ancestry=[],seekParent=function(node,slot){switch(node.type){case"name":case"wildcard":slot.level--,0===slot.level&&(void 0===node.ancestor||(ancestry[slot.index].slot.label=node.ancestor.label),node.ancestor=slot,node.tuple=!0);break;case"parent":slot.level++;break;case"block":node.expressions.length>0&&(node.tuple=!0,slot=seekParent(node.expressions[node.expressions.length-1],slot));break;case"path":node.tuple=!0;var index=node.steps.length-1;for(slot=seekParent(node.steps[index--],slot);slot.level>0&&index>=0;)slot=seekParent(node.steps[index--],slot);break;default:throw{code:"S0217",token:node.type,position:node.position}}return slot},pushAncestry=function(result,value){if(void 0!==value.seekingParent||"parent"===value.type){var slots=void 0!==value.seekingParent?value.seekingParent:[];"parent"===value.type&&slots.push(value.slot),void 0===result.seekingParent?result.seekingParent=slots:Array.prototype.push.apply(result.seekingParent,slots)}},resolveAncestry=function(path){var index=path.steps.length-1,laststep=path.steps[index],slots=void 0!==laststep.seekingParent?laststep.seekingParent:[];"parent"===laststep.type&&slots.push(laststep.slot);for(var is=0;is<slots.length;is++){var slot=slots[is];for(index=path.steps.length-2;slot.level>0;){if(index<0){void 0===path.seekingParent?path.seekingParent=[slot]:path.seekingParent.push(slot);break}for(var step=path.steps[index--];index>=0&&step.focus&&path.steps[index].focus;)step=path.steps[index--];slot=seekParent(step,slot)}}},processAST=function(expr){var result;switch(expr.type){case"binary":switch(expr.value){case".":var lstep=processAST(expr.lhs);result="path"===lstep.type?lstep:{type:"path",steps:[lstep]},"parent"===lstep.type&&(result.seekingParent=[lstep.slot]);var rest=processAST(expr.rhs);"function"===rest.type&&"path"===rest.procedure.type&&1===rest.procedure.steps.length&&"name"===rest.procedure.steps[0].type&&"function"===result.steps[result.steps.length-1].type&&(result.steps[result.steps.length-1].nextFunction=rest.procedure.steps[0].value),"path"===rest.type?Array.prototype.push.apply(result.steps,rest.steps):(void 0!==rest.predicate&&(rest.stages=rest.predicate,delete rest.predicate),result.steps.push(rest)),result.steps.filter((function(step){if("number"===step.type||"value"===step.type)throw{code:"S0213",stack:(new Error).stack,position:step.position,value:step.value};return"string"===step.type})).forEach((function(lit){lit.type="name"})),result.steps.filter((function(step){return!0===step.keepArray})).length>0&&(result.keepSingletonArray=!0);var firststep=result.steps[0];"unary"===firststep.type&&"["===firststep.value&&(firststep.consarray=!0);var laststep=result.steps[result.steps.length-1];"unary"===laststep.type&&"["===laststep.value&&(laststep.consarray=!0),resolveAncestry(result);break;case"[":var step=result=processAST(expr.lhs),type="predicate";if("path"===result.type&&(step=result.steps[result.steps.length-1],type="stages"),void 0!==step.group)throw{code:"S0209",stack:(new Error).stack,position:expr.position};void 0===step[type]&&(step[type]=[]);var predicate=processAST(expr.rhs);void 0!==predicate.seekingParent&&(predicate.seekingParent.forEach((slot=>{1===slot.level?seekParent(step,slot):slot.level--})),pushAncestry(step,predicate)),step[type].push({type:"filter",expr:predicate,position:expr.position});break;case"{":if(void 0!==(result=processAST(expr.lhs)).group)throw{code:"S0210",stack:(new Error).stack,position:expr.position};result.group={lhs:expr.rhs.map((function(pair){return[processAST(pair[0]),processAST(pair[1])]})),position:expr.position};break;case"^":"path"!==(result=processAST(expr.lhs)).type&&(result={type:"path",steps:[result]});var sortStep={type:"sort",position:expr.position};sortStep.terms=expr.rhs.map((function(terms){var expression=processAST(terms.expression);return pushAncestry(sortStep,expression),{descending:terms.descending,expression}})),result.steps.push(sortStep),resolveAncestry(result);break;case":=":(result={type:"bind",value:expr.value,position:expr.position}).lhs=processAST(expr.lhs),result.rhs=processAST(expr.rhs),pushAncestry(result,result.rhs);break;case"@":if(result=processAST(expr.lhs),step=result,"path"===result.type&&(step=result.steps[result.steps.length-1]),void 0!==step.stages||void 0!==step.predicate)throw{code:"S0215",stack:(new Error).stack,position:expr.position};if("sort"===step.type)throw{code:"S0216",stack:(new Error).stack,position:expr.position};expr.keepArray&&(step.keepArray=!0),step.focus=expr.rhs.value,step.tuple=!0;break;case"#":result=processAST(expr.lhs),step=result,"path"===result.type?step=result.steps[result.steps.length-1]:(result={type:"path",steps:[result]},void 0!==step.predicate&&(step.stages=step.predicate,delete step.predicate)),void 0===step.stages?step.index=expr.rhs.value:step.stages.push({type:"index",value:expr.rhs.value,position:expr.position}),step.tuple=!0;break;case"~>":(result={type:"apply",value:expr.value,position:expr.position}).lhs=processAST(expr.lhs),result.rhs=processAST(expr.rhs);break;default:(result={type:expr.type,value:expr.value,position:expr.position}).lhs=processAST(expr.lhs),result.rhs=processAST(expr.rhs),pushAncestry(result,result.lhs),pushAncestry(result,result.rhs)}break;case"unary":result={type:expr.type,value:expr.value,position:expr.position},"["===expr.value?result.expressions=expr.expressions.map((function(item){var value=processAST(item);return pushAncestry(result,value),value})):"{"===expr.value?result.lhs=expr.lhs.map((function(pair){var key=processAST(pair[0]);pushAncestry(result,key);var value=processAST(pair[1]);return pushAncestry(result,value),[key,value]})):(result.expression=processAST(expr.expression),"-"===expr.value&&"number"===result.expression.type?(result=result.expression).value=-result.value:pushAncestry(result,result.expression));break;case"function":case"partial":(result={type:expr.type,name:expr.name,value:expr.value,position:expr.position}).arguments=expr.arguments.map((function(arg){var argAST=processAST(arg);return pushAncestry(result,argAST),argAST})),result.procedure=processAST(expr.procedure);break;case"lambda":result={type:expr.type,arguments:expr.arguments,signature:expr.signature,position:expr.position};var body=processAST(expr.body);result.body=tailCallOptimize(body);break;case"condition":(result={type:expr.type,position:expr.position}).condition=processAST(expr.condition),pushAncestry(result,result.condition),result.then=processAST(expr.then),pushAncestry(result,result.then),void 0!==expr.else&&(result.else=processAST(expr.else),pushAncestry(result,result.else));break;case"transform":(result={type:expr.type,position:expr.position}).pattern=processAST(expr.pattern),result.update=processAST(expr.update),void 0!==expr.delete&&(result.delete=processAST(expr.delete));break;case"block":(result={type:expr.type,position:expr.position}).expressions=expr.expressions.map((function(item){var part=processAST(item);return pushAncestry(result,part),(part.consarray||"path"===part.type&&part.steps[0].consarray)&&(result.consarray=!0),part}));break;case"name":result={type:"path",steps:[expr]},expr.keepArray&&(result.keepSingletonArray=!0);break;case"parent":result={type:"parent",slot:{label:"!"+ancestorLabel++,level:1,index:ancestorIndex++}},ancestry.push(result);break;case"string":case"number":case"value":case"wildcard":case"descendant":case"variable":case"regex":result=expr;break;case"operator":if("and"===expr.value||"or"===expr.value||"in"===expr.value)expr.type="name",result=processAST(expr);else{if("?"!==expr.value)throw{code:"S0201",stack:(new Error).stack,position:expr.position,token:expr.value};result=expr}break;case"error":result=expr,expr.lhs&&(result=processAST(expr.lhs));break;default:var code="S0206";"(end)"===expr.id&&(code="S0207");var err={code,position:expr.position,token:expr.value};if(recover)return errors.push(err),{type:"error",error:err};throw err.stack=(new Error).stack,err}return expr.keepArray&&(result.keepArray=!0),result};lexer=tokenizer(source),advance();var expr=expression(0);if("(end)"!==node.id){var err={code:"S0201",position:node.position,token:node.value};handleError(err)}if("parent"===(expr=processAST(expr)).type||void 0!==expr.seekingParent)throw{code:"S0217",token:expr.type,position:expr.position};return errors.length>0&&(expr.errors=errors),expr}})();module.exports=parser},{"./signature":5}],5:[function(require,module,exports){var utils=require("./utils");const signature=(()=>{"use strict";var arraySignatureMapping={a:"arrays",b:"booleans",f:"functions",n:"numbers",o:"objects",s:"strings"};function parseSignature(signature){for(var position=1,params=[],param={},prevParam=param;position<signature.length;){var symbol=signature.charAt(position);if(":"===symbol)break;var next=function(){params.push(param),prevParam=param,param={}},findClosingBracket=function(str,start,openSymbol,closeSymbol){for(var depth=1,position=start;position<str.length;)if(position++,(symbol=str.charAt(position))===closeSymbol){if(0==--depth)break}else symbol===openSymbol&&depth++;return position};switch(symbol){case"s":case"n":case"b":case"l":case"o":param.regex="["+symbol+"m]",param.type=symbol,next();break;case"a":param.regex="[asnblfom]",param.type=symbol,param.array=!0,next();break;case"f":param.regex="f",param.type=symbol,next();break;case"j":param.regex="[asnblom]",param.type=symbol,next();break;case"x":param.regex="[asnblfom]",param.type=symbol,next();break;case"-":prevParam.context=!0,prevParam.contextRegex=new RegExp(prevParam.regex),prevParam.regex+="?";break;case"?":case"+":prevParam.regex+=symbol;break;case"(":var endParen=findClosingBracket(signature,position,"(",")"),choice=signature.substring(position+1,endParen);if(-1!==choice.indexOf("<"))throw{code:"S0402",stack:(new Error).stack,value:choice,offset:position};param.regex="["+choice+"m]",param.type="("+choice+")",position=endParen,next();break;case"<":if("a"!==prevParam.type&&"f"!==prevParam.type)throw{code:"S0401",stack:(new Error).stack,value:prevParam.type,offset:position};var endPos=findClosingBracket(signature,position,"<",">");prevParam.subtype=signature.substring(position+1,endPos),position=endPos}position++}var regexStr="^"+params.map((function(param){return"("+param.regex+")"})).join("")+"$",regex=new RegExp(regexStr),getSymbol=function(value){var symbol;if(utils.isFunction(value))symbol="f";else switch(typeof value){case"string":symbol="s";break;case"number":symbol="n";break;case"boolean":symbol="b";break;case"object":symbol=null===value?"l":Array.isArray(value)?"a":"o";break;default:symbol="m"}return symbol},throwValidationError=function(badArgs,badSig){for(var partialPattern="^",goodTo=0,index=0;index<params.length;index++){partialPattern+=params[index].regex;var match=badSig.match(partialPattern);if(null===match)throw{code:"T0410",stack:(new Error).stack,value:badArgs[goodTo],index:goodTo+1};goodTo=match[0].length}throw{code:"T0410",stack:(new Error).stack,value:badArgs[goodTo],index:goodTo+1}};return{definition:signature,validate:function(args,context){var suppliedSig="";args.forEach((function(arg){suppliedSig+=getSymbol(arg)}));var isValid=regex.exec(suppliedSig);if(isValid){var validatedArgs=[],argIndex=0;return params.forEach((function(param,index){var arg=args[argIndex],match=isValid[index+1];if(""===match)if(param.context&&param.contextRegex){var contextType=getSymbol(context);if(!param.contextRegex.test(contextType))throw{code:"T0411",stack:(new Error).stack,value:context,index:argIndex+1};validatedArgs.push(context)}else validatedArgs.push(arg),argIndex++;else match.split("").forEach((function(single){if("a"===param.type){if("m"===single)arg=void 0;else{arg=args[argIndex];var arrayOK=!0;if(void 0!==param.subtype)if("a"!==single&&match!==param.subtype)arrayOK=!1;else if("a"===single&&arg.length>0){var itemType=getSymbol(arg[0]);arrayOK=itemType===param.subtype.charAt(0)&&0===arg.filter((function(val){return getSymbol(val)!==itemType})).length}if(!arrayOK)throw{code:"T0412",stack:(new Error).stack,value:arg,index:argIndex+1,type:arraySignatureMapping[param.subtype]};"a"!==single&&(arg=[arg])}validatedArgs.push(arg),argIndex++}else validatedArgs.push(arg),argIndex++}))})),validatedArgs}throwValidationError(args,suppliedSig)}}}return parseSignature})();module.exports=signature},{"./utils":6}],6:[function(require,module,exports){const utils=(()=>{"use strict";function isNumeric(n){var isNum=!1;if("number"==typeof n&&(isNum=!isNaN(n))&&!isFinite(n))throw{code:"D1001",value:n,stack:(new Error).stack};return isNum}function isArrayOfStrings(arg){var result=!1;return Array.isArray(arg)&&(result=0===arg.filter((function(item){return"string"!=typeof item})).length),result}function isArrayOfNumbers(arg){var result=!1;return Array.isArray(arg)&&(result=0===arg.filter((function(item){return!isNumeric(item)})).length),result}function createSequence(){var sequence=[];return sequence.sequence=!0,1===arguments.length&&sequence.push(arguments[0]),sequence}function isSequence(value){return!0===value.sequence&&Array.isArray(value)}function isFunction(arg){return arg&&(!0===arg._jsonata_function||!0===arg._jsonata_lambda)||"function"==typeof arg}function getFunctionArity(func){return"number"==typeof func.arity?func.arity:"function"==typeof func.implementation?func.implementation.length:"number"==typeof func.length?func.length:func.arguments.length}function isLambda(arg){return arg&&!0===arg._jsonata_lambda}var iteratorSymbol=("function"==typeof Symbol?Symbol:{}).iterator||"@@iterator";function isIterable(arg){return"object"==typeof arg&&null!==arg&&iteratorSymbol in arg&&"next"in arg&&"function"==typeof arg.next}function isDeepEqual(lhs,rhs){if(lhs===rhs)return!0;if("object"==typeof lhs&&"object"==typeof rhs&&null!==lhs&&null!==rhs){if(Array.isArray(lhs)&&Array.isArray(rhs)){if(lhs.length!==rhs.length)return!1;for(var ii=0;ii<lhs.length;ii++)if(!isDeepEqual(lhs[ii],rhs[ii]))return!1;return!0}var lkeys=Object.getOwnPropertyNames(lhs),rkeys=Object.getOwnPropertyNames(rhs);if(lkeys.length!==rkeys.length)return!1;for(lkeys=lkeys.sort(),rkeys=rkeys.sort(),ii=0;ii<lkeys.length;ii++)if(lkeys[ii]!==rkeys[ii])return!1;for(ii=0;ii<lkeys.length;ii++){var key=lkeys[ii];if(!isDeepEqual(lhs[key],rhs[key]))return!1}return!0}return!1}function stringToArray(str){var arr=[];for(let char of str)arr.push(char);return arr}return{isNumeric,isArrayOfStrings,isArrayOfNumbers,createSequence,isSequence,isFunction,isLambda,isIterable,getFunctionArity,isDeepEqual,stringToArray}})();module.exports=utils},{}]},{},[3])(3)},"../node_modules/.pnpm/use-react-router-breadcrumbs@2.0.2_react-router@5.2.1+react@17.0.2/node_modules/use-react-router-breadcrumbs/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/.pnpm/@babel+runtime@7.15.4/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js");var DEFAULT_MATCH_OPTIONS={exact:!0},humanize=function humanize(str){return str.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,(function(m){return m.toUpperCase()}))},render=function render(_ref){var Breadcrumb=_ref.breadcrumb,match=_ref.match,location=_ref.location,props=_ref.props,componentProps=Object.assign({match,location,key:match.url},props||{});return Object.assign(Object.assign({},componentProps),{breadcrumb:"string"==typeof Breadcrumb?(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("span",{key:componentProps.key},Breadcrumb):react__WEBPACK_IMPORTED_MODULE_0__.createElement(Breadcrumb,Object.assign({},componentProps))})},getBreadcrumbMatch=function getBreadcrumbMatch(_ref3){var breadcrumb,currentSection=_ref3.currentSection,disableDefaults=_ref3.disableDefaults,excludePaths=_ref3.excludePaths,location=_ref3.location,pathSection=_ref3.pathSection,routes=_ref3.routes;return excludePaths&&excludePaths.some((function getIsPathExcluded(path){return null!=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,{path,exact:!0,strict:!1})}))?"NO_BREADCRUMB":(routes.some((function(_a){var userProvidedBreadcrumb=_a.breadcrumb,matchOptions=_a.matchOptions,path=_a.path,rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}(_a,["breadcrumb","matchOptions","path"]);if(!path)throw new Error("useBreadcrumbs: `path` must be provided in every route object");var match=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,Object.assign(Object.assign({},matchOptions||DEFAULT_MATCH_OPTIONS),{path}));return match&&null===userProvidedBreadcrumb||!match&&matchOptions?(breadcrumb="NO_BREADCRUMB",!0):!!match&&(!userProvidedBreadcrumb&&disableDefaults?(breadcrumb="NO_BREADCRUMB",!0):(breadcrumb=render(Object.assign({breadcrumb:userProvidedBreadcrumb||humanize(currentSection),match,location},rest)),!0))})),breadcrumb||(disableDefaults?"NO_BREADCRUMB":function getDefaultBreadcrumb(_ref2){var currentSection=_ref2.currentSection,location=_ref2.location,pathSection=_ref2.pathSection,match=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,Object.assign(Object.assign({},DEFAULT_MATCH_OPTIONS),{path:pathSection}))||{url:"not-found"};return render({breadcrumb:humanize(currentSection),match,location})}({pathSection,currentSection:"/"===pathSection?"Home":currentSection,location})))},flattenRoutes=function flattenRoutes(routes){return routes.reduce((function(arr,route){return route.routes?arr.concat([route].concat((0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__.Z)(flattenRoutes(route.routes)))):arr.concat(route)}),[])};const __WEBPACK_DEFAULT_EXPORT__=function useReactRouterBreadcrumbs(routes,options){return function getBreadcrumbs(_ref4){var routes=_ref4.routes,location=_ref4.location,_ref4$options=_ref4.options,options=void 0===_ref4$options?{}:_ref4$options,matches=[];return location.pathname.split("?")[0].split("/").reduce((function(previousSection,currentSection,index){var pathSection=currentSection?"".concat(previousSection,"/").concat(currentSection):"/";if("/"===pathSection&&0!==index)return"";var breadcrumb=getBreadcrumbMatch(Object.assign({currentSection,location,pathSection,routes},options));return"NO_BREADCRUMB"!==breadcrumb&&matches.push(breadcrumb),"/"===pathSection?"":pathSection}),""),matches}({routes:flattenRoutes(routes||[]),location:(0,react_router__WEBPACK_IMPORTED_MODULE_1__.TH)(),options})}},"../node_modules/.pnpm/@babel+runtime@7.15.4/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}__webpack_require__.d(__webpack_exports__,{Z:()=>_toConsumableArray})}}]);