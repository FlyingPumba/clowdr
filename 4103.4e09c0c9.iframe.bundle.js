"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[4103],{"./src/aspects/Conference/Attend/Content/ItemPage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ItemPage});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js");var chakra_ui_media_query_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+media-query@2.0.1_1d6d56d3efa8dbea199a44830c333793/node_modules/@chakra-ui/media-query/dist/chakra-ui-media-query.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js"),graphql=__webpack_require__("./src/generated/graphql.tsx"),PageNotFound=__webpack_require__("./src/aspects/Errors/PageNotFound.tsx"),AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),QueryWrapper=__webpack_require__("./src/aspects/GQL/QueryWrapper.tsx"),useTitle=__webpack_require__("./src/aspects/Hooks/useTitle.tsx"),RequireRole=__webpack_require__("./src/aspects/Conference/RequireRole.tsx"),ItemElements=__webpack_require__("./src/aspects/Conference/Attend/Content/ItemElements.tsx"),ItemEvents=__webpack_require__("./src/aspects/Conference/Attend/Content/ItemEvents.tsx"),chakra_ui_system_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.now.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+system@1.10.3_922a85da57e3646a57465b7970b0de85/node_modules/@chakra-ui/system/dist/chakra-ui-system.esm.js")),FAIcon=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx"),LinkButton=__webpack_require__("./src/aspects/Chakra/LinkButton.tsx"),usePolling=__webpack_require__("./src/aspects/Hooks/usePolling.ts"),PageCountText=__webpack_require__("./src/aspects/Realtime/PageCountText.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ItemLive(_ref){var itemData=_ref.itemData,conferencePath=(0,AuthParameters.h)().conferencePath,_useState2=_slicedToArray((0,react.useState)(null),2),liveEventRoomIds=_useState2[0],setLiveEventRoomIds=_useState2[1],computeLiveEvent=(0,react.useCallback)((function(){var now=Date.now(),currentEvents=[].concat(_toConsumableArray(itemData.sessions.filter((function(event){return Date.parse(event.scheduledStartTime)<=now+6e4&&now<=Date.parse(event.scheduledEndTime)})).map((function(x){return x.roomId}))),_toConsumableArray(itemData.presentations.filter((function(event){return event.session&&Date.parse(event.session.scheduledStartTime)<=now+6e4&&now<=Date.parse(event.session.scheduledEndTime)})).map((function(x){return x.session.roomId}))));setLiveEventRoomIds(currentEvents)}),[itemData.presentations,itemData.sessions]);(0,usePolling.Z)(computeLiveEvent,3e4,!0),(0,react.useEffect)((function(){return computeLiveEvent()}),[computeLiveEvent]);var currentRoom=(0,react.useMemo)((function(){return itemData.room?itemData.room:void 0}),[itemData.room]);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{mb:2,flexWrap:"wrap",children:[currentRoom?(0,jsx_runtime.jsx)(LinkButton.Qj,{width:"100%",to:conferencePath+"/room/"+currentRoom.id,size:"lg",colorScheme:"PrimaryActionButton",height:"auto",py:2,mb:2,linkProps:{mr:2},children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:0,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:itemData.typeName===graphql.gqi.Sponsor?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"video",mr:2,fontSize:"90%",verticalAlign:"middle"})," ",(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{verticalAlign:"middle",pb:.7,children:"Booth"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"video",mr:2,fontSize:"90%",verticalAlign:"middle"})," ",(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{verticalAlign:"middle",pb:.7,children:"Discussion room"})]})}),(0,jsx_runtime.jsx)(PageCountText.Z,{path:conferencePath+"/room/"+currentRoom.id})]})}):void 0,null==liveEventRoomIds?void 0:liveEventRoomIds.map((function(roomId){return(0,jsx_runtime.jsx)(LinkButton.Qj,{width:"100%",to:conferencePath+"/room/"+roomId,size:"lg",colorScheme:"LiveActionButton",height:"auto",py:2,mb:2,linkProps:{mr:2},children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:0,children:[(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"calendar",mr:2,fontSize:"90%",verticalAlign:"middle"})," ",(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{verticalAlign:"middle",pb:.7,children:"Live now"})]})},roomId)}))]})}ItemLive.displayName="ItemLive";try{ItemLive.displayName="ItemLive",ItemLive.__docgenInfo={description:"",displayName:"ItemLive",props:{itemData:{defaultValue:null,description:"",name:"itemData",required:!0,type:{name:"ItemElements_ItemDataFragment & { sessions: readonly ScheduleEventFragment[]; presentations: readonly ItemPresentationFragment[]; } & ItemPage_ItemRoomsFragment"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/ItemLive.tsx#ItemLive"]={docgenInfo:ItemLive.__docgenInfo,name:"ItemLive",path:"src/aspects/Conference/Attend/Content/ItemLive.tsx#ItemLive"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.sort.js");var _templateObject,content=__webpack_require__("../packages/shared/shared-types/build/esm/content.js"),es=__webpack_require__("../node_modules/.pnpm/ramda@0.28.0/node_modules/ramda/es/index.js"),VideoElement=__webpack_require__("./src/aspects/Conference/Attend/Content/Element/VideoElement.tsx");function ItemVideos_slicedToArray(arr,i){return function ItemVideos_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ItemVideos_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ItemVideos_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ItemVideos_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ItemVideos_arrayLikeToArray(o,minLen)}(arr,i)||function ItemVideos_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ItemVideos_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ItemVideos(_ref){var itemData=_ref.itemData,_useState2=ItemVideos_slicedToArray((0,react.useState)(null),2),selectedVideoId=_useState2[0],setSelectedVideoId=_useState2[1],_useState4=ItemVideos_slicedToArray((0,react.useState)(null),2),slowSelectedVideoId=_useState4[0],setSlowSelectedVideoId=_useState4[1],updateSlowSelectedVideoId=(0,react.useCallback)((function(){setSlowSelectedVideoId(selectedVideoId)}),[selectedVideoId]);(0,usePolling.Z)(updateSlowSelectedVideoId,1500,!0);var videoElements=(0,react.useMemo)((function(){return itemData.elements.filter((function(element){return element.typeName===graphql.bK7.VideoBroadcast||element.typeName===graphql.bK7.VideoPrepublish||element.typeName===graphql.bK7.VideoFile||element.typeName===graphql.bK7.AudioFile})).sort((function(x,y){return x.typeName.localeCompare(y.typeName)})).map((function(element){try{(0,content.Bm)(null==element?void 0:element.data);var latestVersion=es.Z$Q(element.data);return"video"===(null==latestVersion?void 0:latestVersion.data.baseType)?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flexGrow:1,flexShrink:1,transition:"max-width 1s, width 1s, height 1s, margin 1s",maxWidth:["100%","100%",slowSelectedVideoId===element.id?"70%":slowSelectedVideoId?"0%":"50%"],flexBasis:0,mx:5,mt:3,mb:5,visibility:["visible","visible",slowSelectedVideoId&&slowSelectedVideoId!==element.id?"hidden":"visible"],overflow:["visible","visible","hidden"],children:(0,jsx_runtime.jsx)(VideoElement.q,{elementId:element.id,title:element.name,elementData:latestVersion.data,onPlay:function onPlay(){return setSelectedVideoId(element.id)},onPause:function onPause(){return setSelectedVideoId(null)}})},element.id):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}catch(e){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}}))}),[itemData.elements,slowSelectedVideoId]);return 0===videoElements.length?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{justifyContent:["flex-start","flex-start","center"],alignItems:"center",background:"gray.900",borderRadius:0,pb:5,flexDir:["column","column","row"],children:videoElements})}try{ItemVideos.displayName="ItemVideos",ItemVideos.__docgenInfo={description:"",displayName:"ItemVideos",props:{itemData:{defaultValue:null,description:"",name:"itemData",required:!0,type:{name:"ItemElements_ItemDataFragment"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/ItemVideos.tsx#ItemVideos"]={docgenInfo:ItemVideos.__docgenInfo,name:"ItemVideos",path:"src/aspects/Conference/Attend/Content/ItemVideos.tsx#ItemVideos"})}catch(__react_docgen_typescript_loader_error){}function ItemPage_slicedToArray(arr,i){return function ItemPage_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ItemPage_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ItemPage_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ItemPage_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ItemPage_arrayLikeToArray(o,minLen)}(arr,i)||function ItemPage_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ItemPage_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ItemPage(_ref){var _result$data$content_,_result$data,_result$data$content_2,itemId=_ref.itemId,result=ItemPage_slicedToArray((0,graphql.DEp)({variables:{itemId,includeAbstract:!1,includeItemEvents:!1}}),1)[0],stackColumns=(0,chakra_ui_media_query_esm.Sx)({base:!0,lg:!1}),title=(0,useTitle.Z)(null!==(_result$data$content_=null===(_result$data=result.data)||void 0===_result$data||null===(_result$data$content_2=_result$data.content_Item_by_pk)||void 0===_result$data$content_2?void 0:_result$data$content_2.title)&&void 0!==_result$data$content_?_result$data$content_:"Unknown content item"),conferencePath=(0,AuthParameters.h)().conferencePath;return(0,jsx_runtime.jsx)(RequireRole.Z,{componentIfDenied:(0,jsx_runtime.jsx)(PageNotFound.default,{}),attendeeRole:!0,children:(0,jsx_runtime.jsx)(QueryWrapper.Z,{queryResult:result,getter:function getter(data){return Object.assign({},data.content_Item_by_pk,{sessions:data.sessions,presentations:data.presentations})},children:function children(itemData){return itemData.title?1===itemData.descriptionOfExhibitions.length?(0,jsx_runtime.jsx)(react_router.l_,{to:conferencePath+"/exhibition/"+itemData.descriptionOfExhibitions[0].id}):itemData.typeName===graphql.gqi.Sponsor&&itemData.room?(0,jsx_runtime.jsx)(react_router.l_,{to:conferencePath+"/room/"+itemData.room.id}):itemData.typeName===graphql.gqi.LandingPage&&conferencePath?(0,jsx_runtime.jsx)(react_router.l_,{to:conferencePath}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Ug,{w:"100%",flexWrap:"wrap",alignItems:"stretch",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{textAlign:"left",flexGrow:2.5,alignItems:"stretch",flexBasis:0,minW:"100%",maxW:"100%",children:[title,(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{width:"100%",height:"100%",gridColumnGap:5,flexWrap:stackColumns?"wrap":"nowrap",maxW:"100%",pb:[2,2,4],children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{maxW:"100%",textAlign:"center",flexGrow:1,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(ItemVideos,{itemData})}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{maxW:"100%",px:4,children:[(0,jsx_runtime.jsx)(ItemElements.b,{itemData,children:(0,jsx_runtime.jsx)(RequireRole.Z,{attendeeRole:!0,children:(0,jsx_runtime.jsx)(ItemLive,{itemData})})}),(0,jsx_runtime.jsx)(ItemEvents.Q,{sessions:itemData.sessions,presentations:itemData.presentations})]})]})})]})}):(0,jsx_runtime.jsx)(PageNotFound.default,{})}})})}(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query GetItem($itemId: uuid!, $includeAbstract: Boolean!, $includeItemEvents: Boolean!) @cached {\n        content_Item_by_pk(id: $itemId) {\n            ...ItemElements_ItemData\n            ...ItemPage_ItemRooms\n            descriptionOfExhibitions {\n                id\n            }\n        }\n        sessions: schedule_Event(\n            where: { _and: [{ itemId: { _eq: $itemId } }, { sessionEventId: { _is_null: true } }] }\n        ) {\n            ...ScheduleEvent\n        }\n        presentations: schedule_Event(\n            where: { _and: [{ itemId: { _eq: $itemId } }, { sessionEventId: { _is_null: false } }] }\n        ) {\n            ...ItemPresentation\n        }\n    }\n\n    fragment ItemPage_ItemRooms on content_Item {\n        room {\n            id\n            created_at\n        }\n    }\n\n    fragment ItemPresentation on schedule_Event {\n        id\n        session {\n            ...ScheduleEvent\n        }\n    }\n"]))),ItemPage.displayName="ItemPage";try{ItemPage.displayName="ItemPage",ItemPage.__docgenInfo={description:"",displayName:"ItemPage",props:{itemId:{defaultValue:null,description:"",name:"itemId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/ItemPage.tsx#ItemPage"]={docgenInfo:ItemPage.__docgenInfo,name:"ItemPage",path:"src/aspects/Conference/Attend/Content/ItemPage.tsx#ItemPage"})}catch(__react_docgen_typescript_loader_error){}}}]);