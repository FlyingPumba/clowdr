"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[12],{"./src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Bl:()=>parseMediaElement,sd:()=>parseMediaElementUrl,EY:()=>parseMediaElementSubtitlesUrl,ZD:()=>useMediaElementUrls});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.ends-with.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.promise.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js");var _templateObject,_clowdr_app_srt_webvtt__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../node_modules/.pnpm/@clowdr-app+srt-webvtt@1.1.1/node_modules/@clowdr-app/srt-webvtt/dist/index.es.js"),_midspace_shared_types_content__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../packages/shared/shared-types/build/esm/content.js"),_urql_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),amazon_s3_uri__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../node_modules/.pnpm/amazon-s3-uri@0.1.1/node_modules/amazon-s3-uri/lib/amazon-s3-uri.js"),amazon_s3_uri__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(amazon_s3_uri__WEBPACK_IMPORTED_MODULE_7__),ramda__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../node_modules/.pnpm/ramda@0.28.0/node_modules/ramda/es/index.js"),react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_async_hook__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../node_modules/.pnpm/react-async-hook@4.0.0_react@17.0.2/node_modules/react-async-hook/dist/react-async-hook.esm.js");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function parseMediaElement(element){var _R$last;if(!element)return{};var blob=element.data;if(![_midspace_shared_types_content__WEBPACK_IMPORTED_MODULE_6__.bK.VideoBroadcast,_midspace_shared_types_content__WEBPACK_IMPORTED_MODULE_6__.bK.VideoFile,_midspace_shared_types_content__WEBPACK_IMPORTED_MODULE_6__.bK.VideoPrepublish].includes(element.typeName)||!(0,_midspace_shared_types_content__WEBPACK_IMPORTED_MODULE_6__.Cp)(blob))return{error:new Error("Element is not of a valid type.")};var latestVersion=null===(_R$last=ramda__WEBPACK_IMPORTED_MODULE_8__.Z$Q(blob))||void 0===_R$last?void 0:_R$last.data;return latestVersion&&latestVersion.baseType===_midspace_shared_types_content__WEBPACK_IMPORTED_MODULE_6__.bN.Video?{mediaElementBlob:latestVersion}:{error:new Error("Element is not of a valid type.")}}function parseMediaElementUrl(elementData){try{var _elementData$transcod,s3Url="transcode"in elementData?null===(_elementData$transcod=elementData.transcode)||void 0===_elementData$transcod?void 0:_elementData$transcod.s3Url:void 0;if(!s3Url&&elementData.s3Url&&(s3Url=elementData.s3Url),!s3Url)return{error:new Error("No S3 URL specified.")};var _AmazonS3URI=new(amazon_s3_uri__WEBPACK_IMPORTED_MODULE_7___default())(s3Url),bucket=_AmazonS3URI.bucket,key=_AmazonS3URI.key;return bucket&&key?{url:"https://s3."+(void 0).VITE_AWS_REGION+".amazonaws.com/"+bucket+"/"+key,isHls:Boolean(key.endsWith(".m3u8"))}:{error:new Error("S3 URL could not be parsed.")}}catch(error){return{error:error instanceof Error?error:new Error("Error creating S3 URL.")}}}function parseMediaElementSubtitlesUrl(_x){return _parseMediaElementSubtitlesUrl.apply(this,arguments)}function _parseMediaElementSubtitlesUrl(){return(_parseMediaElementSubtitlesUrl=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(elementData){var _elementData$subtitle,_AmazonS3URI2,bucket,key,s3Url,response,blob;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(elementData.subtitles.en_US&&null!==(_elementData$subtitle=elementData.subtitles.en_US.s3Url)&&void 0!==_elementData$subtitle&&_elementData$subtitle.length){_context2.next=4;break}return _context2.abrupt("return",void 0);case 4:return _context2.prev=4,_AmazonS3URI2=new(amazon_s3_uri__WEBPACK_IMPORTED_MODULE_7___default())(elementData.subtitles.en_US.s3Url),bucket=_AmazonS3URI2.bucket,key=_AmazonS3URI2.key,s3Url="https://s3."+(void 0).VITE_AWS_REGION+".amazonaws.com/"+bucket+"/"+key,_context2.next=9,fetch(s3Url);case 9:if((response=_context2.sent).ok){_context2.next=12;break}throw new Error("Could not retrieve subtitles file: "+response.status);case 12:return _context2.next=14,response.blob();case 14:return blob=_context2.sent,_context2.next=17,new _clowdr_app_srt_webvtt__WEBPACK_IMPORTED_MODULE_12__.J(blob).getURL();case 17:return _context2.abrupt("return",_context2.sent);case 20:throw _context2.prev=20,_context2.t0=_context2.catch(4),console.error("Failure while parsing subtitle location",_context2.t0),new Error("Failure while parsing subtitle location");case 24:case"end":return _context2.stop()}}),_callee2,null,[[4,20]])})))).apply(this,arguments)}function useMediaElementUrls(elementData){var video=(0,react__WEBPACK_IMPORTED_MODULE_9__.useMemo)((function(){return parseMediaElementUrl(elementData)}),[elementData]),subtitles=(0,react_async_hook__WEBPACK_IMPORTED_MODULE_10__.r5)(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",parseMediaElementSubtitlesUrl(elementData));case 1:case"end":return _context.stop()}}),_callee)}))),[elementData.subtitles.en_US]);return{video,subtitles:{loading:subtitles.loading,error:subtitles.error,url:subtitles.result}}}(0,_urql_core__WEBPACK_IMPORTED_MODULE_11__.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment useMediaElement_MediaElement on content_Element {\n        typeName\n        data\n    }\n"])));try{parseMediaElement.displayName="parseMediaElement",parseMediaElement.__docgenInfo={description:"",displayName:"parseMediaElement",props:{__typename:{defaultValue:null,description:"",name:"__typename",required:!1,type:{name:"enum",value:[{value:'"content_Element"'}]}},typeName:{defaultValue:null,description:"",name:"typeName",required:!0,type:{name:"enum",value:[{value:'"ABSTRACT"'},{value:'"ACTIVE_SOCIAL_ROOMS"'},{value:'"AUDIO_FILE"'},{value:'"AUDIO_LINK"'},{value:'"AUDIO_URL"'},{value:'"CONTENT_GROUP_LIST"'},{value:'"DIVIDER"'},{value:'"EXPLORE_PROGRAM_BUTTON"'},{value:'"EXPLORE_SCHEDULE_BUTTON"'},{value:'"EXTERNAL_EVENT_LINK"'},{value:'"IMAGE_FILE"'},{value:'"IMAGE_URL"'},{value:'"LINK"'},{value:'"LINK_BUTTON"'},{value:'"LIVE_PROGRAM_ROOMS"'},{value:'"PAPER_FILE"'},{value:'"PAPER_LINK"'},{value:'"PAPER_URL"'},{value:'"POSTER_FILE"'},{value:'"POSTER_URL"'},{value:'"SPONSOR_BOOTHS"'},{value:'"TEXT"'},{value:'"VIDEO_BROADCAST"'},{value:'"VIDEO_COUNTDOWN"'},{value:'"VIDEO_FILE"'},{value:'"VIDEO_FILLER"'},{value:'"VIDEO_LINK"'},{value:'"VIDEO_PREPUBLISH"'},{value:'"VIDEO_SPONSORS_FILLER"'},{value:'"VIDEO_TITLES"'},{value:'"VIDEO_URL"'},{value:'"WHOLE_SCHEDULE"'}]}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#parseMediaElement"]={docgenInfo:parseMediaElement.__docgenInfo,name:"parseMediaElement",path:"src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#parseMediaElement"})}catch(__react_docgen_typescript_loader_error){}try{parseMediaElementUrl.displayName="parseMediaElementUrl",parseMediaElementUrl.__docgenInfo={description:"",displayName:"parseMediaElementUrl",props:{baseType:{defaultValue:null,description:"",name:"baseType",required:!0,type:{name:"enum",value:[{value:'"video"'},{value:'"audio"'}]}},s3Url:{defaultValue:null,description:"",name:"s3Url",required:!0,type:{name:"string"}},sourceHasEmbeddedSubtitles:{defaultValue:null,description:"",name:"sourceHasEmbeddedSubtitles",required:!1,type:{name:"boolean"}},transcode:{defaultValue:null,description:"",name:"transcode",required:!1,type:{name:"TranscodeDetails"}},subtitles:{defaultValue:null,description:"",name:"subtitles",required:!0,type:{name:"Record<string, SubtitleDetails>"}},broadcastTranscode:{defaultValue:null,description:"",name:"broadcastTranscode",required:!1,type:{name:"BroadcastTranscodeDetails"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#parseMediaElementUrl"]={docgenInfo:parseMediaElementUrl.__docgenInfo,name:"parseMediaElementUrl",path:"src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#parseMediaElementUrl"})}catch(__react_docgen_typescript_loader_error){}try{parseMediaElementSubtitlesUrl.displayName="parseMediaElementSubtitlesUrl",parseMediaElementSubtitlesUrl.__docgenInfo={description:"",displayName:"parseMediaElementSubtitlesUrl",props:{baseType:{defaultValue:null,description:"",name:"baseType",required:!0,type:{name:"enum",value:[{value:'"video"'},{value:'"audio"'}]}},s3Url:{defaultValue:null,description:"",name:"s3Url",required:!0,type:{name:"string"}},sourceHasEmbeddedSubtitles:{defaultValue:null,description:"",name:"sourceHasEmbeddedSubtitles",required:!1,type:{name:"boolean"}},transcode:{defaultValue:null,description:"",name:"transcode",required:!1,type:{name:"TranscodeDetails"}},subtitles:{defaultValue:null,description:"",name:"subtitles",required:!0,type:{name:"Record<string, SubtitleDetails>"}},broadcastTranscode:{defaultValue:null,description:"",name:"broadcastTranscode",required:!1,type:{name:"BroadcastTranscodeDetails"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#parseMediaElementSubtitlesUrl"]={docgenInfo:parseMediaElementSubtitlesUrl.__docgenInfo,name:"parseMediaElementSubtitlesUrl",path:"src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#parseMediaElementSubtitlesUrl"})}catch(__react_docgen_typescript_loader_error){}try{useMediaElementUrls.displayName="useMediaElementUrls",useMediaElementUrls.__docgenInfo={description:"",displayName:"useMediaElementUrls",props:{baseType:{defaultValue:null,description:"",name:"baseType",required:!0,type:{name:"enum",value:[{value:'"video"'},{value:'"audio"'}]}},s3Url:{defaultValue:null,description:"",name:"s3Url",required:!0,type:{name:"string"}},sourceHasEmbeddedSubtitles:{defaultValue:null,description:"",name:"sourceHasEmbeddedSubtitles",required:!1,type:{name:"boolean"}},transcode:{defaultValue:null,description:"",name:"transcode",required:!1,type:{name:"TranscodeDetails"}},subtitles:{defaultValue:null,description:"",name:"subtitles",required:!0,type:{name:"Record<string, SubtitleDetails>"}},broadcastTranscode:{defaultValue:null,description:"",name:"broadcastTranscode",required:!1,type:{name:"BroadcastTranscodeDetails"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#useMediaElementUrls"]={docgenInfo:useMediaElementUrls.__docgenInfo,name:"useMediaElementUrls",path:"src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx#useMediaElementUrls"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S$:()=>devicesToFriendlyName,vj:()=>PermissionInstructions});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.join.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js");var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("../node_modules/.pnpm/@chakra-ui+image@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/image/dist/chakra-ui-image.esm.js"),detect_browser__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../node_modules/.pnpm/detect-browser@5.3.0/node_modules/detect-browser/es/index.js"),react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_images_chrome_permissions_png__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/aspects/Conference/Attend/Room/VideoChat/images/chrome-permissions.png"),_images_chrome_screenshare_png__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/aspects/Conference/Attend/Room/VideoChat/images/chrome-screenshare.png"),_images_firefox_permissions_png__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/aspects/Conference/Attend/Room/VideoChat/images/firefox-permissions.png"),_images_safari_permissions_png__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/aspects/Conference/Attend/Room/VideoChat/images/safari-permissions.png"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function devicesToFriendlyName(devices){var connective=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"or",selectedDevices=Object.entries(devices).filter((function(x){return x[1]})).map((function(x){return x[0]}));switch(selectedDevices.length){case 0:return"device";case 1:return selectedDevices[0];default:var head=selectedDevices.slice(0,-1).join(", "),tail=connective+" "+selectedDevices[selectedDevices.length-1];return head+" "+tail}}function PermissionInstructions(_ref){var props=_extends({},_ref),detected=(0,react__WEBPACK_IMPORTED_MODULE_7__.useMemo)((function(){return(0,detect_browser__WEBPACK_IMPORTED_MODULE_13__.detect)()}),[]),browserInstructionsEl=(0,react__WEBPACK_IMPORTED_MODULE_7__.useMemo)((function(){switch(null==detected?void 0:detected.name){case"chrome":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(PermissionInstructionsChrome,Object.assign({},props));case"firefox":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(PermissionInstructionsFirefox,Object.assign({},props));case"safari":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(PermissionInstructionsSafari,Object.assign({},props));default:return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(PermissionInstructionsOther,Object.assign({},props))}}),[null==detected?void 0:detected.name,props]),osInstructionsEl=(0,react__WEBPACK_IMPORTED_MODULE_7__.useMemo)((function(){if("Mac OS"===(null==detected?void 0:detected.os))return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(PermissionInstructionsMacOs,Object.assign({},props))}),[null==detected?void 0:detected.os,props]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[browserInstructionsEl,osInstructionsEl,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(PermissionInstructionsOtherApplications,{})]})}var imageProps={mx:"5%",my:4,w:"auto",maxW:"90%",boxShadow:"lg",rounded:"xl"};function PermissionInstructionsChrome(devices){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[devices.camera||devices.microphone?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["It seems that your web browser is not allowing Midspace to access the"," ",devicesToFriendlyName(devices),". Update your settings by clicking the icon in the address bar and setting the Camera and Microphone permissions to Allow."]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__.Ee,Object.assign({},imageProps,{src:_images_chrome_permissions_png__WEBPACK_IMPORTED_MODULE_8__,maxH:"50vh",alt:"Use the permissions controls in the left end of the Chrome address bar to manage camera and microphone permissions."})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["If you need more help, see the"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.rU,{isExternal:!0,href:"https://support.google.com/chrome/answer/2693767?co=GENIE.Platform%3DDesktop",children:"official Google Chrome instructions"}),"."]})]}):void 0,devices.screen?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["The screen could not be shared. Did you click ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("em",{children:"Cancel"}),"?"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["To share, choose a screen, window or tab and click the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("em",{children:"Share"})," button."]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__.Ee,Object.assign({},imageProps,{src:_images_chrome_screenshare_png__WEBPACK_IMPORTED_MODULE_9__,maxH:"50vh",alt:"The Chrome 'Choose what to share' dialog, showing the list of tabs that can be shared."}))]}):void 0]})}function PermissionInstructionsFirefox(devices){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["It seems that your web browser is not allowing Midspace to access the ",devicesToFriendlyName(devices),". Remove any blocked devices by clicking the icon in the address bar and then the appropriate x button."]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__.Ee,Object.assign({},imageProps,{src:_images_firefox_permissions_png__WEBPACK_IMPORTED_MODULE_10__,alt:"Use the permissions controls in the left end of the Firefox address bar to manage "+devicesToFriendlyName(devices,"and")+" permissions."})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["If you need more help, see the"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.rU,{isExternal:!0,href:"https://support.mozilla.org/en-US/kb/how-manage-your-camera-and-microphone-permissions",children:"official Mozilla Firefox instructions"}),"."]})]})}function PermissionInstructionsSafari(devices){var _window$location$host;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["It seems that your web browser is not allowing Midspace to access the ",devicesToFriendlyName(devices),". You may need to tell Safari to allow this. Open ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("em",{children:"Safari → Preferences..."})," and go to the"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("em",{children:"Website"})," tab. Choose to ‘Allow’ access to the"," ",devicesToFriendlyName(devices,"and")," on ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("em",{children:null!==(_window$location$host=window.location.host)&&void 0!==_window$location$host?_window$location$host:"Midspace"}),"."]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_15__.Ee,Object.assign({},imageProps,{src:_images_safari_permissions_png__WEBPACK_IMPORTED_MODULE_11__,alt:"Use the Websites tab in Safari's preferences to manage "+devicesToFriendlyName(devices,"and")+" permissions."}))]})}function PermissionInstructionsOther(devices){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["It seems that your web browser is not allowing Midspace to access the ",devicesToFriendlyName(devices),". Please check your browser settings and try again."]})})}function PermissionInstructionsMacOs(devices){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.X6,{as:"h2",size:"sm",textAlign:"left",mb:2,mt:4,children:"Using macOS?"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:["macOS will not allow your browser to access the ",devicesToFriendlyName(devices)," unless you have given permission to do so."," ",devices.screen?"Permissions controls for screen recording were introduced in macOS Catalina (10.15). ":"","You may find the following helpful:"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.aV,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.HC,{children:devices.camera?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.rU,{isExternal:!0,href:"https://support.apple.com/en-gb/guide/mac-help/mchlf6d108da/mac",children:"Control access to the camera on your Mac"}):void 0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.HC,{children:devices.microphone?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.rU,{isExternal:!0,href:"https://support.apple.com/en-gb/guide/mac-help/mchla1b1e1fe/mac",children:"Control access to the microphone on your Mac"}):void 0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.HC,{children:devices.screen?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.rU,{isExternal:!0,href:"https://support.apple.com/en-gb/guide/mac-help/mchld6aa7d23/mac",children:"Control access to screen recording on your Mac"}):void 0})]})]})}function PermissionInstructionsOtherApplications(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.X6,{as:"h2",size:"sm",textAlign:"left",mb:2,mt:4,children:"Check other applications"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_14__.xv,{children:"Make sure you have fully exited other video applications like Zoom, Skype or Google Meet. These may prevent Midspace from accessing your camera or microphone."})]})}try{PermissionInstructions.displayName="PermissionInstructions",PermissionInstructions.__docgenInfo={description:"",displayName:"PermissionInstructions",props:{camera:{defaultValue:null,description:"",name:"camera",required:!1,type:{name:"boolean"}},microphone:{defaultValue:null,description:"",name:"microphone",required:!1,type:{name:"boolean"}},screen:{defaultValue:null,description:"",name:"screen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructions"]={docgenInfo:PermissionInstructions.__docgenInfo,name:"PermissionInstructions",path:"src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructions"})}catch(__react_docgen_typescript_loader_error){}try{PermissionInstructionsChrome.displayName="PermissionInstructionsChrome",PermissionInstructionsChrome.__docgenInfo={description:"",displayName:"PermissionInstructionsChrome",props:{camera:{defaultValue:null,description:"",name:"camera",required:!1,type:{name:"boolean"}},microphone:{defaultValue:null,description:"",name:"microphone",required:!1,type:{name:"boolean"}},screen:{defaultValue:null,description:"",name:"screen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsChrome"]={docgenInfo:PermissionInstructionsChrome.__docgenInfo,name:"PermissionInstructionsChrome",path:"src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsChrome"})}catch(__react_docgen_typescript_loader_error){}try{PermissionInstructionsFirefox.displayName="PermissionInstructionsFirefox",PermissionInstructionsFirefox.__docgenInfo={description:"",displayName:"PermissionInstructionsFirefox",props:{camera:{defaultValue:null,description:"",name:"camera",required:!1,type:{name:"boolean"}},microphone:{defaultValue:null,description:"",name:"microphone",required:!1,type:{name:"boolean"}},screen:{defaultValue:null,description:"",name:"screen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsFirefox"]={docgenInfo:PermissionInstructionsFirefox.__docgenInfo,name:"PermissionInstructionsFirefox",path:"src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsFirefox"})}catch(__react_docgen_typescript_loader_error){}try{PermissionInstructionsSafari.displayName="PermissionInstructionsSafari",PermissionInstructionsSafari.__docgenInfo={description:"",displayName:"PermissionInstructionsSafari",props:{camera:{defaultValue:null,description:"",name:"camera",required:!1,type:{name:"boolean"}},microphone:{defaultValue:null,description:"",name:"microphone",required:!1,type:{name:"boolean"}},screen:{defaultValue:null,description:"",name:"screen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsSafari"]={docgenInfo:PermissionInstructionsSafari.__docgenInfo,name:"PermissionInstructionsSafari",path:"src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsSafari"})}catch(__react_docgen_typescript_loader_error){}try{PermissionInstructionsOther.displayName="PermissionInstructionsOther",PermissionInstructionsOther.__docgenInfo={description:"",displayName:"PermissionInstructionsOther",props:{camera:{defaultValue:null,description:"",name:"camera",required:!1,type:{name:"boolean"}},microphone:{defaultValue:null,description:"",name:"microphone",required:!1,type:{name:"boolean"}},screen:{defaultValue:null,description:"",name:"screen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsOther"]={docgenInfo:PermissionInstructionsOther.__docgenInfo,name:"PermissionInstructionsOther",path:"src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx#PermissionInstructionsOther"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/Conference/Attend/Room/Vonage/VonageRoom.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{VonageRoom:()=>VonageRoom});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.split.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.starts-with.js");var react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),graphql=__webpack_require__("./src/generated/graphql.tsx"),ChatProfileModalProvider=__webpack_require__("./src/aspects/Chat/Frame/ChatProfileModalProvider.tsx"),RaiseHandProvider=__webpack_require__("./src/aspects/RaiseHand/RaiseHandProvider.tsx"),useCurrentRegistrant=__webpack_require__("./src/aspects/Conference/useCurrentRegistrant.tsx"),PermissionInstructionsContext=__webpack_require__("./src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructionsContext.tsx"),chakra_ui_toast_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.promise.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.timers.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+toast@1.5.4_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/toast/dist/chakra-ui-toast.esm.js")),ChakraCustomProvider=__webpack_require__("./src/aspects/Chakra/ChakraCustomProvider.tsx"),useEvent=__webpack_require__("./src/aspects/Utils/useEvent.ts");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VonageGlobalState=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/State/VonageGlobalState.ts"),VonageGlobalStateProvider=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/State/VonageGlobalStateProvider.tsx"),VonageRoomProvider=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/State/VonageRoomProvider.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function VonageComputedStateContext_slicedToArray(arr,i){return function VonageComputedStateContext_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VonageComputedStateContext_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VonageComputedStateContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VonageComputedStateContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VonageComputedStateContext_arrayLikeToArray(o,minLen)}(arr,i)||function VonageComputedStateContext_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VonageComputedStateContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var standaloneToast=(0,chakra_ui_toast_esm.I2)({theme:ChakraCustomProvider.rS});function useValue(_ref){var getAccessToken=_ref.getAccessToken,vonageSessionId=_ref.vonageSessionId,overrideJoining=_ref.overrideJoining,onRoomJoined=_ref.onRoomJoined,onRecordingIdReceived=_ref.onRecordingIdReceived,beginJoin=_ref.beginJoin,cancelJoin=_ref.cancelJoin,completeJoinRef=_ref.completeJoinRef,vonage=(0,VonageGlobalStateProvider.dn)(),_useVonageRoom=(0,VonageRoomProvider.xI)(),dispatch=_useVonageRoom.dispatch,settings=_useVonageRoom.settings,_useState2=VonageComputedStateContext_slicedToArray((0,react.useState)(!1),2),connected=_useState2[0],setConnected=_useState2[1],_useState4=VonageComputedStateContext_slicedToArray((0,react.useState)([]),2),streams=_useState4[0],setStreams=_useState4[1],_useState6=VonageComputedStateContext_slicedToArray((0,react.useState)([]),2),connections=_useState6[0],setConnections=_useState6[1],_useState8=VonageComputedStateContext_slicedToArray((0,react.useState)(null),2),camera=_useState8[0],setCamera=_useState8[1],_useState10=VonageComputedStateContext_slicedToArray((0,react.useState)(null),2),screen=_useState10[0],setScreen=_useState10[1],toast=(0,chakra_ui_toast_esm.pm)(),onCameraStreamDestroyed=(0,react.useCallback)((function(reason){"mediaStopped"!==reason&&"forceUnpublished"!==reason||(dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!1,explicitlyDisabled:!0,onError:void 0}),dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!1,explicitlyDisabled:!0,onError:void 0})),"forceUnpublished"===reason&&standaloneToast({title:"Muted",description:"You have been muted by a moderator.",status:"warning",duration:2e4,isClosable:!0,position:"top"})}),[dispatch]),onScreenStreamDestroyed=(0,react.useCallback)((function(reason){setScreen(vonage.screen),"mediaStopped"!==reason&&"forceUnpublished"!==reason||dispatch({type:VonageRoomProvider.XX.SetScreenShareIntendedState,screenEnabled:!1}),"forceUnpublished"===reason&&standaloneToast({title:"Screenshare stopped",description:"Your screenshare has been stopped by a moderator.",status:"warning",duration:2e4,isClosable:!0,position:"top"})}),[dispatch,vonage.screen]),_useState12=VonageComputedStateContext_slicedToArray((0,react.useState)(!1),2),_joining=_useState12[0],setJoining=_useState12[1],joining=!!overrideJoining||_joining,joinRoom=(0,react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var doJoinRoom,_doJoinRoom;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_doJoinRoom=function _doJoinRoom3(){return(_doJoinRoom=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _e$message;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setJoining(!0),_context.prev=1,_context.next=4,vonage.connectToSession();case 4:null==onRoomJoined||onRoomJoined(!0),_context.next=10;break;case 7:_context.prev=7,_context.t0=_context.catch(1),"Declined to be recorded"!==_context.t0&&(console.error("Failed to join room",_context.t0),toast({status:"error",title:"Cannot connect to room",description:"string"==typeof _context.t0?_context.t0:null!==(_e$message=null===_context.t0||void 0===_context.t0?void 0:_context.t0.message)&&void 0!==_e$message?_e$message:void 0,isClosable:!0}));case 10:return _context.prev=10,setJoining(!1),_context.finish(10);case 13:case"end":return _context.stop()}}),_callee,null,[[1,7,10,13]])})))).apply(this,arguments)},doJoinRoom=function _doJoinRoom2(){return _doJoinRoom.apply(this,arguments)},!(beginJoin&&cancelJoin&&completeJoinRef)){_context2.next=7;break}completeJoinRef.current=doJoinRoom,beginJoin(),_context2.next=9;break;case 7:return _context2.next=9,doJoinRoom();case 9:case"end":return _context2.stop()}}),_callee2)}))),[beginJoin,cancelJoin,completeJoinRef,vonage,onRoomJoined,toast]),leaveRoom=(0,react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!connected){_context3.next=10;break}return _context3.prev=1,_context3.next=4,vonage.disconnect();case 4:null==onRoomJoined||onRoomJoined(!1),_context3.next=10;break;case 7:_context3.prev=7,_context3.t0=_context3.catch(1),console.warn("Failed to leave room",_context3.t0);case 10:setJoining(!1);case 11:case"end":return _context3.stop()}}),_callee3,null,[[1,7]])}))),[connected,onRoomJoined,vonage]);(0,react.useEffect)((function(){vonage.setGetTokenFunction(getAccessToken)}),[getAccessToken,vonage]);var recordingState=function useRecordingState(connected,vonageSessionId){var _useState2=_slicedToArray((0,react.useState)(!1),2),isRecordingActive=_useState2[0],setIsRecordingActive=_useState2[1],onRecordingStarted=(0,react.useCallback)((function(){setIsRecordingActive(!0)}),[]),onRecordingStopped=(0,react.useCallback)((function(){setIsRecordingActive(!1)}),[]);return(0,react.useEffect)((function(){connected||setIsRecordingActive(!1)}),[connected]),(0,react.useEffect)((function(){setIsRecordingActive(!1)}),[vonageSessionId]),{isRecordingActive,onRecordingStarted,onRecordingStopped}}(connected,vonageSessionId),onSessionConnected=(0,react.useCallback)((function(isConnected){isConnected?setConnected(!0):(setConnected(!1),setStreams([]),setConnections([]),dispatch({type:VonageRoomProvider.XX.SetScreenShareIntendedState,screenEnabled:!1}))}),[dispatch]),onScreenStreamDestroyedInternal=(0,react.useCallback)((function(reason){setScreen(vonage.state.type===VonageGlobalState.Yk.Connected?vonage.state.screen:null),onScreenStreamDestroyed(reason)}),[onScreenStreamDestroyed,vonage.state]),onCameraStreamCreated=(0,react.useCallback)((function(){var _vonage$state$camera$,_vonage$state$camera;setCamera(vonage.state.type===VonageGlobalState.Yk.Connected&&null!==(_vonage$state$camera$=null===(_vonage$state$camera=vonage.state.camera)||void 0===_vonage$state$camera?void 0:_vonage$state$camera.publisher)&&void 0!==_vonage$state$camera$?_vonage$state$camera$:null)}),[vonage.state]),onScreenStreamCreated=(0,react.useCallback)((function(){setScreen(vonage.state.type===VonageGlobalState.Yk.Connected?vonage.state.screen:null)}),[vonage.state]),onMuteForced=(0,react.useCallback)((function(){standaloneToast({title:"Muted",description:"You have been muted by a moderator.",status:"warning",duration:2e4,isClosable:!0,position:"top"})}),[]),onRecordingIdReceivedInternal=(0,react.useCallback)((function(recordingId){null==onRecordingIdReceived||onRecordingIdReceived(recordingId)}),[onRecordingIdReceived]),_useState14=VonageComputedStateContext_slicedToArray((0,react.useState)(null),2),layoutData=_useState14[0],setLayoutData=_useState14[1],onLayoutReceived=(0,react.useCallback)((function(layoutData){setLayoutData((function(old){return!old||old.createdAt<layoutData.createdAt?layoutData:old}))}),[]);(0,useEvent.z)(vonage,"streams-changed",setStreams),(0,useEvent.z)(vonage,"connections-changed",setConnections),(0,useEvent.z)(vonage,"session-connected",onSessionConnected),(0,useEvent.z)(vonage,"camera-stream-destroyed",onCameraStreamDestroyed),(0,useEvent.z)(vonage,"screen-stream-destroyed",onScreenStreamDestroyedInternal),(0,useEvent.z)(vonage,"camera-stream-created",onCameraStreamCreated),(0,useEvent.z)(vonage,"screen-stream-created",onScreenStreamCreated),(0,useEvent.z)(vonage,"mute-forced",onMuteForced),(0,useEvent.z)(vonage,"recording-started",recordingState.onRecordingStarted),(0,useEvent.z)(vonage,"recording-stopped",recordingState.onRecordingStopped),(0,useEvent.z)(vonage,"recording-id-received",onRecordingIdReceivedInternal),(0,useEvent.z)(vonage,"layout-signal-received",onLayoutReceived);var previousVonageSessionId=(0,react.useRef)("");(0,react.useEffect)((function(){function _fn(){return(_fn=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var wasAlreadyConnected;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(wasAlreadyConnected=!1,_context4.prev=1,vonage.state.type!==VonageGlobalState.Yk.Connected){_context4.next=6;break}return wasAlreadyConnected=!0,_context4.next=6,vonage.disconnect();case 6:_context4.next=11;break;case 8:_context4.prev=8,_context4.t0=_context4.catch(1),console.warn("Failed to disconnect from session",_context4.t0);case 11:return _context4.prev=11,_context4.next=14,vonage.initialiseState({getToken:getAccessToken,sessionId:vonageSessionId});case 14:_context4.next=19;break;case 16:_context4.prev=16,_context4.t1=_context4.catch(11),console.warn("Failed to initialise session",_context4.t1);case 19:settings.isBackstageRoom&&wasAlreadyConnected&&previousVonageSessionId.current&&vonageSessionId&&joinRoom(),previousVonageSessionId.current=vonageSessionId;case 21:case"end":return _context4.stop()}}),_callee4,null,[[1,8],[11,16]])})))).apply(this,arguments)}!function fn(){return _fn.apply(this,arguments)}()}),[vonageSessionId]);var _useState16=VonageComputedStateContext_slicedToArray((0,react.useState)(!1),2),recentlyConnected=_useState16[0],setRecentlyConnected=_useState16[1],_useState18=VonageComputedStateContext_slicedToArray((0,react.useState)(!1),2),recentlyToggledRecording=_useState18[0],setRecentlyToggledRecording=_useState18[1];(0,react.useEffect)((function(){var tId;return vonage.state.type===VonageGlobalState.Yk.Connected?(setRecentlyConnected(!0),tId=setTimeout((function(){setRecentlyConnected(!1)}),3e4)):setRecentlyConnected(!1),function(){tId&&clearTimeout(tId)}}),[vonage.state.type]);var transcriptRefShim=(0,react.useRef)(void 0);return(0,react.useMemo)((function(){return{vonage,connected,streams,connections,screen,camera,joining,joinRoom,leaveRoom,cancelJoin,isRecordingActive:recordingState.isRecordingActive,onTranscriptRef:transcriptRefShim,recentlyConnected,recentlyToggledRecording,setRecentlyToggledRecording,layoutData}}),[vonage,connected,streams,connections,screen,camera,joining,joinRoom,leaveRoom,cancelJoin,recordingState.isRecordingActive,recentlyConnected,recentlyToggledRecording,layoutData])}var VonageComputedStateContext=(0,react.createContext)({});function VonageComputedStateProvider(props){return(0,jsx_runtime.jsx)(VonageComputedStateContext.Provider,{value:useValue(props),children:props.children})}VonageComputedStateProvider.displayName="VonageComputedStateProvider";try{VonageComputedStateProvider.displayName="VonageComputedStateProvider",VonageComputedStateProvider.__docgenInfo={description:"",displayName:"VonageComputedStateProvider",props:{getAccessToken:{defaultValue:null,description:"",name:"getAccessToken",required:!0,type:{name:"() => Promise<string>"}},vonageSessionId:{defaultValue:null,description:"",name:"vonageSessionId",required:!0,type:{name:"string"}},overrideJoining:{defaultValue:null,description:"",name:"overrideJoining",required:!1,type:{name:"boolean"}},onRoomJoined:{defaultValue:null,description:"",name:"onRoomJoined",required:!1,type:{name:"((_joined: boolean) => void)"}},onRecordingIdReceived:{defaultValue:null,description:"",name:"onRecordingIdReceived",required:!1,type:{name:"((recordingId: string) => void)"}},beginJoin:{defaultValue:null,description:"",name:"beginJoin",required:!1,type:{name:"(() => void)"}},cancelJoin:{defaultValue:null,description:"",name:"cancelJoin",required:!1,type:{name:"(() => void)"}},completeJoinRef:{defaultValue:null,description:"",name:"completeJoinRef",required:!1,type:{name:"MutableRefObject<() => Promise<void>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/State/VonageComputedStateContext.tsx#VonageComputedStateProvider"]={docgenInfo:VonageComputedStateProvider.__docgenInfo,name:"VonageComputedStateProvider",path:"src/aspects/Conference/Attend/Room/Vonage/State/VonageComputedStateContext.tsx#VonageComputedStateProvider"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.now.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.some.js");var DisplayType,_templateObject,chakra_ui_hooks_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+hooks@1.8.2_react@17.0.2/node_modules/@chakra-ui/hooks/dist/chakra-ui-hooks.esm.js"),auth=__webpack_require__("../packages/shared/shared-types/build/esm/auth.js"),vonage=__webpack_require__("../packages/shared/shared-types/build/esm/vonage.js"),make_context=__webpack_require__("./src/aspects/GQL/make-context.ts"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx");function useVonageBroadcastLayout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useVonageBroadcastLayout_slicedToArray(arr,i){return function useVonageBroadcastLayout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useVonageBroadcastLayout_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useVonageBroadcastLayout_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useVonageBroadcastLayout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useVonageBroadcastLayout_arrayLikeToArray(o,minLen)}(arr,i)||function useVonageBroadcastLayout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useVonageBroadcastLayout_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function useVonageBroadcastLayout(vonageSessionId,roomOrEventId,canControlRecordingAs){var _result$data2,_useVonageLayoutProvi2=useVonageBroadcastLayout_slicedToArray((0,graphql.t_v)({variables:{vonageSessionId},pause:!vonageSessionId.length}),2),result=_useVonageLayoutProvi2[0],_refetchLayout=_useVonageLayoutProvi2[1],_useState2=useVonageBroadcastLayout_slicedToArray((0,react.useState)(null),2),initialLayoutData=_useState2[0],setInitialLayoutData=_useState2[1],_useState4=useVonageBroadcastLayout_slicedToArray((0,react.useState)(null),2),layoutData=_useState4[0],setLayoutData=_useState4[1];(0,react.useEffect)((function(){var _result$data;null!==(_result$data=result.data)&&void 0!==_result$data&&_result$data.video_VonageSessionLayout.length&&(0,vonage.fA)(result.data.video_VonageSessionLayout[0].layoutData)&&(setLayoutData(null),setInitialLayoutData({layout:result.data.video_VonageSessionLayout[0].layoutData,createdAt:Date.parse(result.data.video_VonageSessionLayout[0].created_at)}))}),[null===(_result$data2=result.data)||void 0===_result$data2?void 0:_result$data2.video_VonageSessionLayout]);var currentLayout=(0,react.useMemo)((function(){var _ref;return null!==(_ref=null!=layoutData?layoutData:initialLayoutData)&&void 0!==_ref?_ref:{layout:{type:vonage.x0.BestFit,screenShareType:"verticalPresentation"},createdAt:Date.now()}}),[initialLayoutData,layoutData]),insertLayout=useVonageBroadcastLayout_slicedToArray((0,graphql.c6A)(),2)[1],toast=(0,chakra_ui_toast_esm.pm)(),conferenceId=(0,useConference.fk)().id,_useState6=useVonageBroadcastLayout_slicedToArray((0,react.useState)([]),2),availableStreams=_useState6[0],setAvailableStreams=_useState6[1],saveContext=(0,react.useMemo)((function(){var _makeContext2,_makeContext3,_makeContext4,_makeContext5,_makeContext6;if(roomOrEventId){var _makeContext;if(canControlRecordingAs.has(VonageRoomProvider.c$.ConferenceOrganizer))return(0,make_context.f)(((_makeContext={})[auth.k.Role]=auth.Z.ConferenceOrganizer,_makeContext));if(canControlRecordingAs.has(VonageRoomProvider.c$.RoomAdmin))switch(roomOrEventId.type){case"room":return(0,make_context.f)(((_makeContext2={})[auth.k.Role]=auth.Z.RoomAdmin,_makeContext2[auth.k.RoomId]=roomOrEventId.id,_makeContext2));case"room-with-event":return(0,make_context.f)(((_makeContext3={})[auth.k.Role]=auth.Z.RoomAdmin,_makeContext3[auth.k.RoomId]=roomOrEventId.roomId,_makeContext3))}switch(roomOrEventId.type){case"room":return(0,make_context.f)(((_makeContext4={})[auth.k.Role]=auth.Z.RoomMember,_makeContext4[auth.k.RoomId]=roomOrEventId.id,_makeContext4));case"room-with-event":return(0,make_context.f)(((_makeContext5={})[auth.k.Role]=auth.Z.RoomMember,_makeContext5[auth.k.RoomId]=roomOrEventId.roomId,_makeContext5));case"event":return(0,make_context.f)(((_makeContext6={})[auth.k.Role]=auth.Z.Attendee,_makeContext6))}}}),[canControlRecordingAs,roomOrEventId]),saveLayout=(0,react.useCallback)(function(){var _ref2=function useVonageBroadcastLayout_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useVonageBroadcastLayout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useVonageBroadcastLayout_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(_layoutData){var _data$screenShareType,_data$side,_data$splitDirection,_data$narrowStream,_layoutData$layout,data,idx,key,_ref3,_layoutData$createdAt,_result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(vonageSessionId){_context.next=3;break}throw console.error("No Vonage session available for layout insert"),new Error("No Vonage session available for layout insert");case 3:if(_context.prev=3,!(data=null!==(_layoutData$layout=null==_layoutData?void 0:_layoutData.layout)&&void 0!==_layoutData$layout?_layoutData$layout:null==layoutData?void 0:layoutData.layout)){_context.next=22;break}for(idx=1;idx<7;idx++)(key="position"+idx)in data&&data[key]&&("streamId"in data[key]?function(){var streamId=data[key].streamId;availableStreams.some((function(x){return x.streamId===streamId}))||delete data[key]}():function(){var connectionId=data[key].connectionId;availableStreams.some((function(x){return x.connectionId===connectionId}))||delete data[key]}());_context.t0=data.type,_context.next=_context.t0===vonage.x0.BestFit?10:_context.t0===vonage.x0.Single?12:_context.t0===vonage.x0.Pair?14:_context.t0===vonage.x0.PictureInPicture?16:_context.t0===vonage.x0.Fitted4?18:_context.t0===vonage.x0.DualScreen?20:22;break;case 10:return data={type:vonage.x0.BestFit,screenShareType:null!==(_data$screenShareType=data.screenShareType)&&void 0!==_data$screenShareType?_data$screenShareType:"verticalPresentation"},_context.abrupt("break",22);case 12:return data={type:vonage.x0.Single,position1:data.position1},_context.abrupt("break",22);case 14:return data={type:vonage.x0.Pair,position1:data.position1,position2:data.position2},_context.abrupt("break",22);case 16:return data={type:vonage.x0.PictureInPicture,position1:data.position1,position2:data.position2},_context.abrupt("break",22);case 18:return data={type:vonage.x0.Fitted4,side:null!==(_data$side=data.side)&&void 0!==_data$side?_data$side:"left",position1:data.position1,position2:data.position2,position3:data.position3,position4:data.position4,position5:data.position5},_context.abrupt("break",22);case 20:return data={type:vonage.x0.DualScreen,splitDirection:null!==(_data$splitDirection=data.splitDirection)&&void 0!==_data$splitDirection?_data$splitDirection:"horizontal",narrowStream:null!==(_data$narrowStream=data.narrowStream)&&void 0!==_data$narrowStream?_data$narrowStream:null,position1:data.position1,position2:data.position2,position3:data.position3,position4:data.position4,position5:data.position5,position6:data.position6},_context.abrupt("break",22);case 22:if(!data){_context.next=29;break}return setLayoutData({layout:data,createdAt:null!==(_ref3=null!==(_layoutData$createdAt=null==_layoutData?void 0:_layoutData.createdAt)&&void 0!==_layoutData$createdAt?_layoutData$createdAt:null==layoutData?void 0:layoutData.createdAt)&&void 0!==_ref3?_ref3:Date.now()}),_context.next=26,insertLayout({conferenceId,vonageSessionId,layoutData:data},saveContext);case 26:if(!(_result=_context.sent).error){_context.next=29;break}throw _result.error;case 29:_context.next=35;break;case 31:_context.prev=31,_context.t1=_context.catch(3),console.error("Failed to insert Vonage layout",_context.t1),toast({status:"error",title:"Could not set the layout",description:"If this error persists, you may need to leave and re-enter the room."});case 35:case"end":return _context.stop()}}),_callee,null,[[3,31]])})));return function(_x){return _ref2.apply(this,arguments)}}(),[vonageSessionId,null==layoutData?void 0:layoutData.layout,null==layoutData?void 0:layoutData.createdAt,availableStreams,insertLayout,conferenceId,saveContext,toast]),_useDisclosure=(0,chakra_ui_hooks_esm.qY)(),layoutChooser_isOpen=_useDisclosure.isOpen,layoutChooser_onOpen=_useDisclosure.onOpen,layoutChooser_onClose=_useDisclosure.onClose,layout=(0,react.useMemo)((function(){return{layout:currentLayout,updateLayout:setLayoutData,saveLayout,refetchLayout:function refetchLayout(){return _refetchLayout()},availableStreams,setAvailableStreams,layoutChooser_isOpen,layoutChooser_onOpen,layoutChooser_onClose}}),[currentLayout,saveLayout,_refetchLayout,availableStreams,layoutChooser_isOpen,layoutChooser_onOpen,layoutChooser_onClose]);(0,react.useEffect)((function(){setLayoutData(null)}),[vonageSessionId]);var receivedLayoutData=(0,react.useContext)(VonageComputedStateContext).layoutData;return(0,react.useEffect)((function(){receivedLayoutData&&setLayoutData(receivedLayoutData)}),[receivedLayoutData]),layout}function useVonageDisplay_slicedToArray(arr,i){return function useVonageDisplay_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useVonageDisplay_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useVonageDisplay_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useVonageDisplay_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useVonageDisplay_arrayLikeToArray(o,minLen)}(arr,i)||function useVonageDisplay_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useVonageDisplay_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}!function(DisplayType){DisplayType.Auto="AUTO",DisplayType.Browse="BROWSE",DisplayType.BroadcastLayout="BROADCAST_LAYOUT"}(DisplayType||(DisplayType={})),(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query VonageLayoutProvider_GetLatestVonageSessionLayout($vonageSessionId: String!) {\n        video_VonageSessionLayout(\n            where: { vonageSessionId: { _eq: $vonageSessionId } }\n            order_by: { created_at: desc }\n            limit: 1\n        ) {\n            id\n            layoutData\n            created_at\n            vonageSessionId\n        }\n    }\n\n    mutation InsertVonageSessionLayout($vonageSessionId: String!, $conferenceId: uuid!, $layoutData: jsonb!) {\n        insert_video_VonageSessionLayout(\n            objects: { vonageSessionId: $vonageSessionId, conferenceId: $conferenceId, layoutData: $layoutData }\n        ) {\n            affected_rows\n        }\n    }\n"])));var VonageLayoutContext=react.createContext(void 0);function VonageLayoutProvider_useValue(props){var layout=useVonageBroadcastLayout(props.vonageSessionId,props.type,props.canControlRecordingAs),display=function useVonageDisplay(){var settings=(0,VonageRoomProvider.xI)().settings,_useContext=(0,react.useContext)(VonageComputedStateContext),isRecordingActive=_useContext.isRecordingActive,connected=_useContext.connected,_useState2=useVonageDisplay_slicedToArray((0,react.useState)({type:DisplayType.Auto}),2),chosenDisplay=_useState2[0],setChosenDisplay=_useState2[1];(0,react.useEffect)((function(){connected||setChosenDisplay({type:DisplayType.Auto})}),[connected]);var actualDisplay=(0,react.useMemo)((function(){return chosenDisplay.type===DisplayType.Auto?settings.isBackstageRoom||isRecordingActive||settings.eventId&&!settings.eventIsFuture?{type:DisplayType.BroadcastLayout}:{type:DisplayType.Browse}:chosenDisplay}),[chosenDisplay,isRecordingActive,settings.isBackstageRoom,settings.eventId,settings.eventIsFuture]);return(0,react.useMemo)((function(){return{chosenDisplay,setChosenDisplay,actualDisplay}}),[chosenDisplay,actualDisplay])}();return(0,react.useMemo)((function(){return{layout,display}}),[display,layout])}function VonageLayoutProvider(props){return(0,jsx_runtime.jsx)(VonageLayoutContext.Provider,{value:VonageLayoutProvider_useValue(props),children:props.children})}function useVonageLayout(){var ctx=react.useContext(VonageLayoutContext);if(!ctx)throw new Error("Context not available - are you outside the provider?");return ctx}VonageLayoutProvider.displayName="VonageLayoutProvider";try{VonageLayoutProvider.displayName="VonageLayoutProvider",VonageLayoutProvider.__docgenInfo={description:"",displayName:"VonageLayoutProvider",props:{vonageSessionId:{defaultValue:null,description:"",name:"vonageSessionId",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"RoomOrEventId | null"}},canControlRecordingAs:{defaultValue:null,description:"",name:"canControlRecordingAs",required:!0,type:{name:"Set<RecordingControlReason>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/State/VonageLayoutProvider.tsx#VonageLayoutProvider"]={docgenInfo:VonageLayoutProvider.__docgenInfo,name:"VonageLayoutProvider",path:"src/aspects/Conference/Attend/Room/Vonage/State/VonageLayoutProvider.tsx#VonageLayoutProvider"})}catch(__react_docgen_typescript_loader_error){}var can_autoplay_es=__webpack_require__("../node_modules/.pnpm/can-autoplay@3.0.2/node_modules/can-autoplay/build/can-autoplay.es.js");function AutoplayContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AutoplayContext_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AutoplayContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AutoplayContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AutoplayContext_slicedToArray(arr,i){return function AutoplayContext_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function AutoplayContext_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function AutoplayContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return AutoplayContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AutoplayContext_arrayLikeToArray(o,minLen)}(arr,i)||function AutoplayContext_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AutoplayContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var AutoplayContext=(0,react.createContext)({});function AutoplayProvider(props){return(0,jsx_runtime.jsx)(AutoplayContext.Provider,{value:(_useState2=AutoplayContext_slicedToArray((0,react.useState)(!1),2),autoplayAlertDismissed=_useState2[0],setAutoplayAlertDismissed=_useState2[1],_useState4=AutoplayContext_slicedToArray((0,react.useState)(!0),2),autoplayBlocked=_useState4[0],setAutoplayBlocked=_useState4[1],unblockAutoplay=(0,react.useCallback)(AutoplayContext_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,can_autoplay_es.Z.video({inline:!0,muted:!1});case 2:return result=_context.sent,setAutoplayBlocked(!result.result),_context.abrupt("return",Boolean(result.result));case 5:case"end":return _context.stop()}}),_callee)}))),[]),(0,react.useEffect)((function(){function _fn(){return(_fn=AutoplayContext_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,unblockAutoplay();case 2:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}(function fn(){return _fn.apply(this,arguments)})().catch((function(err){return console.error(err)}))}),[unblockAutoplay]),{unblockAutoplay,autoplayBlocked,autoplayAlertDismissed,setAutoplayAlertDismissed}),children:props.children});var _useState2,autoplayAlertDismissed,setAutoplayAlertDismissed,_useState4,autoplayBlocked,setAutoplayBlocked,unblockAutoplay}AutoplayProvider.displayName="AutoplayProvider";try{AutoplayProvider.displayName="AutoplayProvider",AutoplayProvider.__docgenInfo={description:"",displayName:"AutoplayProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoPlayback/AutoplayContext.tsx#AutoplayProvider"]={docgenInfo:AutoplayProvider.__docgenInfo,name:"AutoplayProvider",path:"src/aspects/Conference/Attend/Room/Vonage/VideoPlayback/AutoplayContext.tsx#AutoplayProvider"})}catch(__react_docgen_typescript_loader_error){}var VonageVideoPlaybackContext_templateObject,_templateObject2,vonage_video_playback_command=__webpack_require__("../packages/shared/shared-types/build/esm/video/vonage-video-playback-command.js"),es=__webpack_require__("../node_modules/.pnpm/ramda@0.28.0/node_modules/ramda/es/index.js"),react_async_hook_esm=__webpack_require__("../node_modules/.pnpm/react-async-hook@4.0.0_react@17.0.2/node_modules/react-async-hook/dist/react-async-hook.esm.js"),useMediaElement=__webpack_require__("./src/aspects/Conference/Attend/Content/Element/useMediaElement.tsx");function VonageVideoPlaybackContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function VonageVideoPlaybackContext_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){VonageVideoPlaybackContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){VonageVideoPlaybackContext_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function VonageVideoPlaybackContext_slicedToArray(arr,i){return function VonageVideoPlaybackContext_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VonageVideoPlaybackContext_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VonageVideoPlaybackContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VonageVideoPlaybackContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VonageVideoPlaybackContext_arrayLikeToArray(o,minLen)}(arr,i)||function VonageVideoPlaybackContext_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VonageVideoPlaybackContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function VonageVideoPlaybackContext_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}function VonageVideoPlaybackContext_useValue(_ref){var _latestCommand$comman,_latestCommand$comman2,_data$content_Element,vonageSessionId=_ref.vonageSessionId,canControlPlaybackAs=_ref.canControlPlaybackAs,conference=(0,useConference.fk)(),registrant=(0,useCurrentRegistrant.ZP)(),context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=auth.Z.Attendee,_makeContext))}),[]),insertCommand=VonageVideoPlaybackContext_slicedToArray((0,graphql.gKC)(),2)[1],sendCommand=(0,react.useCallback)(function(){var _ref2=VonageVideoPlaybackContext_asyncToGenerator(regeneratorRuntime.mark((function _callee(command){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,insertCommand({object:{command,createdByRegistrantId:registrant.id,conferenceId:conference.id,subconferenceId:null,vonageSessionId}},context);case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),[conference.id,context,insertCommand,registrant.id,vonageSessionId]),connected=(0,react.useContext)(VonageComputedStateContext).connected,latestCommandResult=VonageVideoPlaybackContext_slicedToArray((0,graphql.c0M)({variables:{vonageSessionId},pause:!connected,requestPolicy:"network-only"}),1)[0],_useState2=VonageVideoPlaybackContext_slicedToArray((0,react.useState)(),2),latestCommand=_useState2[0],setLatestCommand=_useState2[1];(0,react.useEffect)((function(){if(latestCommandResult.data){var storedCommand=function parseStoredCommand(result){var latestStored=es.Z$Q(result.video_VonageVideoPlaybackCommand);if(latestStored){var command=vonage_video_playback_command.y5.safeParse(null==latestStored?void 0:latestStored.command);if(command.success)return{command:command.data,createdAtMillis:Date.parse(latestStored.createdAt),createdByRegistrantId:latestStored.createdByRegistrantId}}}(latestCommandResult.data);storedCommand&&(!latestCommand||storedCommand.createdAtMillis>latestCommand.createdAtMillis)&&setLatestCommand(storedCommand)}}),[latestCommand,latestCommandResult.data]);var receivedCommand=(0,react.useCallback)((function(command){(!latestCommand||command.createdAtMillis>latestCommand.createdAtMillis)&&setLatestCommand(command)}),[latestCommand]),vonage=(0,VonageGlobalStateProvider.dn)();(0,useEvent.z)(vonage,"video-playback-signal-received",receivedCommand),(0,urql_core.Ps)(_templateObject2||(_templateObject2=VonageVideoPlaybackContext_taggedTemplateLiteralLoose(["\n        query VonageVideoPlaybackContext_GetElement($elementId: uuid!) @cached {\n            content_Element_by_pk(id: $elementId) {\n                id\n                ...useMediaElement_MediaElement\n            }\n        }\n    "])));var _useVonageVideoPlayba7=VonageVideoPlaybackContext_slicedToArray((0,graphql.hl7)({variables:{elementId:"video"===(null==latestCommand||null===(_latestCommand$comman=latestCommand.command)||void 0===_latestCommand$comman?void 0:_latestCommand$comman.type)?latestCommand.command.elementId:null},pause:"video"!==(null==latestCommand||null===(_latestCommand$comman2=latestCommand.command)||void 0===_latestCommand$comman2?void 0:_latestCommand$comman2.type)}),1)[0],data=_useVonageVideoPlayba7.data,queryError=_useVonageVideoPlayba7.error,_parseMediaElement=(0,useMediaElement.Bl)(null!==(_data$content_Element=null==data?void 0:data.content_Element_by_pk)&&void 0!==_data$content_Element?_data$content_Element:void 0),mediaElementBlob=_parseMediaElement.mediaElementBlob,parseBlobError=_parseMediaElement.error,video=(0,react.useMemo)((function(){return mediaElementBlob?(0,useMediaElement.sd)(mediaElementBlob):void 0}),[mediaElementBlob]),subtitles=(0,react_async_hook_esm.r5)(VonageVideoPlaybackContext_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!mediaElementBlob){_context2.next=6;break}return _context2.next=3,(0,useMediaElement.EY)(mediaElementBlob);case 3:return _context2.abrupt("return",_context2.sent);case 6:return _context2.abrupt("return",void 0);case 7:case"end":return _context2.stop()}}),_callee2)}))),[]),errors=(0,react.useMemo)((function(){return{queryError,parseBlobError,videoUrlError:null==video?void 0:video.error,subtitlesUrlError:null==subtitles?void 0:subtitles.error}}),[parseBlobError,queryError,null==subtitles?void 0:subtitles.error,null==video?void 0:video.error]);return{receivedCommand,sendCommand,latestCommand,video,subtitles,errors,canControlPlaybackAs}}(0,urql_core.Ps)(VonageVideoPlaybackContext_templateObject||(VonageVideoPlaybackContext_templateObject=VonageVideoPlaybackContext_taggedTemplateLiteralLoose(["\n    mutation VonageVideoPlaybackContext_InsertCommand($object: video_VonageVideoPlaybackCommand_insert_input!) {\n        insert_video_VonageVideoPlaybackCommand_one(object: $object) {\n            id\n        }\n    }\n\n    query VonageVideoPlaybackContext_GetLatestCommand($vonageSessionId: String!) {\n        video_VonageVideoPlaybackCommand(\n            where: { vonageSessionId: { _eq: $vonageSessionId } }\n            order_by: { createdAt: desc }\n            limit: 1\n        ) {\n            id\n            command\n            createdByRegistrantId\n            createdAt\n        }\n    }\n"])));var VonageVideoPlaybackContext=(0,react.createContext)({});function VonageVideoPlaybackProvider(props){return(0,jsx_runtime.jsx)(VonageVideoPlaybackContext.Provider,{value:VonageVideoPlaybackContext_useValue(props),children:props.children})}VonageVideoPlaybackProvider.displayName="VonageVideoPlaybackProvider";try{VonageVideoPlaybackProvider.displayName="VonageVideoPlaybackProvider",VonageVideoPlaybackProvider.__docgenInfo={description:"",displayName:"VonageVideoPlaybackProvider",props:{vonageSessionId:{defaultValue:null,description:"",name:"vonageSessionId",required:!0,type:{name:"string"}},canControlPlaybackAs:{defaultValue:null,description:"",name:"canControlPlaybackAs",required:!0,type:{name:"Set<RecordingControlReason>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoPlayback/VonageVideoPlaybackContext.tsx#VonageVideoPlaybackProvider"]={docgenInfo:VonageVideoPlaybackProvider.__docgenInfo,name:"VonageVideoPlaybackProvider",path:"src/aspects/Conference/Attend/Room/Vonage/VideoPlayback/VonageVideoPlaybackContext.tsx#VonageVideoPlaybackProvider"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),chakra_ui_modal_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+modal@1.10.7_d24435ba52f1f88b08cc54a1f1d4e56f/node_modules/@chakra-ui/modal/dist/chakra-ui-modal.esm.js"),chakra_ui_button_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js");function AutoplayAlert_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AutoplayAlert_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AutoplayAlert_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AutoplayAlert_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AutoplayAlert(_ref){var connected=_ref.connected,autoplay=(0,react.useContext)(AutoplayContext),autoplayAlert=(0,chakra_ui_hooks_esm.qY)(),autoplayCancelRef=(0,react.useRef)(null),toast=(0,chakra_ui_toast_esm.pm)();(0,react.useEffect)((function(){function _fn(){return(_fn=AutoplayAlert_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,autoplay.unblockAutoplay();case 2:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}(function fn(){return _fn.apply(this,arguments)})().catch((function(err){return console.error(err)}))}),[autoplay]);var unblockAutoplay=(0,react.useCallback)((function(){autoplay.unblockAutoplay().then((function(result){result?autoplayAlert.onClose():toast({status:"error",title:"Could not enable video playback."})})).catch((function(err){return console.error(err)}))}),[autoplay,autoplayAlert,toast]),dismissUnblockAutoplay=(0,react.useCallback)((function(){autoplay.setAutoplayAlertDismissed(!0),autoplayAlert.onClose()}),[autoplay,autoplayAlert]);return(0,react.useEffect)((function(){connected&&autoplay.autoplayBlocked&&!autoplay.autoplayAlertDismissed?autoplayAlert.onOpen():autoplay.autoplayBlocked||autoplayAlert.onClose()}),[autoplay.autoplayBlocked,autoplayAlert,autoplay.autoplayAlertDismissed,connected]),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.aR,{isOpen:autoplayAlert.isOpen,leastDestructiveRef:autoplayCancelRef,onClose:autoplayAlert.onClose,children:(0,jsx_runtime.jsx)(chakra_ui_modal_esm.dh,{children:(0,jsx_runtime.jsxs)(chakra_ui_modal_esm._T,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fY,{fontSize:"lg",fontWeight:"bold",children:"You must enable video playback"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.iP,{children:"Midspace cannot automatically play videos in your browser."}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.xo,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{ref:autoplayCancelRef,onClick:dismissUnblockAutoplay,ml:3,children:"Dismiss"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"ConfirmButton",onClick:unblockAutoplay,ml:3,children:"Enable video playback"})]})]})})})}AutoplayAlert.displayName="AutoplayAlert";try{AutoplayAlert.displayName="AutoplayAlert",AutoplayAlert.__docgenInfo={description:"",displayName:"AutoplayAlert",props:{connected:{defaultValue:null,description:"",name:"connected",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/VideoChat/AutoplayAlert.tsx#AutoplayAlert"]={docgenInfo:AutoplayAlert.__docgenInfo,name:"AutoplayAlert",path:"src/aspects/Conference/Attend/Room/VideoChat/AutoplayAlert.tsx#AutoplayAlert"})}catch(__react_docgen_typescript_loader_error){}function RecordingAlert(){var leastDestructiveRef=(0,react.useRef)(null),vonage=(0,VonageGlobalStateProvider.dn)(),settings=(0,VonageRoomProvider.xI)().settings,_useContext=(0,react.useContext)(VonageComputedStateContext),isRecordingActive=_useContext.isRecordingActive,leaveRoom=_useContext.leaveRoom,recentlyConnected=_useContext.recentlyConnected,recentlyToggledRecording=_useContext.recentlyToggledRecording,setRecentlyToggledRecording=_useContext.setRecentlyToggledRecording,recordingAlert_LeastDestructiveRef=(0,react.useRef)(null),_useDisclosure=(0,chakra_ui_hooks_esm.qY)(),isRecordingAlertOpen=_useDisclosure.isOpen,onRecordingAlertOpen=_useDisclosure.onOpen,onRecordingAlertClose=_useDisclosure.onClose;return(0,react.useEffect)((function(){isRecordingActive&&vonage.state.type===VonageGlobalState.Yk.Connected||onRecordingAlertClose()}),[isRecordingActive,onRecordingAlertClose,vonage.state.type]),(0,react.useEffect)((function(){!isRecordingActive||recentlyConnected||recentlyToggledRecording||onRecordingAlertOpen(),setRecentlyToggledRecording(!1)}),[isRecordingActive]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.aR,{isOpen:Boolean(settings.completeGetAccessToken),onClose:function onClose(){},leastDestructiveRef,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.dh,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm._T,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fY,{children:"Video is being recorded"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.iP,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,alignItems:"flex-start",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{children:["The video-chat you are about to join"," ",settings.eventIsFuture?"will be recorded when the event starts":"is being recorded","."]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"By clicking Join below you consent to being recorded and for the recording to be owned and managed by the organizers of this conference."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"For further information, please speak to your conference organizers."})]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xo,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{spacing:2,children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{ref:leastDestructiveRef,onClick:function onClick(){var _settings$completeGet,_settings$completeGet2;null===(_settings$completeGet=settings.completeGetAccessToken)||void 0===_settings$completeGet||null===(_settings$completeGet2=_settings$completeGet.reject)||void 0===_settings$completeGet2||_settings$completeGet2.call(_settings$completeGet,"Declined to be recorded")},children:"Cancel"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:function onClick(){var _settings$completeGet3,_settings$completeGet4;null===(_settings$completeGet3=settings.completeGetAccessToken)||void 0===_settings$completeGet3||null===(_settings$completeGet4=_settings$completeGet3.resolve)||void 0===_settings$completeGet4||_settings$completeGet4.call(_settings$completeGet3)},colorScheme:"PrimaryActionButton",children:"Join"})]})})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.aR,{isOpen:isRecordingAlertOpen,onClose:onRecordingAlertClose,leastDestructiveRef:recordingAlert_LeastDestructiveRef,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.dh,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm._T,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fY,{children:"Recording has started"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.iP,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Recording of the video-call in this room has started. The recording will be managed by the conference and be made available to you when recording ends. For further information, please contact your conference organizers."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"You can find recordings under the My Stuff menu on the left."})]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xo,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{spacing:2,children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:function onClick(){leaveRoom(),onRecordingAlertClose()},children:"Disconnect"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{ref:recordingAlert_LeastDestructiveRef,colorScheme:"PrimaryActionButton",onClick:function onClick(){return onRecordingAlertClose()},children:"Ok, stay connected"})]})})]})]})]})}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js");var web=__webpack_require__("../node_modules/.pnpm/react-reverse-portal@2.1.0_react-dom@17.0.2+react@17.0.2/node_modules/react-reverse-portal/dist/web/index.js"),validate=__webpack_require__("../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/validate.js"),Auth=__webpack_require__("./src/aspects/Auth/index.ts"),RegistrantsContext=__webpack_require__("./src/aspects/Conference/RegistrantsContext.tsx"),CameraContainer=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),react.forwardRef((function CameraContainer(_props,ref){return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{ref,width:"100%",height:"100%",top:0,left:0,pos:"absolute"})})));const Components_CameraContainer=CameraContainer;try{CameraContainer.displayName="CameraContainer",CameraContainer.__docgenInfo={description:"",displayName:"CameraContainer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/CameraContainer.tsx#CameraContainer"]={docgenInfo:CameraContainer.__docgenInfo,name:"CameraContainer",path:"src/aspects/Conference/Attend/Room/Vonage/Components/CameraContainer.tsx#CameraContainer"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_image_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+image@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/image/dist/chakra-ui-image.esm.js"),resources=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/resources.ts");function CameraPlaceholderImage(_ref){var _registrant$profile,zIndex=_ref.zIndex,registrant=_ref.registrant;return null!=registrant&&null!==(_registrant$profile=registrant.profile)&&void 0!==_registrant$profile&&_registrant$profile.photoURL_350x350?(0,jsx_runtime.jsx)(chakra_ui_image_esm.Ee,{position:"absolute",top:0,left:0,w:"100%",h:"100%",overflow:"hidden",objectFit:"cover",objectPosition:"center",src:null==registrant?void 0:registrant.profile.photoURL_350x350,alt:"Profile picture of "+(null==registrant?void 0:registrant.displayName),opacity:.8,zIndex}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{position:"absolute",width:"100%",height:"100%",bgColor:"black",bgImage:resources.N,bgRepeat:"no-repeat",bgSize:"auto 76%",bgPos:"center bottom",opacity:"0.25",top:"0",zIndex})}try{CameraPlaceholder.displayName="CameraPlaceholder",CameraPlaceholder.__docgenInfo={description:"",displayName:"CameraPlaceholder",props:{zIndex:{defaultValue:null,description:"",name:"zIndex",required:!1,type:{name:"number"}},registrant:{defaultValue:null,description:"",name:"registrant",required:!1,type:{name:"RegistrantDataFragment | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/CameraPlaceholder.tsx#CameraPlaceholder"]={docgenInfo:CameraPlaceholder.__docgenInfo,name:"CameraPlaceholder",path:"src/aspects/Conference/Attend/Room/Vonage/Components/CameraPlaceholder.tsx#CameraPlaceholder"})}catch(__react_docgen_typescript_loader_error){}function MuteRemoveControlBar(_ref){var streamId=_ref.streamId,connectionId=_ref.connectionId,vonage=(0,VonageGlobalStateProvider.dn)(),canForceUnpublish=vonage.canForceUnpublish,canForceDisconnect=vonage.canForceDisconnect;return canForceUnpublish||canForceDisconnect?(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{zIndex:400,position:"absolute",top:1,left:1,w:"calc(100% - 20px)",h:"calc(100% - 8.5ex)",overflow:"hidden",colorScheme:"DestructiveActionButton",flexWrap:"wrap",gridRowGap:1,spacing:1,justifyContent:"flex-start",alignItems:"flex-start",opacity:0,_hover:{opacity:1},_focus:{opacity:1},_active:{opacity:1},transition:"opacity 0.2s ease-in-out",children:[streamId&&canForceUnpublish?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:function onClick(){vonage.forceUnpublish(streamId)},size:"xs",children:"Mute / Hide"}):void 0,canForceDisconnect?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:function onClick(){window.confirm("Are you sure you want to remove this person from the room?")&&vonage.forceDisconnect(connectionId)},size:"xs",children:"Remove"}):void 0]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}try{MuteRemoveControlBar.displayName="MuteRemoveControlBar",MuteRemoveControlBar.__docgenInfo={description:"",displayName:"MuteRemoveControlBar",props:{streamId:{defaultValue:null,description:"",name:"streamId",required:!1,type:{name:"string"}},connectionId:{defaultValue:null,description:"",name:"connectionId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/MuteRemoveControlBar.tsx#MuteRemoveControlBar"]={docgenInfo:MuteRemoveControlBar.__docgenInfo,name:"MuteRemoveControlBar",path:"src/aspects/Conference/Attend/Room/Vonage/Components/MuteRemoveControlBar.tsx#MuteRemoveControlBar"})}catch(__react_docgen_typescript_loader_error){}function ActivityOverlay(_ref){var talking=_ref.talking;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{position:"absolute",zIndex:300,left:"0",top:"0",height:"100%",width:"100%",pointerEvents:"none",border:talking?"3px solid green":"0 none"})}ActivityOverlay.displayName="ActivityOverlay";try{ActivityOverlay.displayName="ActivityOverlay",ActivityOverlay.__docgenInfo={description:"",displayName:"ActivityOverlay",props:{talking:{defaultValue:null,description:"",name:"talking",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/Overlays/ActivityOverlay.tsx#ActivityOverlay"]={docgenInfo:ActivityOverlay.__docgenInfo,name:"ActivityOverlay",path:"src/aspects/Conference/Attend/Room/Vonage/Components/Overlays/ActivityOverlay.tsx#ActivityOverlay"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_icons_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+icons@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icons/dist/chakra-ui-icons.esm.js"),chakra_ui_tooltip_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tooltip@1.4.6_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/tooltip/dist/chakra-ui-tooltip.esm.js"),FAIcon=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx");function CameraOverlay(_ref){var _registrant$displayNa,_registrant$profile,_registrant$displayNa2,registrant=_ref.registrant,microphoneEnabled=_ref.microphoneEnabled,cameraHidden=_ref.cameraHidden,videoStatus=_ref.videoStatus,audioBlocked=_ref.audioBlocked,cameraType=_ref.cameraType,profileModal=(0,ChatProfileModalProvider.s)(),toast=(0,chakra_ui_toast_esm.pm)();return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{position:"absolute",top:0,left:0,w:"100%",h:"100%",overflow:"hidden",zIndex:200,flexDir:"column-reverse",alignItems:"flex-start",mx:1,mb:.5,borderRadius:5,children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{minW:"0",maxW:"100%",minH:"unset",h:"auto",p:0,my:1,size:"xs",fontSize:"75%",background:"none",borderRadius:5,overflow:"hidden",display:"block","aria-label":"View "+(null!==(_registrant$displayNa=null==registrant?void 0:registrant.displayName)&&void 0!==_registrant$displayNa?_registrant$displayNa:"<Loading name>")+"'s profile",onClick:function onClick(){registrant&&registrant.profile?profileModal.open(Object.assign({},registrant,{profile:registrant.profile})):toast({status:"warning",title:"Profile currently unavailable",duration:2e3})},children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{pr:2,bgColor:"rgba(0,0,0,0.6)",maxWidth:"100%",children:[null!=registrant&&null!==(_registrant$profile=registrant.profile)&&void 0!==_registrant$profile&&_registrant$profile.photoURL_50x50?(0,jsx_runtime.jsx)(chakra_ui_image_esm.Ee,{w:"1.5rem",h:"auto",objectFit:"cover",objectPosition:"center",src:null==registrant?void 0:registrant.profile.photoURL_50x50,overflow:"hidden",alt:"Profile picture of "+(null==registrant?void 0:registrant.displayName)}):(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"cat",h:"1.5rem",w:"1.5rem",fontSize:"18px",color:"white",textAlign:"center"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{display:"block",color:"gray.100",noOfLines:1,children:null!==(_registrant$displayNa2=null==registrant?void 0:registrant.displayName)&&void 0!==_registrant$displayNa2?_registrant$displayNa2:"<Loading name>"}),microphoneEnabled?(0,jsx_runtime.jsx)(FAIcon.Z,{ml:1,iconStyle:"s",icon:"screen"===cameraType?"volume-up":"microphone",color:"white"}):(0,jsx_runtime.jsx)(FAIcon.Z,{ml:1,iconStyle:"s",icon:"screen"===cameraType?"volume-mute":"microphone-slash",color:"red.400"})]})}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[cameraHidden?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"There are too many people here to show everyone's video at once. This person is hidden because they haven't spoken recently.",children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ViewOffIcon,{w:6,h:6,bgColor:"rgba(0,0,0,0.6)",color:"white",p:1,"aria-label":"Video hidden",borderRadius:5})}):void 0,"codec-not-supported"===(null==videoStatus?void 0:videoStatus.error)?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"The video format is not supported in your browser.",children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.WarningTwoIcon,{w:6,h:6,bgColor:"rgba(0,0,0,0.6)",color:"red.500",p:1,"aria-label":"Video format not supported",borderRadius:5})}):void 0,"quality"===(null==videoStatus?void 0:videoStatus.error)?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"The video was hidden because the connection is not stable enough at the moment.",children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.WarningTwoIcon,{w:6,h:6,bgColor:"rgba(0,0,0,0.6)",color:"red.500",p:1,"aria-label":"Connection too unstable to show video",borderRadius:5})}):void 0,"quality"===(null==videoStatus?void 0:videoStatus.warning)&&"quality"!==videoStatus.error?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Video quality may be limited due to an unstable connection.",children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.WarningTwoIcon,{w:6,h:6,bgColor:"rgba(0,0,0,0.6)",color:"orange.500",p:1,"aria-label":"Connection unstable",borderRadius:5})}):void 0,audioBlocked?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Audio is currently blocked by your browser. Click to unblock.",children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.WarningTwoIcon,{w:6,h:6,bgColor:"rgba(0,0,0,0.6)",color:"orange.500",p:1,"aria-label":"Audio blocked by browser",onClick:function onClick(){OT.unblockAudio()},borderRadius:5})}):void 0]})]})}CameraOverlay.displayName="CameraOverlay";try{StatusOverlay.displayName="StatusOverlay",StatusOverlay.__docgenInfo={description:"",displayName:"StatusOverlay",props:{registrant:{defaultValue:null,description:"",name:"registrant",required:!0,type:{name:"RegistrantDataFragment | null"}},microphoneEnabled:{defaultValue:null,description:"",name:"microphoneEnabled",required:!1,type:{name:"boolean"}},cameraHidden:{defaultValue:null,description:"",name:"cameraHidden",required:!1,type:{name:"boolean"}},videoStatus:{defaultValue:null,description:"",name:"videoStatus",required:!1,type:{name:'{ streamHasVideo: boolean; warning?: "quality"; error?: "quality" | "codec-not-supported" | "exceeds-max-streams"; } | undefined'}},cameraType:{defaultValue:null,description:"",name:"cameraType",required:!0,type:{name:"enum",value:[{value:'"screen"'},{value:'"camera"'}]}},audioBlocked:{defaultValue:null,description:"",name:"audioBlocked",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/Overlays/StatusOverlay.tsx#StatusOverlay"]={docgenInfo:StatusOverlay.__docgenInfo,name:"StatusOverlay",path:"src/aspects/Conference/Attend/Room/Vonage/Components/Overlays/StatusOverlay.tsx#StatusOverlay"})}catch(__react_docgen_typescript_loader_error){}function CameraViewport_slicedToArray(arr,i){return function CameraViewport_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CameraViewport_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CameraViewport_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CameraViewport_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CameraViewport_arrayLikeToArray(o,minLen)}(arr,i)||function CameraViewport_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CameraViewport_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CameraViewport(_ref){var _stream$videoType,registrantId=_ref.registrantId,stream=_ref.stream,connection=_ref.connection,isTalkingRef=_ref.isTalkingRef,_ref$enableVideo=_ref.enableVideo,enableVideo=void 0===_ref$enableVideo||_ref$enableVideo,_ref$resolution=_ref.resolution,resolution=void 0===_ref$resolution?"normal":_ref$resolution,inputFramerate=_ref.framerate,children=_ref.children,ref=(0,react.useRef)(null),smallDimensions=(0,react.useMemo)((function(){return{width:160,height:120}}),[]),normalDimensions=(0,react.useMemo)((function(){return{width:480,height:360}}),[]),highResDimensions=(0,react.useMemo)((function(){return{width:1280,height:720}}),[]),framerate=null!=inputFramerate?inputFramerate:"low"===resolution?7:"high"===resolution?30:15,vonage=(0,VonageGlobalStateProvider.dn)(),_useState2=CameraViewport_slicedToArray((0,react.useState)(null),2),subscriber=_useState2[0],setSubscriber=_useState2[1],_useState4=CameraViewport_slicedToArray((0,react.useState)(void 0),2),streamHasAudio=_useState4[0],setStreamHasAudio=_useState4[1],_useState6=CameraViewport_slicedToArray((0,react.useState)(!1),2),audioBlocked=_useState6[0],setAudioBlocked=_useState6[1],_useState8=CameraViewport_slicedToArray((0,react.useState)(stream?{streamHasVideo:stream.hasVideo}:void 0),2),videoStatus=_useState8[0],setVideoStatus=_useState8[1],registrantIdObj=(0,react.useMemo)((function(){if(registrantId)return{registrant:registrantId};if(null==connection||!connection.data)return null;try{var data=JSON.parse(connection.data);return data.registrantId&&(0,validate.Z)(data.registrantId)?{registrant:data.registrantId}:null}catch(e){return console.warn("Couldn't parse registrant ID from Vonage subscriber data",connection.data),null}}),[null==connection?void 0:connection.data,registrantId]),registrant=(0,RegistrantsContext.lS)(registrantIdObj);(0,react.useEffect)((function(){var _registrant$profile,_registrant$profile2;subscriber&&null!=registrant&&null!==(_registrant$profile=registrant.profile)&&void 0!==_registrant$profile&&_registrant$profile.photoURL_350x350&&subscriber.setStyle("backgroundImageURI",null==registrant||null===(_registrant$profile2=registrant.profile)||void 0===_registrant$profile2?void 0:_registrant$profile2.photoURL_350x350)}),[registrant,subscriber]),(0,react.useEffect)((function(){if(subscriber)try{subscriber.subscribeToVideo(enableVideo)}catch(e){console.error("Failed to subscribe to video",e)}}),[enableVideo,subscriber]),(0,react.useEffect)((function(){try{var _subscriber$stream;subscriber&&null!==(_subscriber$stream=subscriber.stream)&&void 0!==_subscriber$stream&&_subscriber$stream.hasVideo&&(subscriber.setPreferredResolution("low"===resolution?smallDimensions:"high"===resolution?highResDimensions:normalDimensions),subscriber.setPreferredFrameRate(framerate))}catch(e){console.error("Failed to set preferred resolution or framerate",e)}}),[highResDimensions,normalDimensions,resolution,framerate,smallDimensions,subscriber]),(0,react.useEffect)((function(){if(stream)if(ref.current)if(vonage.state.type===VonageGlobalState.Yk.Connected)try{var _registrant$profile3,_subscriber=vonage.state.session.subscribe(stream,ref.current,Object.assign({insertMode:"append",height:"100%",width:"100%",preferredResolution:"low"===resolution?smallDimensions:"high"===resolution?highResDimensions:normalDimensions,preferredFrameRate:framerate},null!=registrant&&null!==(_registrant$profile3=registrant.profile)&&void 0!==_registrant$profile3&&_registrant$profile3.photoURL_350x350?{style:{backgroundImageURI:registrant.profile.photoURL_350x350,videoDisabledDisplayMode:"off"}}:{}));return setSubscriber(_subscriber),_subscriber.on("videoDisabled",(function(event){switch(event.reason){case"codecNotSupported":setVideoStatus((function(status){return status&&Object.assign({},status,{error:"codec-not-supported"})}));break;case"quality":setVideoStatus((function(status){return status&&Object.assign({},status,{error:"quality"})}));break;case"subscribeToVideo":setVideoStatus((function(status){return status&&Object.assign({},status,{error:"exceeds-max-streams"})}));break;default:setVideoStatus((function(status){return status&&Object.assign({},status,{streamHasVideo:!1,error:void 0})}))}})),_subscriber.on("videoEnabled",(function(){setVideoStatus((function(status){return Object.assign({},status,{streamHasVideo:!0,error:void 0})}))})),_subscriber.on("videoDisableWarning",(function(){setVideoStatus((function(status){return status&&Object.assign({},status,{warning:"quality"})}))})),_subscriber.on("videoDisableWarningLifted",(function(){setVideoStatus((function(status){return status&&Object.assign({},status,{warning:void 0})}))})),_subscriber.on("audioBlocked",(function(){setAudioBlocked(!0)})),_subscriber.on("audioUnblocked",(function(){setAudioBlocked(!1)})),setVideoStatus((function(status){return Object.assign({},status,{streamHasVideo:stream.hasVideo})})),function(){try{if(vonage.state.type!==VonageGlobalState.Yk.Connected)throw new Error("Cannot unsubscribe from stream unless session is connected");vonage.state.session.connection&&vonage.state.session.unsubscribe(_subscriber)}catch(e){console.log("Could not unsubscribe from stream")}finally{setSubscriber(null)}}}catch(e){console.error("Error during subscriber creation",e)}else console.error("Must be connected to session before subscribing");else console.error("No element to inject stream into",stream.streamId)}),[stream]);var _useState10=CameraViewport_slicedToArray((0,react.useState)(null!==(_stream$videoType=null==stream?void 0:stream.videoType)&&void 0!==_stream$videoType?_stream$videoType:null),2),cameraType=_useState10[0],setCameraType=_useState10[1];(0,react.useEffect)((function(){if(vonage.state.type===VonageGlobalState.Yk.Connected){var streamPropertyChangedHandler=function streamPropertyChangedHandler(event){var _event$stream$videoTy;("hasAudio"===event.changedProperty&&event.stream.streamId===(null==stream?void 0:stream.streamId)&&setStreamHasAudio(event.newValue),"hasVideo"===event.changedProperty&&event.stream.streamId===(null==stream?void 0:stream.streamId))&&(setVideoStatus((function(status){return Object.assign({},status,{streamHasVideo:event.newValue})})),setCameraType(null!==(_event$stream$videoTy=event.stream.videoType)&&void 0!==_event$stream$videoTy?_event$stream$videoTy:null))};vonage.state.session.on("streamPropertyChanged",streamPropertyChangedHandler),setStreamHasAudio(null==stream?void 0:stream.hasAudio);var _vonage$state$screen,_vonage$state$screen$,_vonage$state$camera,_vonage$state$camera$,_vonage$state$camera$2,_vonage$state$screen4,streamDestroyedHandler=function streamDestroyedHandler(){setVideoStatus((function(status){return Object.assign({},status,{streamHasVideo:!1})}))},subscribedToScreen=!1,subscribedToCamera=!1;if(null!=stream&&stream.streamId)if((null===(_vonage$state$screen=vonage.state.screen)||void 0===_vonage$state$screen||null===(_vonage$state$screen$=_vonage$state$screen.stream)||void 0===_vonage$state$screen$?void 0:_vonage$state$screen$.streamId)===(null==stream?void 0:stream.streamId))setCameraType("screen"),setVideoStatus((function(status){var _vonage$state$screen$2,_vonage$state$screen2,_vonage$state$screen3;return vonage.state.type===VonageGlobalState.Yk.Connected?Object.assign({},status,{streamHasVideo:null!==(_vonage$state$screen$2=null===(_vonage$state$screen2=vonage.state.screen)||void 0===_vonage$state$screen2||null===(_vonage$state$screen3=_vonage$state$screen2.stream)||void 0===_vonage$state$screen3?void 0:_vonage$state$screen3.hasVideo)&&void 0!==_vonage$state$screen$2&&_vonage$state$screen$2}):status})),null===(_vonage$state$screen4=vonage.state.screen)||void 0===_vonage$state$screen4||_vonage$state$screen4.on("streamDestroyed",streamDestroyedHandler),subscribedToScreen=!0;else if((null===(_vonage$state$camera=vonage.state.camera)||void 0===_vonage$state$camera||null===(_vonage$state$camera$=_vonage$state$camera.publisher)||void 0===_vonage$state$camera$||null===(_vonage$state$camera$2=_vonage$state$camera$.stream)||void 0===_vonage$state$camera$2?void 0:_vonage$state$camera$2.streamId)===(null==stream?void 0:stream.streamId)){var _vonage$state$camera5,_vonage$state$camera6;setCameraType("camera"),setVideoStatus((function(status){var _vonage$state$camera$3,_vonage$state$camera2,_vonage$state$camera3,_vonage$state$camera4;return vonage.state.type===VonageGlobalState.Yk.Connected?Object.assign({},status,{streamHasVideo:null!==(_vonage$state$camera$3=null===(_vonage$state$camera2=vonage.state.camera)||void 0===_vonage$state$camera2||null===(_vonage$state$camera3=_vonage$state$camera2.publisher)||void 0===_vonage$state$camera3||null===(_vonage$state$camera4=_vonage$state$camera3.stream)||void 0===_vonage$state$camera4?void 0:_vonage$state$camera4.hasVideo)&&void 0!==_vonage$state$camera$3&&_vonage$state$camera$3}):status})),null===(_vonage$state$camera5=vonage.state.camera)||void 0===_vonage$state$camera5||null===(_vonage$state$camera6=_vonage$state$camera5.publisher)||void 0===_vonage$state$camera6||_vonage$state$camera6.on("streamDestroyed",streamDestroyedHandler),subscribedToCamera=!0}return function(){if(vonage.state.type===VonageGlobalState.Yk.Connected){var _vonage$state$screen5,_vonage$state$camera7,_vonage$state$camera8;if(vonage.state.session.off("streamPropertyChanged",streamPropertyChangedHandler),subscribedToScreen)null===(_vonage$state$screen5=vonage.state.screen)||void 0===_vonage$state$screen5||_vonage$state$screen5.off("streamDestroyed",streamDestroyedHandler);if(subscribedToCamera)null===(_vonage$state$camera7=vonage.state.camera)||void 0===_vonage$state$camera7||null===(_vonage$state$camera8=_vonage$state$camera7.publisher)||void 0===_vonage$state$camera8||_vonage$state$camera8.off("streamDestroyed",streamDestroyedHandler)}}}}),[vonage.state.type,stream]);var cameraContainer=(0,react.useMemo)((function(){return(0,jsx_runtime.jsx)(Components_CameraContainer,{ref})}),[ref]);return(0,jsx_runtime.jsx)(CameraViewportInner,{registrant,streamHasAudio,enableVideo,audioBlocked,videoStatus,isTalkingRef,streamId:null==stream?void 0:stream.streamId,connectionId:null==connection?void 0:connection.connectionId,subscriber,cameraType:null!=cameraType?cameraType:"camera",children:null!=children?children:cameraContainer})}function CameraViewportInner(_ref2){var registrant=_ref2.registrant,streamHasAudio=_ref2.streamHasAudio,audioBlocked=_ref2.audioBlocked,enableVideo=_ref2.enableVideo,videoStatus=_ref2.videoStatus,isTalkingRef=_ref2.isTalkingRef,streamId=_ref2.streamId,connectionId=_ref2.connectionId,subscriber=_ref2.subscriber,cameraType=_ref2.cameraType,children=_ref2.children,_useState12=CameraViewport_slicedToArray((0,react.useState)(!1),2),isTalking=_useState12[0],setIsTalking=_useState12[1];(0,react.useEffect)((function(){if(isTalkingRef){var activityRef=isTalkingRef;null==subscriber||subscriber.on("audioLevelUpdated",(function(event){var _activityRef$current,_activityRef$current2,now=Date.now(),activity=activityRef.current,wasTalking=!(null==activity||!activity.talking);(event.audioLevel>.05?!activity||now-activity.timestamp>3e3?activityRef.current={timestamp:now,talking:!1}:activity.talking?activity.timestamp=now:now-activity.timestamp>500&&(activity.talking=!0):activityRef.current&&activity&&now-activity.timestamp>3e3&&(activityRef.current.talking=!1),wasTalking!==(null===(_activityRef$current=activityRef.current)||void 0===_activityRef$current?void 0:_activityRef$current.talking))&&setIsTalking(!(null===(_activityRef$current2=activityRef.current)||void 0===_activityRef$current2||!_activityRef$current2.talking))}))}return function(){null==subscriber||subscriber.off("audioLevelUpdated"),null==subscriber||subscriber.off("videoDisabled"),null==subscriber||subscriber.off("videoEnabled")}}),[subscriber,isTalkingRef]);var cameraHidden=!!videoStatus&&videoStatus.streamHasVideo&&!enableVideo&&(!videoStatus.error||"exceeds-max-streams"===videoStatus.error);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{position:"relative",height:"100%",width:"100%",overflow:"hidden",pos:"absolute",top:0,left:0,children:[children,null==videoStatus||!videoStatus.streamHasVideo||cameraHidden?(0,jsx_runtime.jsx)(CameraPlaceholderImage,{registrant}):void 0,(0,jsx_runtime.jsx)(CameraOverlay,{registrant,microphoneEnabled:streamHasAudio,cameraHidden,videoStatus,audioBlocked,cameraType}),(0,jsx_runtime.jsx)(ActivityOverlay,{talking:isTalking}),connectionId?(0,jsx_runtime.jsx)(MuteRemoveControlBar,{streamId,connectionId}):void 0]})}CameraViewport.displayName="CameraViewport",CameraViewportInner.displayName="CameraViewportInner";try{CameraViewport.displayName="CameraViewport",CameraViewport.__docgenInfo={description:"",displayName:"CameraViewport",props:{registrantId:{defaultValue:null,description:"",name:"registrantId",required:!1,type:{name:"string"}},connection:{defaultValue:null,description:"",name:"connection",required:!1,type:{name:"Connection"}},stream:{defaultValue:null,description:"",name:"stream",required:!1,type:{name:"Stream"}},enableVideo:{defaultValue:{value:"true"},description:"",name:"enableVideo",required:!1,type:{name:"boolean"}},resolution:{defaultValue:{value:"normal"},description:"",name:"resolution",required:!1,type:{name:"enum",value:[{value:'"normal"'},{value:'"low"'},{value:'"high"'}]}},framerate:{defaultValue:null,description:"",name:"framerate",required:!1,type:{name:"enum",value:[{value:"7"},{value:"15"},{value:"30"}]}},isTalkingRef:{defaultValue:null,description:"",name:"isTalkingRef",required:!1,type:{name:"MutableRefObject<{ timestamp: number; talking: boolean; } | null>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/CameraViewport.tsx#CameraViewport"]={docgenInfo:CameraViewport.__docgenInfo,name:"CameraViewport",path:"src/aspects/Conference/Attend/Room/Vonage/Components/CameraViewport.tsx#CameraViewport"})}catch(__react_docgen_typescript_loader_error){}function SelfCamera_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SelfCamera_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SelfCamera_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SelfCamera_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function SelfCameraComponent(_ref){var _vonage$camera,connected=_ref.connected,state=_ref.state,vonage=_ref.vonage,registrantId=_ref.registrantId,isBackstageRoom=_ref.isBackstageRoom,toast=(0,chakra_ui_toast_esm.pm)(),cameraPublishContainerRef=(0,react.useRef)(null);return(0,react.useEffect)((function(){function _fn(){return(_fn=SelfCamera_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!connected){_context.next=9;break}return _context.prev=1,_context.next=4,vonage.publishCamera(cameraPublishContainerRef.current,state.cameraIntendedEnabled?state.preferredCameraId:null,state.microphoneIntendedEnabled?state.preferredMicrophoneId:null,isBackstageRoom?"1280x720":"640x480");case 4:_context.next=9;break;case 6:_context.prev=6,_context.t0=_context.catch(1),console.error("Failed to publish camera or microphone",{err:_context.t0,cameraIntendedEnabled:state.cameraIntendedEnabled,microphoneIntendedEnabled:state.microphoneIntendedEnabled});case 9:case"end":return _context.stop()}}),_callee,null,[[1,6]])})))).apply(this,arguments)}!function fn(){return _fn.apply(this,arguments)}()}),[connected,state.cameraIntendedEnabled,state.microphoneIntendedEnabled,state.preferredCameraId,state.preferredMicrophoneId,toast,vonage,isBackstageRoom]),(0,jsx_runtime.jsx)(CameraViewport,{registrantId,enableVideo:!0,stream:null===(_vonage$camera=vonage.camera)||void 0===_vonage$camera?void 0:_vonage$camera.stream,children:(0,jsx_runtime.jsx)(Components_CameraContainer,{ref:cameraPublishContainerRef})})}SelfCameraComponent.displayName="SelfCameraComponent";try{SelfCamera.displayName="SelfCamera",SelfCamera.__docgenInfo={description:"",displayName:"SelfCamera",props:{connected:{defaultValue:null,description:"",name:"connected",required:!0,type:{name:"boolean"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"VonageRoomState"}},vonage:{defaultValue:null,description:"",name:"vonage",required:!0,type:{name:"VonageGlobalState"}},registrantId:{defaultValue:null,description:"",name:"registrantId",required:!0,type:{name:"string"}},isBackstageRoom:{defaultValue:null,description:"",name:"isBackstageRoom",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/SelfCamera.tsx#SelfCamera"]={docgenInfo:SelfCamera.__docgenInfo,name:"SelfCamera",path:"src/aspects/Conference/Attend/Room/Vonage/Components/SelfCamera.tsx#SelfCamera"})}catch(__react_docgen_typescript_loader_error){}function SelfScreen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SelfScreen_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SelfScreen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SelfScreen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function SelfScreenComponent(_ref){var _vonage$screen,connected=_ref.connected,state=_ref.state,vonage=_ref.vonage,registrantId=_ref.registrantId,screen=_ref.screen,toast=(0,chakra_ui_toast_esm.pm)(),onPermissionsProblem=(0,react.useContext)(PermissionInstructionsContext.U).onPermissionsProblem,screenPublishContainerRef=(0,react.useRef)(null);return(0,react.useEffect)((function(){function _fn(){return(_fn=SelfScreen_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!connected){_context.next=23;break}if(!state.screenShareIntendedEnabled||screen){_context.next=13;break}return _context.prev=2,_context.next=5,vonage.publishScreen(screenPublishContainerRef.current);case 5:_context.next=11;break;case 7:_context.prev=7,_context.t0=_context.catch(2),console.error("Failed to publish screen",{err:_context.t0}),onPermissionsProblem({screen:!0},"Failed to publish screen");case 11:_context.next=23;break;case 13:if(state.screenShareIntendedEnabled||!screen){_context.next=23;break}return _context.prev=14,_context.next=17,vonage.unpublishScreen();case 17:_context.next=23;break;case 19:_context.prev=19,_context.t1=_context.catch(14),console.error("Failed to unpublish screen",{err:_context.t1}),toast({status:"error",title:"Failed to unshare screen"});case 23:case"end":return _context.stop()}}),_callee,null,[[2,7],[14,19]])})))).apply(this,arguments)}!function fn(){return _fn.apply(this,arguments)}()}),[connected,state.screenShareIntendedEnabled,screen,toast,vonage,onPermissionsProblem]),(0,jsx_runtime.jsx)(CameraViewport,{registrantId,enableVideo:!0,stream:null===(_vonage$screen=vonage.screen)||void 0===_vonage$screen?void 0:_vonage$screen.stream,children:(0,jsx_runtime.jsx)(Components_CameraContainer,{ref:screenPublishContainerRef})})}SelfScreenComponent.displayName="SelfScreenComponent";try{SelfScreen.displayName="SelfScreen",SelfScreen.__docgenInfo={description:"",displayName:"SelfScreen",props:{connected:{defaultValue:null,description:"",name:"connected",required:!0,type:{name:"boolean"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"VonageRoomState"}},vonage:{defaultValue:null,description:"",name:"vonage",required:!0,type:{name:"VonageGlobalState"}},registrantId:{defaultValue:null,description:"",name:"registrantId",required:!0,type:{name:"string"}},screen:{defaultValue:null,description:"",name:"screen",required:!0,type:{name:"Publisher | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/SelfScreen.tsx#SelfScreen"]={docgenInfo:SelfScreen.__docgenInfo,name:"SelfScreen",path:"src/aspects/Conference/Attend/Room/Vonage/Components/SelfScreen.tsx#SelfScreen"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.to-string.js");var chakra_ui_color_mode_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),chakra_ui_popover_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+popover@1.11.4_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/popover/dist/chakra-ui-popover.esm.js"),chakra_ui_portal_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+portal@1.3.5_react-dom@17.0.2+react@17.0.2/node_modules/@chakra-ui/portal/dist/chakra-ui-portal.esm.js"),chakra_ui_spinner_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+spinner@1.2.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/spinner/dist/chakra-ui-spinner.esm.js"),chakra_ui_system_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+system@1.10.3_922a85da57e3646a57465b7970b0de85/node_modules/@chakra-ui/system/dist/chakra-ui-system.esm.js"),async_mutex=__webpack_require__("../node_modules/.pnpm/async-mutex@0.3.2/node_modules/async-mutex/index.mjs"),lib=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("../node_modules/.pnpm/react-emoji-render@1.2.4_react-dom@17.0.2+react@17.0.2/node_modules/react-emoji-render/lib/index.js")),useRealTime=__webpack_require__("./src/aspects/Hooks/useRealTime.tsx"),_excluded=["emoji","send"];function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function QuickSendEmote(_ref){var chat=_ref.chat,lastSendAt=(0,react.useRef)(0),send=(0,react.useCallback)((function(emoji){try{Date.now()>lastSendAt.current+2e3&&(lastSendAt.current=Date.now(),chat.send(chat.Id,graphql.aDb.Emote,emoji,{},!1))}catch(e){console.error((new Date).toLocaleString()+": Failed to send message",e)}}),[chat]),disable=(0,useRealTime.$)(1e3)<lastSendAt.current+2e3;return(0,react.useMemo)((function(){return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:"3px",justifyContent:"center",alignItems:"center",children:[(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"👏",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"👋",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"👍",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"❔",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"✔",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"❌",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"😃",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"🤣",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"😢",isDisabled:disable}),(0,jsx_runtime.jsx)(QuickSendEmojiButton,{send,emoji:"<3",isDisabled:disable})]})}),[send,disable])}function QuickSendEmojiButton(_ref2){var emoji=_ref2.emoji,send=_ref2.send,props=_objectWithoutProperties(_ref2,_excluded);return(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,Object.assign({variant:"ghost",fontSize:"20px",h:"auto",w:"30px",m:"3px",p:"3px",minW:0,onClick:function onClick(){return send(emoji)},"aria-label":"Send "+emoji+" emote"},props,{children:(0,jsx_runtime.jsx)(lib.Gl,{className:"twemoji",text:emoji})}))}QuickSendEmojiButton.displayName="QuickSendEmojiButton";try{QuickSendEmote.displayName="QuickSendEmote",QuickSendEmote.__docgenInfo={description:"",displayName:"QuickSendEmote",props:{chat:{defaultValue:null,description:"",name:"chat",required:!0,type:{name:"ChatState"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Chat/Compose/QuickSendEmote.tsx#QuickSendEmote"]={docgenInfo:QuickSendEmote.__docgenInfo,name:"QuickSendEmote",path:"src/aspects/Chat/Compose/QuickSendEmote.tsx#QuickSendEmote"})}catch(__react_docgen_typescript_loader_error){}var GlobalChatStateProvider=__webpack_require__("./src/aspects/Chat/GlobalChatStateProvider.tsx"),PermissionInstructions=__webpack_require__("./src/aspects/Conference/Attend/Room/VideoChat/PermissionInstructions.tsx");function LayoutChooser_slicedToArray(arr,i){return function LayoutChooser_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function LayoutChooser_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function LayoutChooser_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return LayoutChooser_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LayoutChooser_arrayLikeToArray(o,minLen)}(arr,i)||function LayoutChooser_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LayoutChooser_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function LayoutChooser(){var boxFill=(0,chakra_ui_system_esm.dQ)("colors","gray.400"),insetBoxFillStroke=(0,chakra_ui_system_esm.dQ)("colors","gray.600"),_useVonageLayout$layo=useVonageLayout().layout,layout=_useVonageLayout$layo.layout,updateLayout=_useVonageLayout$layo.updateLayout,saveLayout=_useVonageLayout$layo.saveLayout,isOpen=_useVonageLayout$layo.layoutChooser_isOpen,onClose=_useVonageLayout$layo.layoutChooser_onClose,_useState2=LayoutChooser_slicedToArray((0,react.useState)(null),2),initialLayout=_useState2[0],setInitialLayout=_useState2[1],localUpdatedAt=(0,react.useRef)(null);return(0,react.useEffect)((function(){isOpen&&(!localUpdatedAt.current||layout.createdAt>localUpdatedAt.current)&&setInitialLayout(layout)}),[isOpen,layout]),isOpen?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{py:2,bgColor:"purple.600",borderTopColor:"purple.400",borderTopStyle:"solid",borderTopWidth:1,children:[(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{flexWrap:"wrap",alignItems:"center",justifyContent:"center",gridRowGap:2,children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",size:"sm",onClick:function onClick(){initialLayout&&updateLayout(initialLayout),onClose()},children:"Cancel layout changes"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{size:"sm",colorScheme:"ConfirmButton",isDisabled:initialLayout===layout,onClick:function onClick(){saveLayout(),setInitialLayout(layout),onClose()},children:"Apply layout changes"})]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{w:"100%",m:1,flexWrap:"wrap",justifyContent:"center",alignItems:"center",children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Automatic best-fit mode",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,fontSize:"2xl",fontWeight:"bold",bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.BestFit?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.BestFit?"purple.400":"gray.500"},_active:{bgColor:layout.layout.type===vonage.x0.BestFit?"purple.400":"gray.300"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.BestFit,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.BestFit,screenShareType:"verticalPresentation"},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"160",height:"90",style:{fill:"transparent",strokeWidth:"5",stroke:boxFill,strokeDasharray:4},rx:10,ry:10}),(0,jsx_runtime.jsx)("text",{x:25,y:58,style:{font:"1.5em sans-serif",fill:boxFill},children:"Best fit"})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Single-feed mode: A full-screen camera or screenshare",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.Single?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.Single?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.Single?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.Single,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.Single},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:(0,jsx_runtime.jsx)("rect",{width:"160",height:"90",style:{fill:boxFill},rx:5,ry:5})})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Side-by-side mode: Two camera or screenshare feeds each 50% of the area of the video",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.Pair?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.Pair?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.Pair?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.Pair,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.Pair},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"78",height:"90",x:"0",style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"78",height:"90",x:"82",style:{fill:boxFill},rx:5,ry:5})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Picture-in-picture mode: Two camera or screenshare feeds, one full screen, the other overlayed in the bottom right corner",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.PictureInPicture?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.PictureInPicture?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.PictureInPicture?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.PictureInPicture,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.PictureInPicture},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"160",height:"90",style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"32",height:"18",x:"124",y:"66",style:{fill:boxFill,stroke:insetBoxFillStroke,strokeWidth:2},rx:1,ry:1})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Fitted-4 mode: Stack of 4 cameras to the left of a screenshare",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.Fitted4&&"left"===layout.layout.side?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.Fitted4&&"left"===layout.layout.side?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.Fitted4&&"left"===layout.layout.side?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.Fitted4&&"left"===layout.layout.side,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.Fitted4,side:"left"},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:0,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:23.3,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:46.6,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"136",height:"90",x:24,y:0,style:{fill:boxFill},rx:5,ry:5})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Fitted-4 mode: Row of 4 cameras underneath a screenshare",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.Fitted4&&"bottom"===layout.layout.side?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.Fitted4&&"bottom"===layout.layout.side?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.Fitted4&&"bottom"===layout.layout.side?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.Fitted4&&"bottom"===layout.layout.side,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.Fitted4,side:"bottom"},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"160",height:"66",x:0,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:35.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:58.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:81.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:104.5,y:69.9,style:{fill:boxFill},rx:2})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Dual-screenshare mode: Vertical split. Two screenshares side by side, 50/50 split, with 4 cameras underneath.",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.DualScreen,splitDirection:"vertical",narrowStream:null},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"78.5",height:"66",x:0,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"78.5",height:"66",x:81.5,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:35.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:58.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:81.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:104.5,y:69.9,style:{fill:boxFill},rx:2})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Dual-screenshare mode: Vertical split, narrow left. Two screenshares side by side, 25/75% split, with 4 cameras underneath.",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.DualScreen,splitDirection:"vertical",narrowStream:1},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"40",height:"66",x:0,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"117",height:"66",x:43,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:35.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:58.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:81.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:104.5,y:69.9,style:{fill:boxFill},rx:2})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Dual-screenshare mode: Vertical split, narrow right. Two screenshares side by side, 75/25% split, with 4 cameras underneath.",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"vertical"===layout.layout.splitDirection,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.DualScreen,splitDirection:"vertical",narrowStream:2},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"117",height:"66",x:0,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"40",height:"66",x:120,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:35.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:58.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:81.5,y:69.9,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:104.5,y:69.9,style:{fill:boxFill},rx:2})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Dual-screenshare mode: Horizontal split. Two screenshares one above the other, 50/50% split, with 4 cameras to the left.",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.DualScreen&&null===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.DualScreen,splitDirection:"horizontal",narrowStream:null},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"137",height:"43.5",x:23,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"137",height:"43.5",x:23,y:46.5,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:0,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:23.3,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:46.6,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:69.9,style:{fill:boxFill},rx:2})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Dual-screenshare mode: Horizontal split, narrow bottom. Two screenshares one above the other, 75/25% split, with 4 cameras to the left.",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.DualScreen,splitDirection:"horizontal",narrowStream:2},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"137",height:"66",x:23,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"137",height:"21",x:23,y:69,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:0,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:23.3,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:46.6,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:69.9,style:{fill:boxFill},rx:2})]})}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Dual-screenshare mode: Horizontal split, narrow top. Two screenshares one above the other, 75/25% split, with 4 cameras to the left.",flex:"0 0 90px",h:"55px",maxH:"auto",maxW:"auto",p:"5px",m:1,bgColor:"gray.900",cursor:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"default":"pointer",_hover:{bgColor:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"purple.400":"gray.300"},_active:{bgColor:layout.layout.type===vonage.x0.DualScreen&&2===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection?"purple.400":"gray.500"},_disabled:{bgColor:"purple.400"},isDisabled:layout.layout.type===vonage.x0.DualScreen&&1===layout.layout.narrowStream&&"horizontal"===layout.layout.splitDirection,onClick:function onClick(){for(var _layout=layout.layout,outputLayout={type:vonage.x0.DualScreen,splitDirection:"horizontal",narrowStream:1},outputIdx=1,idx=1;idx<=6;idx++){var key="position"+idx;key in _layout&&_layout[key]&&(outputLayout["position"+outputIdx]=_layout[key],outputIdx++)}localUpdatedAt.current=Date.now(),updateLayout({layout:outputLayout,createdAt:localUpdatedAt.current})},children:(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.svg,{w:80,h:45,viewBox:"0 0 160 90",children:[(0,jsx_runtime.jsx)("rect",{width:"137",height:"21",x:23,y:0,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"137",height:"66",x:23,y:24,style:{fill:boxFill},rx:5,ry:5}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:0,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:23.3,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:46.6,style:{fill:boxFill},rx:2}),(0,jsx_runtime.jsx)("rect",{width:"20",height:"20",x:0,y:69.9,style:{fill:boxFill},rx:2})]})})]})]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.unscopables.flat-map.js");function SubtitlesPanel_slicedToArray(arr,i){return function SubtitlesPanel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SubtitlesPanel_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function SubtitlesPanel_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SubtitlesPanel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SubtitlesPanel_arrayLikeToArray(o,minLen)}(arr,i)||function SubtitlesPanel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SubtitlesPanel_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SubtitlesPanel(_ref){var onTranscriptRef=_ref.onTranscriptRef,transcripts=(0,react.useRef)([]);(0,react.useEffect)((function(){onTranscriptRef&&(onTranscriptRef.current=function(data){transcripts.current.push({createdAt:Date.now(),name:data.registrant.name,transcript:data.transcript})})}),[onTranscriptRef]);var _useState2=SubtitlesPanel_slicedToArray((0,react.useState)([]),2),renderedTranscripts=_useState2[0],setRenderedTranscripts=_useState2[1];return(0,react.useEffect)((function(){var tId=setInterval((function(){var now=Date.now();transcripts.current=transcripts.current.filter((function(transcript){return now-transcript.createdAt<15e3}));var result=transcripts.current.flatMap((function(transcript,idx){var key="t"+idx;return[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.P4,{color:"gray.200",children:transcript.name},key+"-name"),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.P4,{color:"white",children:transcript.transcript},key+"-transcript")]}));setRenderedTranscripts(result)}),500);return function(){clearInterval(tId)}}),[]),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.rj,{p:2,bgColor:"purple.600",borderTopColor:"purple.400",borderTopStyle:"solid",borderTopWidth:1,templateColumns:"fit-content(20%) auto",columnGap:4,rowGap:2,w:"100%",children:renderedTranscripts})}SubtitlesPanel.displayName="SubtitlesPanel";try{SubtitlesPanel.displayName="SubtitlesPanel",SubtitlesPanel.__docgenInfo={description:"",displayName:"SubtitlesPanel",props:{onTranscriptRef:{defaultValue:null,description:"",name:"onTranscriptRef",required:!1,type:{name:"MutableRefObject<((data: TranscriptData) => void)>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/SubtitlesPanel.tsx#SubtitlesPanel"]={docgenInfo:SubtitlesPanel.__docgenInfo,name:"SubtitlesPanel",path:"src/aspects/Conference/Attend/Room/Vonage/Components/SubtitlesPanel.tsx#SubtitlesPanel"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_select_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+select@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/select/dist/chakra-ui-select.esm.js");function DeviceChooserModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function DeviceChooserModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){DeviceChooserModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){DeviceChooserModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function DeviceChooserModal_slicedToArray(arr,i){return function DeviceChooserModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function DeviceChooserModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function DeviceChooserModal_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return DeviceChooserModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DeviceChooserModal_arrayLikeToArray(o,minLen)}(arr,i)||function DeviceChooserModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DeviceChooserModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function DeviceChooserModal(_ref){var isOpen=_ref.isOpen,onClose=_ref.onClose,cameraId=_ref.cameraId,microphoneId=_ref.microphoneId,showCamera=_ref.showCamera,showMicrophone=_ref.showMicrophone,_useState2=DeviceChooserModal_slicedToArray((0,react.useState)([]),2),mediaDevices=_useState2[0],setMediaDevices=_useState2[1],_useState4=DeviceChooserModal_slicedToArray((0,react.useState)(cameraId),2),selectedCamera=_useState4[0],setSelectedCamera=_useState4[1],_useState6=DeviceChooserModal_slicedToArray((0,react.useState)(microphoneId),2),selectedMicrophone=_useState6[0],setSelectedMicrophone=_useState6[1];(0,react.useEffect)((function(){function _effect(){return(_effect=DeviceChooserModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var devices;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,navigator.mediaDevices.enumerateDevices();case 2:(devices=_context.sent).some((function(d){return d.label.length>0}))?setMediaDevices(devices):onClose("unable-to-list");case 4:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}isOpen&&function effect(){return _effect.apply(this,arguments)}()}),[isOpen]);var availableCams=(0,react.useMemo)((function(){return mediaDevices.filter((function(device){return"videoinput"===device.kind&&device.label}))}),[mediaDevices]),availableMics=(0,react.useMemo)((function(){return mediaDevices.filter((function(device){return"audioinput"===device.kind&&device.label}))}),[mediaDevices]);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{scrollBehavior:"inside",onClose:function doCancel(){onClose("cancelled"),setSelectedCamera(cameraId),setSelectedMicrophone(microphoneId)},isOpen,motionPreset:"scale",children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.X6,{as:"h3",size:"md",children:[showMicrophone?"Microphone":"",showMicrophone&&showCamera?" and ":"",showCamera?"Camera":""]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ol,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.fe,{children:[showCamera?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h4",size:"sm",textAlign:"left",my:4,children:"Camera"}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{placeholder:"Choose camera",value:null!=selectedCamera?selectedCamera:void 0,onChange:function onChange(e){return""===e.target.value?setSelectedCamera(null):setSelectedCamera(e.target.value)},children:availableCams.map((function(device){return(0,jsx_runtime.jsx)("option",{value:device.deviceId,children:device.label},device.deviceId)}))})]}):void 0,showMicrophone?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h4",size:"sm",textAlign:"left",my:4,children:"Microphone"}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{placeholder:"Choose microphone",value:null!=selectedMicrophone?selectedMicrophone:void 0,onChange:function onChange(e){return""===e.target.value?setSelectedMicrophone(null):setSelectedMicrophone(e.target.value)},children:availableMics.map((function(device){return(0,jsx_runtime.jsx)("option",{value:device.deviceId,children:device.label},device.deviceId)}))})]}):void 0]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:function doClose(){onClose("made-selection",selectedCamera,selectedMicrophone)},colorScheme:"PrimaryActionButton",mt:5,children:"Save"})})]})]})})}try{DeviceChooserModal.displayName="DeviceChooserModal",DeviceChooserModal.__docgenInfo={description:"",displayName:"DeviceChooserModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onOpen:{defaultValue:null,description:"",name:"onOpen",required:!0,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:'(actionPerformed: "made-selection" | "cancelled" | "unable-to-list", cameraId?: string | null | undefined, microphoneId?: string | null | undefined) => void'}},cameraId:{defaultValue:null,description:"",name:"cameraId",required:!0,type:{name:"string | null"}},microphoneId:{defaultValue:null,description:"",name:"microphoneId",required:!0,type:{name:"string | null"}},showCamera:{defaultValue:null,description:"",name:"showCamera",required:!0,type:{name:"boolean"}},showMicrophone:{defaultValue:null,description:"",name:"showMicrophone",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/DeviceChooserModal.tsx#DeviceChooserModal"]={docgenInfo:DeviceChooserModal.__docgenInfo,name:"DeviceChooserModal",path:"src/aspects/Conference/Attend/Room/Vonage/DeviceChooserModal.tsx#DeviceChooserModal"})}catch(__react_docgen_typescript_loader_error){}var ControlBarButton=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/ControlBar/ControlBarButton.tsx"),useIsNarrowView=__webpack_require__("./src/aspects/Hooks/useIsNarrowView.ts");function ControlBarButtonGroup(_ref){var label=_ref.label,icon=_ref.icon,children=_ref.children,_ref$noCollapse=_ref.noCollapse,noCollapse=void 0!==_ref$noCollapse&&_ref$noCollapse,_ref$isVisible=_ref.isVisible,isVisible=void 0===_ref$isVisible||_ref$isVisible,narrowView=(0,useIsNarrowView.Z)(),_useDisclosure=(0,chakra_ui_hooks_esm.qY)(),isOpen=_useDisclosure.isOpen,onClose=_useDisclosure.onClose,onToggle=_useDisclosure.onToggle;return isVisible?narrowView&&!noCollapse?(0,jsx_runtime.jsxs)(chakra_ui_popover_esm.J2,{isOpen,onClose,placement:"top",children:[(0,jsx_runtime.jsx)(chakra_ui_popover_esm.xo,{children:(0,jsx_runtime.jsx)(ControlBarButton.B,{label,isActive:isOpen,icon:icon||{active:"chevron-down",inactive:"chevron-up"},onClick:onToggle})}),(0,jsx_runtime.jsxs)(chakra_ui_popover_esm.yk,{onClick:onClose,p:0,w:"min-content",children:[(0,jsx_runtime.jsx)(chakra_ui_popover_esm.QH,{}),(0,jsx_runtime.jsx)(chakra_ui_popover_esm.b,{children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.gC,{children})})]})]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}try{ControlBarButtonGroup.displayName="ControlBarButtonGroup",ControlBarButtonGroup.__docgenInfo={description:"",displayName:"ControlBarButtonGroup",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"string | IconProps"}},isVisible:{defaultValue:{value:"true"},description:"",name:"isVisible",required:!1,type:{name:"boolean"}},noCollapse:{defaultValue:{value:"false"},description:"",name:"noCollapse",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/ControlBar/ControlBarButtonGroup.tsx#ControlBarButtonGroup"]={docgenInfo:ControlBarButtonGroup.__docgenInfo,name:"ControlBarButtonGroup",path:"src/aspects/Conference/Attend/Room/Vonage/ControlBar/ControlBarButtonGroup.tsx#ControlBarButtonGroup"})}catch(__react_docgen_typescript_loader_error){}var PlayVideoMenu_templateObject,VonageRoomControlBar_templateObject,chakra_ui_menu_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+menu@1.8.6_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/menu/dist/chakra-ui-menu.esm.js"),maybeCompare=__webpack_require__("./src/aspects/Utils/maybeCompare.tsx");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return PlayVideoMenu_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||PlayVideoMenu_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PlayVideoMenu_slicedToArray(arr,i){return function PlayVideoMenu_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PlayVideoMenu_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||PlayVideoMenu_unsupportedIterableToArray(arr,i)||function PlayVideoMenu_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PlayVideoMenu_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return PlayVideoMenu_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PlayVideoMenu_arrayLikeToArray(o,minLen):void 0}}function PlayVideoMenu_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function PlayVideoMenuButton(_ref){var _eventResponse$data3,_eventResponse$data3$,_eventResponse$data4,_eventResponse$data4$,_eventResponse$data6,_eventResponse$data6$,_eventResponse$data6$2,_roomResponse$data2,_roomResponse$data2$r,roomId=_ref.roomId,eventId=_ref.eventId,_useContext=(0,react.useContext)(VonageVideoPlaybackContext),sendCommand=_useContext.sendCommand,latestCommand=_useContext.latestCommand,eventResponse=PlayVideoMenu_slicedToArray((0,graphql.X2i)({variables:{eventId},pause:!eventId}),1)[0],context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.RoomId]=roomId,_makeContext))}),[roomId]),roomResponse=PlayVideoMenu_slicedToArray((0,graphql.kE4)({variables:{roomId},pause:!roomId,context}),1)[0],eventMenuItems=(0,react.useMemo)((function(){var _eventResponse$data,_eventResponse$data$s,_eventResponse$data$s2,_eventResponse$data2,_eventResponse$data2$,_eventResponse$data2$2;return es.mNm((function(x){return x.id}),[].concat(_toConsumableArray(null!==(_eventResponse$data=eventResponse.data)&&void 0!==_eventResponse$data&&null!==(_eventResponse$data$s=_eventResponse$data.schedule_Event_by_pk)&&void 0!==_eventResponse$data$s&&_eventResponse$data$s.item?[eventResponse.data.schedule_Event_by_pk.item]:[]),_toConsumableArray(null!==(_eventResponse$data$s2=null===(_eventResponse$data2=eventResponse.data)||void 0===_eventResponse$data2||null===(_eventResponse$data2$=_eventResponse$data2.schedule_Event_by_pk)||void 0===_eventResponse$data2$||null===(_eventResponse$data2$2=_eventResponse$data2$.presentations)||void 0===_eventResponse$data2$2?void 0:_eventResponse$data2$2.flatMap((function(x){return x.item?[x.item]:[]})))&&void 0!==_eventResponse$data$s2?_eventResponse$data$s2:[]))).flatMap((function(item){var _item$elements$map;return null!==(_item$elements$map=null==item?void 0:item.elements.map((function(element){return(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.sN,{onClick:function onClick(){sendCommand({type:"video",currentTimeSeconds:0,elementId:element.id,playing:!0,volume:1})},children:[item.title,": ",element.name]},element.id)})))&&void 0!==_item$elements$map?_item$elements$map:[]}))}),[null===(_eventResponse$data3=eventResponse.data)||void 0===_eventResponse$data3||null===(_eventResponse$data3$=_eventResponse$data3.schedule_Event_by_pk)||void 0===_eventResponse$data3$?void 0:_eventResponse$data3$.item,null===(_eventResponse$data4=eventResponse.data)||void 0===_eventResponse$data4||null===(_eventResponse$data4$=_eventResponse$data4.schedule_Event_by_pk)||void 0===_eventResponse$data4$?void 0:_eventResponse$data4$.presentations,sendCommand]),exhibitionMenuItems=(0,react.useMemo)((function(){var _eventResponse$data$s3,_eventResponse$data5,_eventResponse$data5$,_eventResponse$data5$2;return es.DYV((function(x,y){return(0,maybeCompare.D)(x.priority,y.priority,(function(a,b){return a-b}))}),null!==(_eventResponse$data$s3=null==eventResponse||null===(_eventResponse$data5=eventResponse.data)||void 0===_eventResponse$data5||null===(_eventResponse$data5$=_eventResponse$data5.schedule_Event_by_pk)||void 0===_eventResponse$data5$||null===(_eventResponse$data5$2=_eventResponse$data5$.exhibition)||void 0===_eventResponse$data5$2?void 0:_eventResponse$data5$2.items)&&void 0!==_eventResponse$data$s3?_eventResponse$data$s3:[]).filter((function(item){return item.item.id!==item.id})).flatMap((function(item){return item.item.elements.map((function(element){return(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.sN,{onClick:function onClick(){sendCommand({type:"video",currentTimeSeconds:0,elementId:element.id,playing:!0,volume:1})},children:[item.item.title,": ",element.name]},element.id)}))}))}),[null==eventResponse||null===(_eventResponse$data6=eventResponse.data)||void 0===_eventResponse$data6||null===(_eventResponse$data6$=_eventResponse$data6.schedule_Event_by_pk)||void 0===_eventResponse$data6$||null===(_eventResponse$data6$2=_eventResponse$data6$.exhibition)||void 0===_eventResponse$data6$2?void 0:_eventResponse$data6$2.items,sendCommand]),roomItemMenuItems=(0,react.useMemo)((function(){var _roomResponse$data,_roomResponse$data$ro,roomItem=null===(_roomResponse$data=roomResponse.data)||void 0===_roomResponse$data||null===(_roomResponse$data$ro=_roomResponse$data.room_Room_by_pk)||void 0===_roomResponse$data$ro?void 0:_roomResponse$data$ro.item;return roomItem?roomItem.elements.map((function(element){return(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.sN,{onClick:function onClick(){sendCommand({type:"video",currentTimeSeconds:0,elementId:element.id,playing:!0,volume:1})},children:[roomItem.title,": ",element.name]},element.id)})):[]}),[null===(_roomResponse$data2=roomResponse.data)||void 0===_roomResponse$data2||null===(_roomResponse$data2$r=_roomResponse$data2.room_Room_by_pk)||void 0===_roomResponse$data2$r?void 0:_roomResponse$data2$r.item,sendCommand]),menuItems=(0,react.useMemo)((function(){var _latestCommand$comman,_latestCommand$comman2;return"video"===(null==latestCommand||null===(_latestCommand$comman=latestCommand.command)||void 0===_latestCommand$comman?void 0:_latestCommand$comman.type)||eventMenuItems.length||exhibitionMenuItems.length||roomItemMenuItems.length?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["video"===(null==latestCommand||null===(_latestCommand$comman2=latestCommand.command)||void 0===_latestCommand$comman2?void 0:_latestCommand$comman2.type)?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){return sendCommand({type:"no-video"})},icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.CloseIcon,{}),children:"Stop video"},"stop"),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.R,{})]}):void 0,es.iDB((0,jsx_runtime.jsx)(chakra_ui_menu_esm.R,{}),[].concat(_toConsumableArray(eventMenuItems.length?[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Event videos",children:eventMenuItems},"Event videos")]:[]),_toConsumableArray(exhibitionMenuItems.length?[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Exhibition videos",children:exhibitionMenuItems},"Exhibition videos")]:[]),_toConsumableArray(roomItemMenuItems.length?[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{title:"Room videos",children:roomItemMenuItems},"Room videos")]:[])))]}):(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{isDisabled:!0,children:"No videos available"})}),[null==latestCommand?void 0:latestCommand.command.type,eventMenuItems,exhibitionMenuItems,roomItemMenuItems,sendCommand]);return(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Play a video",children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.hU,size:"sm",colorScheme:"RoomControlBarButton",isLoading:eventResponse.fetching,icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"play-circle"}),"aria-label":"Play video"})}),(0,jsx_runtime.jsx)(chakra_ui_portal_esm.h_,{children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.qy,{zIndex:"1000000",overflow:"auto",maxH:"50vh",maxW:"50vh",children:menuItems})})]})}(0,urql_core.Ps)(PlayVideoMenu_templateObject||(PlayVideoMenu_templateObject=function PlayVideoMenu_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query GetEventVideos($eventId: uuid!) @cached {\n        schedule_Event_by_pk(id: $eventId) {\n            id\n            itemId\n            presentations {\n                item {\n                    id\n                    title\n                    elements(where: { typeName: { _in: [VIDEO_BROADCAST, VIDEO_FILE] } }) {\n                        id\n                        name\n                        itemId\n                        typeName\n                    }\n                }\n            }\n            item {\n                id\n                title\n                elements(where: { typeName: { _in: [VIDEO_BROADCAST, VIDEO_FILE] } }) {\n                    id\n                    name\n                    itemId\n                    typeName\n                }\n            }\n            exhibition {\n                id\n                items {\n                    id\n                    priority\n                    exhibitionId\n                    itemId\n                    item {\n                        id\n                        title\n                        elements(where: { typeName: { _in: [VIDEO_BROADCAST, VIDEO_FILE] } }) {\n                            id\n                            name\n                            itemId\n                            typeName\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    query GetRoomVideos($roomId: uuid!) @cached {\n        room_Room_by_pk(id: $roomId) {\n            id\n            item {\n                id\n                title\n                elements(where: { typeName: { _in: [VIDEO_BROADCAST, VIDEO_FILE] }, hasBeenSubmitted: { _eq: true } }) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"]))),PlayVideoMenuButton.displayName="PlayVideoMenuButton";try{PlayVideoMenu.displayName="PlayVideoMenu",PlayVideoMenu.__docgenInfo={description:"",displayName:"PlayVideoMenu",props:{roomId:{defaultValue:null,description:"",name:"roomId",required:!0,type:{name:"string | undefined"}},eventId:{defaultValue:null,description:"",name:"eventId",required:!0,type:{name:"string | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/ControlBar/PlayVideoMenu.tsx#PlayVideoMenu"]={docgenInfo:PlayVideoMenu.__docgenInfo,name:"PlayVideoMenu",path:"src/aspects/Conference/Attend/Room/Vonage/ControlBar/PlayVideoMenu.tsx#PlayVideoMenu"})}catch(__react_docgen_typescript_loader_error){}function VonageRoomControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function VonageRoomControlBar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){VonageRoomControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){VonageRoomControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function VonageRoomControlBar_slicedToArray(arr,i){return function VonageRoomControlBar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VonageRoomControlBar_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VonageRoomControlBar_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VonageRoomControlBar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VonageRoomControlBar_arrayLikeToArray(o,minLen)}(arr,i)||function VonageRoomControlBar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VonageRoomControlBar_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function VonageRoomControlBar(_ref){var _roomChatIdResponse$d,_roomChatIdResponse$d2,_layout$display,_layout$display$actua,_settings$joiningRoom,_settings$joinRoomBut,_ref5,_state$cameraStream$g,_state$cameraStream,_ref6,_state$microphoneStre,_state$microphoneStre2,onCancelJoinRoom=_ref.onCancelJoinRoom,_useVonageRoom=(0,VonageRoomProvider.xI)(),state=_useVonageRoom.state,dispatch=_useVonageRoom.dispatch,settings=_useVonageRoom.settings,vonage=(0,VonageGlobalStateProvider.dn)(),_useVonageLayout=useVonageLayout(),_useVonageLayout$layo=_useVonageLayout.layout,layoutChooser_isOpen=_useVonageLayout$layo.layoutChooser_isOpen,layoutChooser_onOpen=_useVonageLayout$layo.layoutChooser_onOpen,layoutChooser_onClose=_useVonageLayout$layo.layoutChooser_onClose,display=_useVonageLayout.display,_useContext=(0,react.useContext)(VonageComputedStateContext),isRecordingActive=_useContext.isRecordingActive,joining=_useContext.joining,joinRoom=_useContext.joinRoom,leaveRoom=_useContext.leaveRoom,onTranscriptRef=_useContext.onTranscriptRef,setRecentlyToggledRecording=_useContext.setRecentlyToggledRecording,_useToggleVonageRecor2=VonageRoomControlBar_slicedToArray((0,graphql.LrZ)(),2),toggleVonageRecordingResponse=_useToggleVonageRecor2[0],toggleVonageRecording=_useToggleVonageRecor2[1],_useState2=VonageRoomControlBar_slicedToArray((0,react.useState)(!1),2),isOpening=_useState2[0],setIsOpening=_useState2[1],_useState4=VonageRoomControlBar_slicedToArray((0,react.useState)({camera:!1,microphone:!1}),2),userMediaPermissionGranted=_useState4[0],setUserMediaPermissionGranted=_useState4[1],_useState6=VonageRoomControlBar_slicedToArray((0,react.useState)({isOpen:!1,showCamera:!1,showMicrophone:!1}),2),deviceModalState=_useState6[0],setDeviceModalState=_useState6[1],_useState8=VonageRoomControlBar_slicedToArray((0,react.useState)(!1),2),startCameraOnClose=_useState8[0],setStartCameraOnClose=_useState8[1],_useState10=VonageRoomControlBar_slicedToArray((0,react.useState)(!1),2),startMicrophoneOnClose=_useState10[0],setStartMicrophoneOnClose=_useState10[1],onClose=(0,react.useCallback)((function(madeSelection){var cameraId=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,microphoneId=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(madeSelection){case"made-selection":cameraId?cameraId!==state.preferredCameraId&&dispatch({type:VonageRoomProvider.XX.SetPreferredCamera,cameraId}):dispatch({type:VonageRoomProvider.XX.ClearPreferredCamera}),microphoneId?microphoneId!==state.preferredMicrophoneId&&dispatch({type:VonageRoomProvider.XX.SetPreferredMicrophone,microphoneId}):dispatch({type:VonageRoomProvider.XX.ClearPreferredMicrophone}),startCameraOnClose&&cameraId&&dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!0,onError:void 0}),startMicrophoneOnClose&&microphoneId&&dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!0,onError:void 0});break;case"unable-to-list":settings.onPermissionsProblem({camera:deviceModalState.showCamera,microphone:deviceModalState.showMicrophone},"Could not list choices of "+(0,PermissionInstructions.S$)({camera:deviceModalState.showCamera,microphone:deviceModalState.showMicrophone},"or"))}setStartCameraOnClose(!1),setStartMicrophoneOnClose(!1),setDeviceModalState(Object.assign({},deviceModalState,{isOpen:!1}))}),[deviceModalState,dispatch,settings,startCameraOnClose,startMicrophoneOnClose,state.preferredCameraId,state.preferredMicrophoneId]),dialogOpenMutex=(0,react.useRef)(new async_mutex.WU),_onOpen=(0,react.useCallback)(function(){var _ref2=VonageRoomControlBar_asyncToGenerator(regeneratorRuntime.mark((function _callee2(video,audio){var release;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,dialogOpenMutex.current.acquire();case 2:release=_context2.sent,setIsOpening(!0),VonageRoomControlBar_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var devices,canSeeVideoDevices,canSeeAudioDevices,gotVideoPermission,gotAudioPermission,msg,_msg;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,navigator.mediaDevices.enumerateDevices();case 3:if(devices=_context.sent,canSeeVideoDevices=devices.filter((function(d){return"videoinput"===d.kind})).some((function(d){return d.label.length>0})),canSeeAudioDevices=devices.filter((function(d){return"audioinput"===d.kind})).some((function(d){return d.label.length>0})),(!video||userMediaPermissionGranted.camera&&canSeeVideoDevices)&&(!audio||userMediaPermissionGranted.microphone&&canSeeAudioDevices)){_context.next=42;break}if(gotVideoPermission=!1,gotAudioPermission=!1,!video){_context.next=25;break}return _context.prev=10,_context.next=13,navigator.mediaDevices.getUserMedia({video});case 13:gotVideoPermission=!0,_context.next=25;break;case 16:if(_context.prev=16,_context.t0=_context.catch(10),msg=_context.t0.toString(),"NotFoundError"!==_context.t0.name&&"OverconstrainedError"!==_context.t0.name){_context.next=23;break}console.warn("No devices found by getUserMedia",{err:_context.t0,video}),_context.next=25;break;case 23:if(msg.includes("Concurrent")&&msg.includes("limit")){_context.next=25;break}throw _context.t0;case 25:if(!audio){_context.next=41;break}return _context.prev=26,_context.next=29,navigator.mediaDevices.getUserMedia({audio});case 29:gotAudioPermission=!0,_context.next=41;break;case 32:if(_context.prev=32,_context.t1=_context.catch(26),_msg=_context.t1.toString(),"NotFoundError"!==_context.t1.name&&"OverconstrainedError"!==_context.t1.name){_context.next=39;break}console.warn("No devices found by getUserMedia",{err:_context.t1,audio}),_context.next=41;break;case 39:if(_msg.includes("Concurrent")&&_msg.includes("limit")){_context.next=41;break}throw _context.t1;case 41:setUserMediaPermissionGranted({camera:userMediaPermissionGranted.camera||gotVideoPermission,microphone:userMediaPermissionGranted.microphone||gotAudioPermission});case 42:setDeviceModalState({isOpen:!0,showCamera:video,showMicrophone:audio}),_context.next=50;break;case 45:_context.prev=45,_context.t2=_context.catch(0),console.log("Could not list device choices",{err:_context.t2}),settings.onPermissionsProblem({camera:video,microphone:audio},"Could not list choices of "+(0,PermissionInstructions.S$)({camera:video,microphone:audio},"and")),setUserMediaPermissionGranted({camera:!video&&userMediaPermissionGranted.camera,microphone:!audio&&userMediaPermissionGranted.microphone});case 50:return _context.prev=50,setIsOpening(!1),release(),_context.finish(50);case 54:case"end":return _context.stop()}}),_callee,null,[[0,45,50,54],[10,16],[26,32]])})))();case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}(),[settings,userMediaPermissionGranted.camera,userMediaPermissionGranted.microphone]),startCamera=(0,react.useCallback)((function(){state.preferredCameraId?state.cameraIntendedEnabled?dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!1,explicitlyDisabled:!0,onError:void 0}):dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!0,onError:function onError(){dispatch({type:VonageRoomProvider.XX.ClearPreferredCamera}),setUserMediaPermissionGranted({camera:!1,microphone:userMediaPermissionGranted.microphone}),setStartCameraOnClose(!0),_onOpen(!0,!1)}}):(setStartCameraOnClose(!0),_onOpen(!0,!1))}),[dispatch,_onOpen,state.cameraIntendedEnabled,state.preferredCameraId,userMediaPermissionGranted.microphone]),stopCamera=(0,react.useCallback)((function(){dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!1,explicitlyDisabled:!0,onError:void 0})}),[dispatch]),startMicrophone=(0,react.useCallback)((function(){state.preferredMicrophoneId?state.microphoneIntendedEnabled?dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!1,explicitlyDisabled:!0,onError:void 0}):dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!0,onError:function onError(){dispatch({type:VonageRoomProvider.XX.ClearPreferredMicrophone}),setUserMediaPermissionGranted({camera:userMediaPermissionGranted.camera,microphone:!1}),setStartMicrophoneOnClose(!0),_onOpen(!1,!0)}}):(setStartMicrophoneOnClose(!0),_onOpen(!1,!0))}),[dispatch,_onOpen,state.microphoneIntendedEnabled,state.preferredMicrophoneId,userMediaPermissionGranted.camera]),stopMicrophone=(0,react.useCallback)((function(){dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!1,explicitlyDisabled:!0,onError:void 0})}),[dispatch]),startScreenShare=(0,react.useCallback)((function(){dispatch({type:VonageRoomProvider.XX.SetScreenShareIntendedState,screenEnabled:!0})}),[dispatch]),stopScreenShare=(0,react.useCallback)((function(){dispatch({type:VonageRoomProvider.XX.SetScreenShareIntendedState,screenEnabled:!1})}),[dispatch]),receivingScreenShareCount=(0,react.useMemo)((function(){return vonage.state.type===VonageGlobalState.Yk.Connected?vonage.state.streams.filter((function(s){return"screen"===s.videoType})).length:0}),[vonage.state]),buttonsDirection=vonage.state.type===VonageGlobalState.Yk.Connected?"row":"column";(0,react.useEffect)((function(){vonage.state.type!==VonageGlobalState.Yk.Connected&&layoutChooser_onClose()}),[vonage.state.type]);var globalChatState=(0,GlobalChatStateProvider.hg)(),_useState12=VonageRoomControlBar_slicedToArray((0,react.useState)(null),2),chat=_useState12[0],setChat=_useState12[1],context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.RoomId]=settings.roomId,_makeContext))}),[settings.roomId]),chatId=null===(_roomChatIdResponse$d=VonageRoomControlBar_slicedToArray((0,graphql.sHB)({variables:{roomId:settings.roomId},pause:!settings.roomId,context}),1)[0].data)||void 0===_roomChatIdResponse$d||null===(_roomChatIdResponse$d2=_roomChatIdResponse$d.room_Room_by_pk)||void 0===_roomChatIdResponse$d2?void 0:_roomChatIdResponse$d2.chatId;(0,react.useEffect)((function(){var unsubscribe;return chatId?unsubscribe=globalChatState.observeChatId(chatId,setChat):setChat(null),function(){var _unsubscribe;null===(_unsubscribe=unsubscribe)||void 0===_unsubscribe||_unsubscribe()}}),[chatId,globalChatState]);var controlBarBgColor=(0,chakra_ui_color_mode_esm.ff)("RoomControlBar.backgroundColor-light","RoomControlBar.backgroundColor-dark"),_useState14=VonageRoomControlBar_slicedToArray((0,react.useState)(!1),2),subtitlesVisible=_useState14[0],layout=(_useState14[1],(0,react.useContext)(VonageLayoutContext)),toast=(0,chakra_ui_toast_esm.pm)();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[vonage.state.type===VonageGlobalState.Yk.Connected&&subtitlesVisible&&(0,jsx_runtime.jsx)(SubtitlesPanel,{onTranscriptRef}),(0,jsx_runtime.jsx)(LayoutChooser,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{p:2,direction:buttonsDirection,justifyContent:"flex-end",alignItems:vonage.state.type===VonageGlobalState.Yk.Connected?"center":"stretch",flexWrap:"wrap",gridRowGap:2,gridColumnGap:2,w:vonage.state.type===VonageGlobalState.Yk.Connected?"100%":"auto",bgColor:controlBarBgColor,mt:0,children:[(0,jsx_runtime.jsxs)(ControlBarButtonGroup,{label:"Devices",icon:"headset",noCollapse:vonage.state.type!==VonageGlobalState.Yk.Connected,children:[(0,jsx_runtime.jsx)(ControlBarButton.B,{label:"Configure mic/cam",text:"Settings",isLoading:isOpening,icon:"cog",onClick:function onClick(){return _onOpen(!0,!joining||!settings.requireMicrophoneOrCamera)},isEnabled:!joining}),(0,jsx_runtime.jsx)(ControlBarButton.B,{label:{active:"Mute",inactive:"Unmute"},text:{active:"Mute",inactive:"Unmute"},icon:{active:"microphone",inactive:"microphone-slash"},isActive:Boolean(state.microphoneStream)&&state.microphoneIntendedEnabled,onClick:{active:stopMicrophone,inactive:startMicrophone},isEnabled:!joining}),(0,jsx_runtime.jsx)(ControlBarButton.B,{label:{active:"Stop camera",inactive:"Start camera"},text:{active:"Stop camera",inactive:"Start camera"},icon:{active:"video",inactive:"video-slash"},isActive:Boolean(state.cameraStream)&&state.cameraIntendedEnabled,onClick:{active:stopCamera,inactive:startCamera},isEnabled:!joining}),(0,jsx_runtime.jsx)(ControlBarButton.B,{label:{active:"Stop sharing screen",inactive:"Start sharing screen"},icon:"desktop",isLimited:vonage.state.type===VonageGlobalState.Yk.Connected?receivingScreenShareCount>=settings.maximumSimultaneousScreenShares?1===settings.maximumSimultaneousScreenShares?"Someone else is sharing their screen":"No more screens can be shared at the moment":!state.screenShareIntendedEnabled&&(!vonage.state.initialisedState.screenSharingSupported&&"Your browser does not support sharing your screen."):vonage.state.type===VonageGlobalState.Yk.Initialised&&(vonage.state.screenSharingSupported?"Screen sharing available after you join":"Your browser does not support sharing your screen."),isVisible:Boolean(settings.maximumSimultaneousScreenShares)&&(vonage.state.type===VonageGlobalState.Yk.Initialised||vonage.state.type===VonageGlobalState.Yk.Connected),isActive:state.screenShareIntendedEnabled,onClick:{active:stopScreenShare,inactive:startScreenShare},isEnabled:!joining})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{flex:"1 1 auto"}),(0,jsx_runtime.jsxs)(ControlBarButtonGroup,{label:"Layout & recording",isVisible:vonage.state.type===VonageGlobalState.Yk.Connected,children:[(0,jsx_runtime.jsx)(ControlBarButton.B,{label:{active:"Stop recording",inactive:"Start recording"},icon:{active:"circle",inactive:{style:"r",icon:"dot-circle"}},isVisible:vonage.state.type===VonageGlobalState.Yk.Connected&&!settings.isBackstageRoom,isLimited:!settings.canControlRecordingAs.size&&(isRecordingActive?"Recording":"Not recording"),isLoading:toggleVonageRecordingResponse.fetching,isActive:isRecordingActive,isDestructive:!0,onClick:VonageRoomControlBar_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(vonage.state.type!==VonageGlobalState.Yk.Connected){_context3.next=6;break}return setRecentlyToggledRecording(!0),_context3.next=4,toggleVonageRecording({vonageSessionId:vonage.state.session.sessionId,recordingActive:!isRecordingActive});case 4:_context3.sent.error&&toast({status:"error",title:"Failed to "+(isRecordingActive?"stop":"start")+" room recording"});case 6:case"end":return _context3.stop()}}),_callee3)}))),isEnabled:!joining}),(0,jsx_runtime.jsx)(ControlBarButton.B,{label:{active:"Browse all participants",inactive:isRecordingActive?"Show preview of the recording":"Show presenter layout"},icon:{active:{style:"s",icon:"chalkboard-teacher"},inactive:{style:"s",icon:"chalkboard-teacher"}},isVisible:settings.isBackstageRoom||isRecordingActive||Boolean(settings.eventId)&&!settings.eventIsFuture,isActive:(null==layout||null===(_layout$display=layout.display)||void 0===_layout$display||null===(_layout$display$actua=_layout$display.actualDisplay)||void 0===_layout$display$actua?void 0:_layout$display$actua.type)===DisplayType.BroadcastLayout,isLimited:!!settings.isBackstageRoom&&"Showing broadcast preview",onClick:function onClick(){var _layout$display2,_layout$display3,_layout$display3$chos;return null==layout||null===(_layout$display2=layout.display)||void 0===_layout$display2?void 0:_layout$display2.setChosenDisplay((null==layout||null===(_layout$display3=layout.display)||void 0===_layout$display3||null===(_layout$display3$chos=_layout$display3.chosenDisplay)||void 0===_layout$display3$chos?void 0:_layout$display3$chos.type)===DisplayType.Browse?{type:DisplayType.Auto}:{type:DisplayType.Browse})},isEnabled:!joining}),(0,jsx_runtime.jsx)(ControlBarButton.B,{label:{active:"Cancel",inactive:settings.isBackstageRoom?"Change broadcast layout":isRecordingActive?"Change recording layout":"Change event layout"},icon:"th-large",isVisible:vonage.state.type===VonageGlobalState.Yk.Connected&&Boolean(settings.canControlRecordingAs.size)&&display.actualDisplay.type===DisplayType.BroadcastLayout,isActive:layoutChooser_isOpen,onClick:layoutChooser_isOpen?layoutChooser_onClose:layoutChooser_onOpen,isEnabled:!joining})]}),vonage.state.type===VonageGlobalState.Yk.Connected&&settings.canControlRecordingAs.size&&settings.isBackstageRoom?settings.extraLayoutButtons:void 0,vonage.state.type===VonageGlobalState.Yk.Connected&&settings.canControlRecordingAs.size&&!settings.isBackstageRoom?(0,jsx_runtime.jsx)(PlayVideoMenuButton,{roomId:settings.roomId,eventId:settings.eventId}):void 0,vonage.state.type===VonageGlobalState.Yk.Connected&&chat?(0,jsx_runtime.jsxs)(chakra_ui_popover_esm.J2,{placement:"top",children:[(0,jsx_runtime.jsx)(chakra_ui_popover_esm.xo,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{size:"sm",colorScheme:"RoomControlBarButton",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"smile"}),"aria-label":"Send an emote"})}),(0,jsx_runtime.jsx)(chakra_ui_portal_esm.h_,{children:(0,jsx_runtime.jsxs)(chakra_ui_popover_esm.yk,{children:[(0,jsx_runtime.jsx)(chakra_ui_popover_esm.QH,{}),(0,jsx_runtime.jsx)(chakra_ui_popover_esm.b,{p:0,children:(0,jsx_runtime.jsx)(QuickSendEmote,{chat})})]})})]}):void 0,(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{flex:"1 1 auto"}),vonage.state.type===VonageGlobalState.Yk.Connected?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{size:"sm",colorScheme:"DestructiveActionButton",onClick:leaveRoom,children:"Leave"}):(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:!settings.requireMicrophoneOrCamera||state.microphoneIntendedEnabled||state.cameraIntendedEnabled?void 0:"Microphone or camera required",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{w:"100%",children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{w:"100%",size:"xl",colorScheme:joining?"yellow":"PrimaryActionButton",h:"auto",p:4,variant:"glowing",onClick:joining?onCancelJoinRoom:joinRoom,isLoading:!onCancelJoinRoom&&joining,isDisabled:!joining&&settings.requireMicrophoneOrCamera&&!state.microphoneIntendedEnabled&&!state.cameraIntendedEnabled,whiteSpace:"normal",overflow:"hidden",display:"inline-flex",flexDir:"column",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{alignItems:"flex-end",children:[joining?(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{size:"sm",speed:"2.5s",thickness:"4px"}):void 0,(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{fontSize:"xl",children:joining?null!==(_settings$joiningRoom=settings.joiningRoomButtonText)&&void 0!==_settings$joiningRoom?_settings$joiningRoom:"Waiting to be admitted":null!==(_settings$joinRoomBut=settings.joinRoomButtonText)&&void 0!==_settings$joinRoomBut?_settings$joinRoomBut:"Join room"})]}),joining?(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{mt:2,fontSize:"xs",children:"(Click to cancel)"}):void 0]})})})]}),(0,jsx_runtime.jsx)(DeviceChooserModal,{cameraId:null!==(_ref5=null!==(_state$cameraStream$g=null===(_state$cameraStream=state.cameraStream)||void 0===_state$cameraStream?void 0:_state$cameraStream.getVideoTracks()[0].getSettings().deviceId)&&void 0!==_state$cameraStream$g?_state$cameraStream$g:state.preferredCameraId)&&void 0!==_ref5?_ref5:null,microphoneId:null!==(_ref6=null!==(_state$microphoneStre=null===(_state$microphoneStre2=state.microphoneStream)||void 0===_state$microphoneStre2?void 0:_state$microphoneStre2.getAudioTracks()[0].getSettings().deviceId)&&void 0!==_state$microphoneStre?_state$microphoneStre:state.preferredMicrophoneId)&&void 0!==_ref6?_ref6:null,isOpen:deviceModalState.isOpen,showCamera:deviceModalState.showCamera,showMicrophone:deviceModalState.showMicrophone,onClose,onOpen:function onOpen(){return _onOpen(!0,!0)}})]})}(0,urql_core.Ps)(VonageRoomControlBar_templateObject||(VonageRoomControlBar_templateObject=function VonageRoomControlBar_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    mutation ToggleVonageRecordingState($vonageSessionId: String!, $recordingActive: Boolean!) {\n        toggleVonageRecordingState(vonageSessionId: $vonageSessionId, recordingActive: $recordingActive) {\n            allowed\n            recordingState\n        }\n    }\n"])));try{VonageRoomControlBar.displayName="VonageRoomControlBar",VonageRoomControlBar.__docgenInfo={description:"",displayName:"VonageRoomControlBar",props:{onCancelJoinRoom:{defaultValue:null,description:"",name:"onCancelJoinRoom",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/ControlBar/VonageRoomControlBar.tsx#VonageRoomControlBar"]={docgenInfo:VonageRoomControlBar.__docgenInfo,name:"VonageRoomControlBar",path:"src/aspects/Conference/Attend/Room/Vonage/ControlBar/VonageRoomControlBar.tsx#VonageRoomControlBar"})}catch(__react_docgen_typescript_loader_error){}var Focus=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BrowseLayouts/Focus.tsx"),Gallery=__webpack_require__("./src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BrowseLayouts/Gallery.tsx");function Browse(_ref){var viewports=_ref.viewports,streamActivities=_ref.streamActivities,cameraFeeds=(0,react.useMemo)((function(){return viewports.filter((function(x){return"camera"===x.type}))}),[viewports]),screenFeeds=(0,react.useMemo)((function(){return viewports.filter((function(x){return"screen"===x.type}))}),[viewports]);return screenFeeds.length?(0,jsx_runtime.jsx)(Focus.T,{viewports:cameraFeeds,focusViewports:screenFeeds,streamActivities}):(0,jsx_runtime.jsx)(Gallery.r,{viewports:cameraFeeds,streamActivities})}try{Browse.displayName="Browse",Browse.__docgenInfo={description:"",displayName:"Browse",props:{viewports:{defaultValue:null,description:"",name:"viewports",required:!0,type:{name:"Viewport[]"}},streamActivities:{defaultValue:null,description:"",name:"streamActivities",required:!0,type:{name:"Map<string, MutableRefObject<{ timestamp: number; talking: boolean; } | null>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/Browse.tsx#Browse"]={docgenInfo:Browse.__docgenInfo,name:"Browse",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/Browse.tsx#Browse"})}catch(__react_docgen_typescript_loader_error){}var VisualLayoutType,chakra_ui_alert_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+alert@1.3.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/alert/dist/chakra-ui-alert.esm.js"),dist_module=__webpack_require__("../node_modules/.pnpm/@react-hook+size@2.1.2_react@17.0.2/node_modules/@react-hook/size/dist/module/index.js");function BestFit_NoScreenshare(_ref){var visualLayout=_ref.visualLayout;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{flexWrap:"wrap",overflow:"hidden",w:"100%",h:"100%",children:visualLayout.viewports.map((function(viewport){var _viewport$streamId;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:1===visualLayout.viewports.length?"100%":visualLayout.viewports.length<=4?"calc(50%)":visualLayout.viewports.length<=9?"calc(33%)":"calc(25%)",bgColor:"gray.700",pos:"relative",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30})})},null!==(_viewport$streamId=viewport.streamId)&&void 0!==_viewport$streamId?_viewport$streamId:viewport.connectionId)}))})}!function(VisualLayoutType){VisualLayoutType[VisualLayoutType.BestFit_NoScreenshare=0]="BestFit_NoScreenshare",VisualLayoutType[VisualLayoutType.BestFit_Screenshare_VerticalSplit=1]="BestFit_Screenshare_VerticalSplit",VisualLayoutType[VisualLayoutType.BestFit_Screenshare_HorizontalSplit=2]="BestFit_Screenshare_HorizontalSplit",VisualLayoutType[VisualLayoutType.Single=3]="Single",VisualLayoutType[VisualLayoutType.Pair=4]="Pair",VisualLayoutType[VisualLayoutType.PictureInPicture=5]="PictureInPicture",VisualLayoutType[VisualLayoutType.Fitted4_Left=6]="Fitted4_Left",VisualLayoutType[VisualLayoutType.Fitted4_Bottom=7]="Fitted4_Bottom",VisualLayoutType[VisualLayoutType.DualScreen_Horizontal=8]="DualScreen_Horizontal",VisualLayoutType[VisualLayoutType.DualScreen_Vertical=9]="DualScreen_Vertical"}(VisualLayoutType||(VisualLayoutType={})),BestFit_NoScreenshare.displayName="BestFit_NoScreenshare";try{BestFit_NoScreenshare.displayName="BestFit_NoScreenshare",BestFit_NoScreenshare.__docgenInfo={description:"",displayName:"BestFit_NoScreenshare",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_BestFit_NoScreenshare"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/BestFit_NoScreenshare.tsx#BestFit_NoScreenshare"]={docgenInfo:BestFit_NoScreenshare.__docgenInfo,name:"BestFit_NoScreenshare",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/BestFit_NoScreenshare.tsx#BestFit_NoScreenshare"})}catch(__react_docgen_typescript_loader_error){}function BestFit_Screenshare(_ref){var visualLayout=_ref.visualLayout;return visualLayout.type===VisualLayoutType.BestFit_Screenshare_HorizontalSplit?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{borderColor:"gray.900",w:"100%",h:"100%",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",maxH:"100%",bgColor:"gray.500",pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{w:"100%",h:"80%",bgColor:"gray.500",top:0,left:0,pos:"absolute",children:visualLayout.screenshareViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.screenshareViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0}),visualLayout.viewports.map((function(viewport,idx){var _viewport$streamId;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{w:"20%",h:"20%",bgColor:"gray.700",top:"80%",left:20*idx+"%",pos:"absolute",children:(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30})},null!==(_viewport$streamId=viewport.streamId)&&void 0!==_viewport$streamId?_viewport$streamId:viewport.connectionId)}))]})})}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{borderColor:"gray.900",w:"100%",h:"100%",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",maxH:"100%",bgColor:"gray.500",pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{w:"85%",h:"100%",bgColor:"gray.500",top:0,left:"15%",pos:"absolute",children:visualLayout.screenshareViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.screenshareViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0}),visualLayout.viewports.map((function(viewport,idx){var _viewport$streamId2;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:15/11.25,w:"15%",bgColor:"gray.700",top:20*idx+"%",left:"0px",pos:"absolute",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30})})},null!==(_viewport$streamId2=viewport.streamId)&&void 0!==_viewport$streamId2?_viewport$streamId2:viewport.connectionId)}))]})})})}try{BestFit_Screenshare.displayName="BestFit_Screenshare",BestFit_Screenshare.__docgenInfo={description:"",displayName:"BestFit_Screenshare",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_BestFit_Screenshare"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/BestFit_Screenshare.tsx#BestFit_Screenshare"]={docgenInfo:BestFit_Screenshare.__docgenInfo,name:"BestFit_Screenshare",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/BestFit_Screenshare.tsx#BestFit_Screenshare"})}catch(__react_docgen_typescript_loader_error){}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function StreamChooser_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return StreamChooser_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return StreamChooser_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function StreamChooser_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function StreamChooser(_ref){var centered=_ref.centered,positionKey=_ref.positionKey,isRecordingMode=_ref.isRecordingMode,_useVonageLayout$layo=useVonageLayout().layout,availableStreams=_useVonageLayout$layo.availableStreams,layout=_useVonageLayout$layo.layout.layout,updateLayout=_useVonageLayout$layo.updateLayout,saveLayout=_useVonageLayout$layo.saveLayout,layoutChooser_isOpen=_useVonageLayout$layo.layoutChooser_isOpen,changeLayout=(0,react.useCallback)((function(connectionId,streamId){var _Object$assign,newLayout=Object.assign({},layout,((_Object$assign={})[positionKey]=connectionId?streamId?{streamId}:{connectionId}:null,_Object$assign));if(connectionId)for(var idx=1;idx<7;idx++){var key="position"+idx;if(key in newLayout&&key!==positionKey){var placement=newLayout[key];placement&&("streamId"in placement&&streamId&&placement.streamId===streamId&&(newLayout[key]=null),"connectionId"in placement&&placement.connectionId===connectionId&&(newLayout[key]=null))}}layoutChooser_isOpen?updateLayout((function(old){var _old$createdAt;return{layout:newLayout,createdAt:null!==(_old$createdAt=null==old?void 0:old.createdAt)&&void 0!==_old$createdAt?_old$createdAt:Date.now()}})):saveLayout({layout:newLayout,createdAt:Date.now()})}),[layout,layoutChooser_isOpen,positionKey,saveLayout,updateLayout]),availableOptions=(0,react.useMemo)((function(){var _step,result=[],_loop=function _loop(stream){var _stream$streamId,_stream$registrantNam;!stream.streamId&&isRecordingMode||result.push((0,jsx_runtime.jsxs)(chakra_ui_menu_esm.sN,{onClick:function onClick(){changeLayout(stream.connectionId,stream.streamId)},icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"screen"===stream.type?"desktop":"video"}),children:[null!==(_stream$registrantNam=stream.registrantName)&&void 0!==_stream$registrantNam?_stream$registrantNam:"<Loading name>"," ","camera"===stream.type?"(Camera)":"(Screen-share)"]},null!==(_stream$streamId=stream.streamId)&&void 0!==_stream$streamId?_stream$streamId:stream.connectionId))},_iterator=_createForOfIteratorHelper(es.HCG([function(x,y){return(0,maybeCompare.D)(x.registrantName,y.registrantName,(function(a,b){return a.localeCompare(b)}))},function(x,y){return x.type.localeCompare(y.type)}],availableStreams));try{for(_iterator.s();!(_step=_iterator.n()).done;){_loop(_step.value)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return result}),[availableStreams,isRecordingMode,changeLayout]);return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{pos:"absolute",w:centered?"100%":"auto",h:centered?"100%":"auto",alignItems:centered?"center":"flex-start",justifyContent:centered?"center":"flex-end",zIndex:250,bottom:centered?0:1,right:centered?0:1,children:(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{placement:"top-end",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,size:"xs",colorScheme:"gray",opacity:1,whiteSpace:"normal",h:"auto",minH:0,py:1,children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:2,children:[(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"sync-alt"}),centered?(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{children:"Choose participant"}):void 0]})}),(0,jsx_runtime.jsx)(chakra_ui_portal_esm.h_,{children:(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{zIndex:1e4,maxH:"10em",overflowY:"auto",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){changeLayout(null)},children:"None"}),availableOptions]})})]})})}StreamChooser.displayName="StreamChooser";try{StreamChooser.displayName="StreamChooser",StreamChooser.__docgenInfo={description:"",displayName:"StreamChooser",props:{centered:{defaultValue:null,description:"",name:"centered",required:!0,type:{name:"boolean"}},positionKey:{defaultValue:null,description:"",name:"positionKey",required:!0,type:{name:"string"}},isRecordingMode:{defaultValue:null,description:"",name:"isRecordingMode",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/Components/StreamChooser.tsx#StreamChooser"]={docgenInfo:StreamChooser.__docgenInfo,name:"StreamChooser",path:"src/aspects/Conference/Attend/Room/Vonage/Components/StreamChooser.tsx#StreamChooser"})}catch(__react_docgen_typescript_loader_error){}function DualScreen(_ref){var visualLayout=_ref.visualLayout,allowedToControlLayout=_ref.allowedToControlLayout,isRecordingMode=_ref.isRecordingMode;return(0,react.useMemo)((function(){switch(visualLayout.type){case VisualLayoutType.DualScreen_Horizontal:var sideBoxes=visualLayout.sideAreaViewports.map((function(viewport,idx){var _ref2,_viewport$streamId;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:25*idx+"%",left:"0px",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[viewport?(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30}):(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(idx+3),centered:!1,isRecordingMode}):void 0]})},null!==(_ref2=null!==(_viewport$streamId=null==viewport?void 0:viewport.streamId)&&void 0!==_viewport$streamId?_viewport$streamId:null==viewport?void 0:viewport.connectionId)&&void 0!==_ref2?_ref2:"position"+idx)}));return visualLayout.sideAreaViewports.length<4&&sideBoxes.push((0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:25*visualLayout.sideAreaViewports.length+"%",left:"0px",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(visualLayout.sideAreaViewports.length+3),centered:!0,isRecordingMode}):void 0]})},"placeholder"+(visualLayout.sideAreaViewports.length+3))),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"86%",h:1===visualLayout.narrow?"25%":2===visualLayout.narrow?"75%":"50%",bgColor:"gray.500",top:0,left:"14%",pos:"absolute",children:[visualLayout.largeAreaViewport1?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.largeAreaViewport1.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.largeAreaViewport1,isRecordingMode}):void 0]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"86%",h:2===visualLayout.narrow?"25%":1===visualLayout.narrow?"75%":"50%",bgColor:"gray.500",top:1===visualLayout.narrow?"25%":2===visualLayout.narrow?"75%":"50%",left:"14%",pos:"absolute",children:[visualLayout.largeAreaViewport2?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.largeAreaViewport2.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position2",centered:!visualLayout.largeAreaViewport2,isRecordingMode}):void 0]}),sideBoxes]})});case VisualLayoutType.DualScreen_Vertical:var _sideBoxes=visualLayout.sideAreaViewports.map((function(viewport,idx){var _ref3,_viewport$streamId2;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:"75%",left:22+14*idx+"%",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[viewport?(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30}):(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(idx+3),centered:!1,isRecordingMode}):void 0]})},null!==(_ref3=null!==(_viewport$streamId2=null==viewport?void 0:viewport.streamId)&&void 0!==_viewport$streamId2?_viewport$streamId2:null==viewport?void 0:viewport.connectionId)&&void 0!==_ref3?_ref3:"position"+idx)}));return visualLayout.sideAreaViewports.length<4&&_sideBoxes.push((0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:"75%",left:22+14*visualLayout.sideAreaViewports.length+"%",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(visualLayout.sideAreaViewports.length+3),centered:!0,isRecordingMode}):void 0]})},"placeholder"+(visualLayout.sideAreaViewports.length+3))),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:1===visualLayout.narrow?"25%":2===visualLayout.narrow?"75%":"50%",h:"75%",bgColor:"gray.600",top:0,left:0,pos:"absolute",children:[visualLayout.largeAreaViewport1?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.largeAreaViewport1.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.largeAreaViewport1,isRecordingMode}):void 0]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:2===visualLayout.narrow?"25%":1===visualLayout.narrow?"75%":"50%",h:"75%",bgColor:"gray.500",top:0,left:1===visualLayout.narrow?"25%":2===visualLayout.narrow?"75%":"50%",pos:"absolute",children:[visualLayout.largeAreaViewport2?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.largeAreaViewport2.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position2",centered:!visualLayout.largeAreaViewport2,isRecordingMode}):void 0]}),_sideBoxes]})})}}),[allowedToControlLayout,isRecordingMode,visualLayout.largeAreaViewport1,visualLayout.largeAreaViewport2,visualLayout.narrow,visualLayout.sideAreaViewports,visualLayout.type])}try{DualScreen.displayName="DualScreen",DualScreen.__docgenInfo={description:"",displayName:"DualScreen",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_DualScreen"}},allowedToControlLayout:{defaultValue:null,description:"",name:"allowedToControlLayout",required:!0,type:{name:"boolean"}},isRecordingMode:{defaultValue:null,description:"",name:"isRecordingMode",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/DualScreen.tsx#DualScreen"]={docgenInfo:DualScreen.__docgenInfo,name:"DualScreen",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/DualScreen.tsx#DualScreen"})}catch(__react_docgen_typescript_loader_error){}function Fitted4(_ref){var visualLayout=_ref.visualLayout,allowedToControlLayout=_ref.allowedToControlLayout,isRecordingMode=_ref.isRecordingMode;return(0,react.useMemo)((function(){switch(visualLayout.type){case VisualLayoutType.Fitted4_Left:var sideBoxes=visualLayout.sideAreaViewports.map((function(viewport,idx){var _ref2,_viewport$streamId;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:25*idx+"%",left:"0px",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[viewport?(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30}):(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(idx+2),centered:!1,isRecordingMode}):void 0]})},null!==(_ref2=null!==(_viewport$streamId=null==viewport?void 0:viewport.streamId)&&void 0!==_viewport$streamId?_viewport$streamId:null==viewport?void 0:viewport.connectionId)&&void 0!==_ref2?_ref2:"position"+idx)}));return visualLayout.sideAreaViewports.length<4&&sideBoxes.push((0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:25*visualLayout.sideAreaViewports.length+"%",left:"0px",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(visualLayout.sideAreaViewports.length+2),centered:!0,isRecordingMode}):void 0]})},"placeholder"+(visualLayout.sideAreaViewports.length+2))),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"86%",h:"100%",bgColor:"gray.500",top:0,left:"14%",pos:"absolute",children:[visualLayout.largeAreaViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.largeAreaViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.largeAreaViewport,isRecordingMode}):void 0]}),sideBoxes]})});case VisualLayoutType.Fitted4_Bottom:var _sideBoxes=visualLayout.sideAreaViewports.map((function(viewport,idx){var _ref3,_viewport$streamId2;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:"75%",left:22+14*idx+"%",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[viewport?(0,jsx_runtime.jsx)(web.t0,{node:viewport.component,enableVideo:!0,resolution:"high",framerate:30}):(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(idx+2),centered:!1,isRecordingMode}):void 0]})},null!==(_ref3=null!==(_viewport$streamId2=null==viewport?void 0:viewport.streamId)&&void 0!==_viewport$streamId2?_viewport$streamId2:null==viewport?void 0:viewport.connectionId)&&void 0!==_ref3?_ref3:"position"+idx)}));return visualLayout.sideAreaViewports.length<4&&_sideBoxes.push((0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"14%",bgColor:"gray.700",top:"75%",left:22+14*visualLayout.sideAreaViewports.length+"%",pos:"absolute",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(CameraPlaceholderImage,{}),allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position"+(visualLayout.sideAreaViewports.length+2),centered:!0,isRecordingMode}):void 0]})},"placeholder"+(visualLayout.sideAreaViewports.length+2))),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"100%",h:"75%",bgColor:"gray.600",top:0,left:0,pos:"absolute",children:[visualLayout.largeAreaViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.largeAreaViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.largeAreaViewport,isRecordingMode}):void 0]}),_sideBoxes]})})}}),[allowedToControlLayout,isRecordingMode,visualLayout.largeAreaViewport,visualLayout.sideAreaViewports,visualLayout.type])}try{Fitted4.displayName="Fitted4",Fitted4.__docgenInfo={description:"",displayName:"Fitted4",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_Fitted4"}},allowedToControlLayout:{defaultValue:null,description:"",name:"allowedToControlLayout",required:!0,type:{name:"boolean"}},isRecordingMode:{defaultValue:null,description:"",name:"isRecordingMode",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/Fitted4.tsx#Fitted4"]={docgenInfo:Fitted4.__docgenInfo,name:"Fitted4",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/Fitted4.tsx#Fitted4"})}catch(__react_docgen_typescript_loader_error){}function Pair(_ref){var visualLayout=_ref.visualLayout,allowedToControlLayout=_ref.allowedToControlLayout,isRecordingMode=_ref.isRecordingMode;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{w:"100%",h:"100%",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"50%",h:"100%",bgColor:"gray.500",mr:"1px",pos:"relative",children:[visualLayout.leftViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.leftViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.leftViewport,isRecordingMode}):void 0]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"50%",h:"100%",bgColor:"gray.500",ml:"1px",pos:"relative",children:[visualLayout.rightViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.rightViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position2",centered:!visualLayout.rightViewport,isRecordingMode}):void 0]})]})})}Pair.displayName="Pair";try{Pair.displayName="Pair",Pair.__docgenInfo={description:"",displayName:"Pair",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_Pair"}},allowedToControlLayout:{defaultValue:null,description:"",name:"allowedToControlLayout",required:!0,type:{name:"boolean"}},isRecordingMode:{defaultValue:null,description:"",name:"isRecordingMode",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/Pair.tsx#Pair"]={docgenInfo:Pair.__docgenInfo,name:"Pair",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/Pair.tsx#Pair"})}catch(__react_docgen_typescript_loader_error){}function PictureInPicture(_ref){var visualLayout=_ref.visualLayout,allowedToControlLayout=_ref.allowedToControlLayout,isRecordingMode=_ref.isRecordingMode;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"100%",h:"100%",bgColor:"gray.500",top:0,left:0,pos:"absolute",zIndex:50,children:[visualLayout.fullscreenViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.fullscreenViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.fullscreenViewport,isRecordingMode}):void 0]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:1,w:"15.67%",bgColor:"gray.700",bottom:"20px",right:"20px",pos:"absolute",zIndex:60,children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[visualLayout.insetViewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.insetViewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position2",centered:!visualLayout.insetViewport,isRecordingMode}):void 0]})})]})})}PictureInPicture.displayName="PictureInPicture";try{PictureInPicture.displayName="PictureInPicture",PictureInPicture.__docgenInfo={description:"",displayName:"PictureInPicture",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_PiP"}},allowedToControlLayout:{defaultValue:null,description:"",name:"allowedToControlLayout",required:!0,type:{name:"boolean"}},isRecordingMode:{defaultValue:null,description:"",name:"isRecordingMode",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/PictureInPicture.tsx#PictureInPicture"]={docgenInfo:PictureInPicture.__docgenInfo,name:"PictureInPicture",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/PictureInPicture.tsx#PictureInPicture"})}catch(__react_docgen_typescript_loader_error){}function Single(_ref){var visualLayout=_ref.visualLayout,allowedToControlLayout=_ref.allowedToControlLayout,isRecordingMode=_ref.isRecordingMode;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{h:"100%",w:"100%",borderColor:"gray.900",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.oM,{ratio:16/9,w:"100%",bgColor:"gray.500",mr:1,pos:"relative",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{h:"100%",w:"100%",bgColor:"gray.500",children:[visualLayout.viewport?(0,jsx_runtime.jsx)(web.t0,{node:visualLayout.viewport.component,enableVideo:!0,resolution:"high",framerate:30}):void 0,allowedToControlLayout?(0,jsx_runtime.jsx)(StreamChooser,{positionKey:"position1",centered:!visualLayout.viewport,isRecordingMode}):void 0]})})})}Single.displayName="Single";try{Single.displayName="Single",Single.__docgenInfo={description:"",displayName:"Single",props:{visualLayout:{defaultValue:null,description:"",name:"visualLayout",required:!0,type:{name:"VizLayout_Single"}},allowedToControlLayout:{defaultValue:null,description:"",name:"allowedToControlLayout",required:!0,type:{name:"boolean"}},isRecordingMode:{defaultValue:null,description:"",name:"isRecordingMode",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/Single.tsx#Single"]={docgenInfo:Single.__docgenInfo,name:"Single",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/BroadcastLayouts/Single.tsx#Single"})}catch(__react_docgen_typescript_loader_error){}function Layout_slicedToArray(arr,i){return function Layout_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function Layout_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function Layout_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Layout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Layout_arrayLikeToArray(o,minLen)}(arr,i)||function Layout_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Layout_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Layout(_ref){var viewports=_ref.viewports,allowedToControlLayout=_ref.allowedToControlLayout,settings=(0,VonageRoomProvider.xI)().settings,_useContext=(0,react.useContext)(VonageComputedStateContext),isRecordingActive=_useContext.isRecordingActive,connections=_useContext.connections,isRecordingMode=settings.isBackstageRoom||isRecordingActive,_useVonageLayout=useVonageLayout(),layout=_useVonageLayout.layout,display=_useVonageLayout.display,visualLayout=function useVisualLayout(layout,viewports){return(0,react.useMemo)((function(){var _result,result;switch(layout.type){case vonage.x0.BestFit:if(viewports.some((function(vp){return"screen"===vp.type}))){var screenshareViewport=es.MRu((function(x){return x.joinedAt}),viewports.filter((function(vp){return"screen"===vp.type&&vp.streamId})))[0],priorityViewports=es.HCG([function(x,y){if(screenshareViewport){var _x$associatedIds,_x$associatedIds2,_y$associatedIds,_y$associatedIds2,xIsPreferred=screenshareViewport.streamId&&!(null===(_x$associatedIds=x.associatedIds)||void 0===_x$associatedIds||!_x$associatedIds.includes(screenshareViewport.streamId))||!(null===(_x$associatedIds2=x.associatedIds)||void 0===_x$associatedIds2||!_x$associatedIds2.includes(screenshareViewport.connectionId)),yIsPreferred=screenshareViewport.streamId&&!(null===(_y$associatedIds=y.associatedIds)||void 0===_y$associatedIds||!_y$associatedIds.includes(screenshareViewport.streamId))||!(null===(_y$associatedIds2=y.associatedIds)||void 0===_y$associatedIds2||!_y$associatedIds2.includes(screenshareViewport.connectionId));return xIsPreferred?yIsPreferred?0:-1:yIsPreferred?1:0}return 0},function(x,y){return x.streamId&&y.streamId?0:x.streamId?-1:y.streamId?1:0},function(x,y){return x.joinedAt-y.joinedAt}],viewports.filter((function(vp){return"screen"!==vp.type&&vp.streamId}))).slice(0,5);result={type:"horizontalPresentation"===layout.screenShareType?VisualLayoutType.BestFit_Screenshare_HorizontalSplit:VisualLayoutType.BestFit_Screenshare_VerticalSplit,screenshareViewport,viewports:priorityViewports,overflowViewports:viewports.filter((function(vp){return vp!==screenshareViewport&&!priorityViewports.includes(vp)}))}}else{var _priorityViewports=es.MRu((function(x){return x.joinedAt}),viewports.filter((function(x){return x.streamId}))).slice(0,16);result={type:VisualLayoutType.BestFit_NoScreenshare,viewports:_priorityViewports,overflowViewports:viewports.filter((function(vp){return!_priorityViewports.includes(vp)}))}}break;case vonage.x0.Single:var viewport;if(layout.position1)if("streamId"in layout.position1){var streamId=layout.position1.streamId;viewport=viewports.find((function(viewport){return viewport.streamId===streamId}))}else{var connectionId=layout.position1.connectionId;viewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===connectionId}))}var overflowViewports=viewports.filter((function(vp){return vp!==viewport}));result={type:VisualLayoutType.Single,viewport,overflowViewports};break;case vonage.x0.Pair:var leftViewport,rightViewport;if(layout.position1)if("streamId"in layout.position1){var _streamId=layout.position1.streamId;leftViewport=viewports.find((function(viewport){return viewport.streamId===_streamId}))}else{var _connectionId=layout.position1.connectionId;leftViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId}))}if(layout.position2){if("streamId"in layout.position2){var _streamId2=layout.position2.streamId;rightViewport=viewports.find((function(viewport){return viewport.streamId===_streamId2}))}else{var _connectionId2=layout.position2.connectionId;rightViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId2}))}rightViewport===leftViewport&&(rightViewport=void 0)}var _overflowViewports=viewports.filter((function(vp){return vp!==leftViewport&&vp!==rightViewport}));result={type:VisualLayoutType.Pair,leftViewport,rightViewport,overflowViewports:_overflowViewports};break;case vonage.x0.PictureInPicture:var fullscreenViewport,insetViewport;if(layout.position1)if("streamId"in layout.position1){var _streamId3=layout.position1.streamId;fullscreenViewport=viewports.find((function(viewport){return viewport.streamId===_streamId3}))}else{var _connectionId3=layout.position1.connectionId;fullscreenViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId3}))}if(layout.position2){if("streamId"in layout.position2){var _streamId4=layout.position2.streamId;insetViewport=viewports.find((function(viewport){return viewport.streamId===_streamId4}))}else{var _connectionId4=layout.position2.connectionId;insetViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId4}))}insetViewport===fullscreenViewport&&(insetViewport=void 0)}var _overflowViewports2=viewports.filter((function(vp){return vp!==fullscreenViewport&&vp!==insetViewport}));result={type:VisualLayoutType.PictureInPicture,fullscreenViewport,insetViewport,overflowViewports:_overflowViewports2};break;case vonage.x0.Fitted4:var largeAreaViewport,processPlacement=function processPlacement(position){if(position){var tempViewport;if("streamId"in position){var _streamId6=position.streamId;tempViewport=viewports.find((function(viewport){return viewport.streamId===_streamId6}))}else{var _connectionId6=position.connectionId;tempViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId6}))}tempViewport&&tempViewport!==largeAreaViewport&&!sideAreaViewports.includes(tempViewport)?sideAreaViewports.push(tempViewport):sideAreaViewports.push(void 0)}else sideAreaViewports.push(void 0)},sideAreaViewports=[];if(layout.position1)if("streamId"in layout.position1){var _streamId5=layout.position1.streamId;largeAreaViewport=viewports.find((function(viewport){return viewport.streamId===_streamId5}))}else{var _connectionId5=layout.position1.connectionId;largeAreaViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId5}))}processPlacement(layout.position2),processPlacement(layout.position3),processPlacement(layout.position4),processPlacement(layout.position5);var _overflowViewports3=viewports.filter((function(vp){return vp!==largeAreaViewport&&!sideAreaViewports.includes(vp)}));result={type:"left"===layout.side?VisualLayoutType.Fitted4_Left:VisualLayoutType.Fitted4_Bottom,largeAreaViewport,sideAreaViewports,overflowViewports:_overflowViewports3};break;case vonage.x0.DualScreen:var _layout$narrowStream,largeAreaViewport1,largeAreaViewport2,_processPlacement=function _processPlacement(position){if(position){var tempViewport;if("streamId"in position){var _streamId9=position.streamId;tempViewport=viewports.find((function(viewport){return viewport.streamId===_streamId9}))}else{var _connectionId9=position.connectionId;tempViewport=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId9}))}tempViewport&&tempViewport!==largeAreaViewport1&&tempViewport!==largeAreaViewport2&&!_sideAreaViewports.includes(tempViewport)?_sideAreaViewports.push(tempViewport):_sideAreaViewports.push(void 0)}else _sideAreaViewports.push(void 0)},_sideAreaViewports=[];if(layout.position1)if("streamId"in layout.position1){var _streamId7=layout.position1.streamId;largeAreaViewport1=viewports.find((function(viewport){return viewport.streamId===_streamId7}))}else{var _connectionId7=layout.position1.connectionId;largeAreaViewport1=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId7}))}if(layout.position2)if("streamId"in layout.position2){var _streamId8=layout.position2.streamId;largeAreaViewport2=viewports.find((function(viewport){return viewport.streamId===_streamId8}))}else{var _connectionId8=layout.position2.connectionId;largeAreaViewport2=viewports.find((function(viewport){return!viewport.streamId&&viewport.connectionId===_connectionId8}))}_processPlacement(layout.position3),_processPlacement(layout.position4),_processPlacement(layout.position5),_processPlacement(layout.position6);var _overflowViewports4=viewports.filter((function(vp){return vp!==largeAreaViewport1&&vp!==largeAreaViewport2&&!_sideAreaViewports.includes(vp)}));result={type:"horizontal"===layout.splitDirection?VisualLayoutType.DualScreen_Horizontal:VisualLayoutType.DualScreen_Vertical,narrow:null!==(_layout$narrowStream=layout.narrowStream)&&void 0!==_layout$narrowStream?_layout$narrowStream:null,largeAreaViewport1,largeAreaViewport2,sideAreaViewports:_sideAreaViewports,overflowViewports:_overflowViewports4}}return(result=null!==(_result=result)&&void 0!==_result?_result:{type:VisualLayoutType.BestFit_NoScreenshare,viewports:[],overflowViewports:viewports}).overflowViewports=es.HCG([function(x,y){return x.isSelf?y.isSelf?0:-1:y.isSelf?1:0},function(x,y){return x.joinedAt-y.joinedAt}],result.overflowViewports),result}),[layout,viewports])}(layout.layout.layout,viewports),layoutPanelRef=react.useRef(null),_useSize2=Layout_slicedToArray((0,dist_module.Z)(layoutPanelRef),2),layoutPanelWidth=_useSize2[0],layoutPanelHeight=_useSize2[1],tooTall=layoutPanelHeight*(16/9)>=layoutPanelWidth,height=tooTall?layoutPanelWidth*(9/16):layoutPanelHeight,width=tooTall?layoutPanelWidth:layoutPanelHeight*(16/9),noVideosEl=(0,react.useMemo)((function(){return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{h:"100%",w:"100%",children:(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"info",variant:"subtle",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",px:8,py:4,my:"auto",maxW:"50ch",colorScheme:"RoomNoVideoAlert",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Eq,{align:"center",pb:2,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{flexGrow:0,children:(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{boxSize:"8"})}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{flexGrow:1,flexBasis:"min-content",children:(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{fontSize:{base:"md",md:"lg"},textAlign:"left",children:"Nobody has their video turned on right now"})})]}),(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.X,{mr:2,fontSize:{base:"sm",md:"md"},children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:settings.isBackstageRoom?"Nothing will be visible during your event broadcast until someone turns on their camera or shares their screen.":isRecordingActive?"No video tiles will appear in the recording until someone turns on their camera or shares their screen.":"No video tiles will appear here until someone turns on their camera or shares their screen."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{mt:2,children:Math.max(connections.length-1,0)+" other "+(connections.length-1==1?"person is":"people are")+" connected to this video chat."}),connections.length>1?(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:function onClick(){return display.setChosenDisplay({type:DisplayType.Browse})},mt:2,colorScheme:"RoomControlBarButton",size:"xs",leftIcon:(0,jsx_runtime.jsx)(FAIcon.Z,{icon:"chalkboard-teacher",iconStyle:"s"}),children:"Browse all participants"}):void 0]})]})})}),[connections.length,display,isRecordingActive,settings.isBackstageRoom]),layoutEl=(0,react.useMemo)((function(){switch(visualLayout.type){case VisualLayoutType.BestFit_NoScreenshare:return visualLayout.viewports.length?(0,jsx_runtime.jsx)(BestFit_NoScreenshare,{visualLayout}):noVideosEl;case VisualLayoutType.BestFit_Screenshare_HorizontalSplit:case VisualLayoutType.BestFit_Screenshare_VerticalSplit:return visualLayout.viewports.length||visualLayout.screenshareViewport?(0,jsx_runtime.jsx)(BestFit_Screenshare,{visualLayout}):noVideosEl;case VisualLayoutType.Single:return(0,jsx_runtime.jsx)(Single,{visualLayout,allowedToControlLayout,isRecordingMode});case VisualLayoutType.Pair:return(0,jsx_runtime.jsx)(Pair,{visualLayout,allowedToControlLayout,isRecordingMode});case VisualLayoutType.PictureInPicture:return(0,jsx_runtime.jsx)(PictureInPicture,{visualLayout,allowedToControlLayout,isRecordingMode});case VisualLayoutType.Fitted4_Left:case VisualLayoutType.Fitted4_Bottom:return(0,jsx_runtime.jsx)(Fitted4,{visualLayout,allowedToControlLayout,isRecordingMode});case VisualLayoutType.DualScreen_Horizontal:case VisualLayoutType.DualScreen_Vertical:return(0,jsx_runtime.jsx)(DualScreen,{visualLayout,allowedToControlLayout,isRecordingMode})}}),[allowedToControlLayout,isRecordingMode,noVideosEl,visualLayout]);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{justifyContent:"center",alignItems:"stretch",flexGrow:1,children:[!settings.isBackstageRoom&&isRecordingActive?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h3",size:"sm",flexGrow:0,flexShrink:1,pt:2,children:"Preview of recording"}):void 0,(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flexBasis:0,minH:"10em",flexGrow:{base:1.5,md:2.5,lg:3},flexShrink:1,ref:layoutPanelRef,children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{w:width+"px",h:height+"px",mx:"auto",flexGrow:1,flexShrink:1,overflowY:"auto",children:layoutEl})}),visualLayout.overflowViewports.length?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{flexBasis:0,minH:"5em",flexGrow:1,flexShrink:1,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.X6,{as:"h3",size:"sm",pt:2,children:["Not included in ",settings.isBackstageRoom?"stream":"recording"]}),(0,jsx_runtime.jsx)(Gallery.r,{viewports:visualLayout.overflowViewports,streamActivities:new Map})]}):void 0]})}Layout.displayName="Layout";try{Layout.displayName="Layout",Layout.__docgenInfo={description:"",displayName:"Layout",props:{viewports:{defaultValue:null,description:"",name:"viewports",required:!0,type:{name:"Viewport[]"}},allowedToControlLayout:{defaultValue:null,description:"",name:"allowedToControlLayout",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VideoGrid/Layout.tsx#Layout"]={docgenInfo:Layout.__docgenInfo,name:"Layout",path:"src/aspects/Conference/Attend/Room/Vonage/VideoGrid/Layout.tsx#Layout"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_skeleton_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+skeleton@1.2.9_7a0e80f0ff188bdcb70281ff1d883ac0/node_modules/@chakra-ui/skeleton/dist/chakra-ui-skeleton.esm.js"),chakra_ui_tag_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tag@1.2.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/tag/dist/chakra-ui-tag.esm.js"),chakra_ui_slider_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+slider@1.5.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/slider/dist/chakra-ui-slider.esm.js"),luxon=__webpack_require__("../node_modules/.pnpm/luxon@2.3.0/node_modules/luxon/build/cjs-browser/luxon.js"),VideoAspectWrapper=__webpack_require__("./src/aspects/Conference/Attend/Room/Video/VideoAspectWrapper.tsx"),timeout_dist_module=__webpack_require__("../node_modules/.pnpm/@react-hook+timeout@2.1.1_react@17.0.2/node_modules/@react-hook/timeout/dist/module/index.js"),useRef=__webpack_require__("../node_modules/.pnpm/use-callback-ref@1.2.5_a0c521d4794c7ad97f5f4c1c4a7d5818/node_modules/use-callback-ref/dist/es2015/useRef.js");function useVideoCommands_slicedToArray(arr,i){return function useVideoCommands_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useVideoCommands_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useVideoCommands_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useVideoCommands_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useVideoCommands_arrayLikeToArray(o,minLen)}(arr,i)||function useVideoCommands_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useVideoCommands_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function useVideoCommands_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useVideoCommands_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useVideoCommands_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useVideoCommands_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function setVideoElementState(_x,_x2){return _setVideoElementState.apply(this,arguments)}function _setVideoElementState(){return(_setVideoElementState=useVideoCommands_asyncToGenerator(regeneratorRuntime.mark((function _callee(videoEl,latestCommand){var _latestCommand$comman,offsetMillis,seekPosition;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if("video"!==(null===(_latestCommand$comman=latestCommand.command)||void 0===_latestCommand$comman?void 0:_latestCommand$comman.type)){_context.next=10;break}if(offsetMillis=Date.now()-latestCommand.createdAtMillis,(seekPosition=latestCommand.command.playing?latestCommand.command.currentTimeSeconds+offsetMillis/1e3:latestCommand.command.currentTimeSeconds)>videoEl.duration?videoEl.currentTime=videoEl.duration:Math.abs(videoEl.currentTime-seekPosition)>2&&(videoEl.currentTime=seekPosition),!latestCommand.command.playing){_context.next=9;break}return _context.next=7,videoEl.play();case 7:_context.next=10;break;case 9:videoEl.pause();case 10:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}function VideoChatVideoPlayer_slicedToArray(arr,i){return function VideoChatVideoPlayer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VideoChatVideoPlayer_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VideoChatVideoPlayer_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VideoChatVideoPlayer_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VideoChatVideoPlayer_arrayLikeToArray(o,minLen)}(arr,i)||function VideoChatVideoPlayer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VideoChatVideoPlayer_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function VideoChatVideoPlayer(){var _videoPlayback$latest3,_videoPlayback$video2,_videoPlayback$latest4,_useVideoCommands=function useVideoCommands(){var _videoPlayback$latest4,videoPlayback=(0,react.useContext)(VonageVideoPlaybackContext),videoPlaybackRef=(0,chakra_ui_hooks_esm.II)(videoPlayback),autoplay=(0,react.useContext)(AutoplayContext),_useState2=useVideoCommands_slicedToArray((0,react.useState)(!1),2),ended=_useState2[0],setEnded=_useState2[1],_useState4=useVideoCommands_slicedToArray((0,react.useState)(NaN),2),duration=_useState4[0],setDuration=_useState4[1],_useState6=useVideoCommands_slicedToArray((0,react.useState)(!1),2),disableControls=_useState6[0],setDisableControls=_useState6[1],startControlsDisabledTimeout=useVideoCommands_slicedToArray((0,timeout_dist_module.n)((function(){return setDisableControls(!1)}),2e3),1)[0],temporarilyDisableControls=(0,react.useCallback)((function(){setDisableControls(!0),startControlsDisabledTimeout()}),[startControlsDisabledTimeout]),_useState8=useVideoCommands_slicedToArray((0,react.useState)(0),2),currentTime=_useState8[0],setCurrentTime=_useState8[1],_useState10=useVideoCommands_slicedToArray((0,react.useState)(null),2),videoElement=_useState10[0],setVideoElement=_useState10[1],videoRef=(0,useRef.W)(null,(function(value,previous){setVideoElement(value),previous&&previous.pause(),value&&(value.addEventListener("ended",(function endedListener(event){event.target===videoRef.current&&setEnded(!0)})),value.addEventListener("timeupdate",(function timeUpdateListener(event){event.target instanceof HTMLMediaElement&&event.target===videoRef.current&&setCurrentTime(event.target.currentTime)})),value.addEventListener("durationchange",(function durationChangeListener(event){event.target instanceof HTMLMediaElement&&event.target===videoRef.current&&setDuration(event.target.duration)})),value.addEventListener("canplay",(function readyListener(event){event.target instanceof HTMLMediaElement&&event.target===videoRef.current&&videoPlaybackRef.current.latestCommand&&setVideoElementState(event.target,videoPlaybackRef.current.latestCommand).catch((function(){autoplay.unblockAutoplay().catch((function(err){return console.error(err)}))}))})))}));(0,react.useEffect)((function(){var _videoPlayback$latest;autoplay.autoplayBlocked||videoElement&&"video"===(null===(_videoPlayback$latest=videoPlayback.latestCommand)||void 0===_videoPlayback$latest?void 0:_videoPlayback$latest.command.type)&&setVideoElementState(videoElement,videoPlayback.latestCommand).catch((function(){autoplay.unblockAutoplay().catch((function(err){return console.error(err)}))}))}),[autoplay.autoplayBlocked]),(0,react.useEffect)((function(){currentTime<duration&&setEnded(!1)}),[duration,currentTime]);var playing=(0,react.useMemo)((function(){var _videoPlayback$latest2,_videoPlayback$latest3;return"video"===(null===(_videoPlayback$latest2=videoPlayback.latestCommand)||void 0===_videoPlayback$latest2||null===(_videoPlayback$latest3=_videoPlayback$latest2.command)||void 0===_videoPlayback$latest3?void 0:_videoPlayback$latest3.type)&&videoPlayback.latestCommand.command.playing&&!ended}),[ended,null===(_videoPlayback$latest4=videoPlayback.latestCommand)||void 0===_videoPlayback$latest4?void 0:_videoPlayback$latest4.command]);return(0,react.useEffect)((function(){var _videoPlayback$latest5;videoElement&&"video"===(null===(_videoPlayback$latest5=videoPlayback.latestCommand)||void 0===_videoPlayback$latest5?void 0:_videoPlayback$latest5.command.type)&&setVideoElementState(videoElement,videoPlayback.latestCommand).catch((function(){autoplay.unblockAutoplay().catch((function(err){return console.error(err)}))}))}),[videoElement,videoPlayback.latestCommand]),{videoRef,videoElement,playing,ended,disableControls,temporarilyDisableControls,currentTime,duration}}(),videoElement=_useVideoCommands.videoElement,playing=_useVideoCommands.playing,ended=_useVideoCommands.ended,videoRef=_useVideoCommands.videoRef,disableControls=_useVideoCommands.disableControls,currentTime=_useVideoCommands.currentTime,duration=_useVideoCommands.duration,temporarilyDisableControls=_useVideoCommands.temporarilyDisableControls,videoPlayback=(0,react.useContext)(VonageVideoPlaybackContext),autoplay=(0,react.useContext)(AutoplayContext),_useState2=VideoChatVideoPlayer_slicedToArray((0,react.useState)(.5),2),volume=_useState2[0],setVolume=_useState2[1];(0,react.useEffect)((function(){videoElement&&(videoElement.volume=volume)}),[videoElement,volume]);var isMicOnRef=(0,react.useRef)(!1),vonageRoom=(0,VonageRoomProvider.xI)(),toast=(0,chakra_ui_toast_esm.pm)(),mutedToastIdRef=(0,react.useRef)(void 0),unmutedToastIdRef=(0,react.useRef)(void 0),onPlay=(0,react.useCallback)((function(){isMicOnRef.current=vonageRoom.state.microphoneIntendedEnabled,vonageRoom.state.microphoneIntendedEnabled&&(vonageRoom.dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!1,explicitlyDisabled:!1,onError:function onError(){console.error("VideoChatVideoPlayer: Error auto-muting")}}),void 0!==unmutedToastIdRef.current&&(toast.close(unmutedToastIdRef.current),unmutedToastIdRef.current=void 0),mutedToastIdRef.current=toast({title:"Auto muted",status:"info",position:"top",description:"You have been automatically muted to avoid an audio feedback loop in the room. You will be automatically unmuted when the video is paused or ends.",isClosable:!0,duration:15e3,variant:"subtle"}))}),[toast,vonageRoom]),onPause=(0,react.useCallback)((function(){isMicOnRef.current&&!vonageRoom.state.microphoneIntendedEnabled&&(vonageRoom.dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!0,explicitlyDisabled:!1,onError:function onError(){console.error("VideoChatVideoPlayer: Error auto-un-muting")}}),void 0!==mutedToastIdRef.current&&(toast.close(mutedToastIdRef.current),mutedToastIdRef.current=void 0),unmutedToastIdRef.current=toast({title:"Auto un-muted",status:"info",position:"top",isClosable:!0,duration:3e3,variant:"subtle"}))}),[toast,vonageRoom]);(0,react.useEffect)((function(){isMicOnRef.current&&vonageRoom.state.microphoneIntendedEnabled&&(isMicOnRef.current=!1)}),[vonageRoom.state.microphoneIntendedEnabled]),(0,react.useEffect)((function(){return videoElement?(videoElement.addEventListener("play",onPlay),videoElement.addEventListener("pause",onPause),function(){videoElement.removeEventListener("play",onPlay),videoElement.removeEventListener("pause",onPause)}):function(){}}),[onPlay,onPause,videoElement]),(0,react.useEffect)((function(){var _videoPlayback$latest,_videoPlayback$latest2;"no-video"===(null===(_videoPlayback$latest=videoPlayback.latestCommand)||void 0===_videoPlayback$latest||null===(_videoPlayback$latest2=_videoPlayback$latest.command)||void 0===_videoPlayback$latest2?void 0:_videoPlayback$latest2.type)&&onPause()}),[null===(_videoPlayback$latest3=videoPlayback.latestCommand)||void 0===_videoPlayback$latest3?void 0:_videoPlayback$latest3.command]);var videoEl=(0,react.useMemo)((function(){var _videoPlayback$video;return(0,jsx_runtime.jsx)("video",{ref:videoRef,src:null===(_videoPlayback$video=videoPlayback.video)||void 0===_videoPlayback$video?void 0:_videoPlayback$video.url})}),[null===(_videoPlayback$video2=videoPlayback.video)||void 0===_videoPlayback$video2?void 0:_videoPlayback$video2.url,videoRef]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[videoPlayback.errors.parseBlobError||videoPlayback.errors.queryError||videoPlayback.errors.parseBlobError?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),"Could not load video"]}):void 0,"video"===(null===(_videoPlayback$latest4=videoPlayback.latestCommand)||void 0===_videoPlayback$latest4?void 0:_videoPlayback$latest4.command.type)?(0,jsx_runtime.jsx)(VideoAspectWrapper.b,{children:function children(){var _videoPlayback$video3;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{position:"relative",h:"100%",w:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_skeleton_esm.Od,{isLoaded:Boolean(null===(_videoPlayback$video3=videoPlayback.video)||void 0===_videoPlayback$video3?void 0:_videoPlayback$video3.url),position:"relative",children:videoEl}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{p:2,position:"absolute",bottom:"0px",left:"0px",width:"100%",alignItems:"stretch",children:[videoPlayback.canControlPlaybackAs.size?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:playing?"Pause":"Play",children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":playing?"Pause video":"Play video",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:playing?"pause":"play"}),isDisabled:ended||disableControls,onClick:function onClick(){var _videoPlayback$latest5,_videoPlayback$latest6;temporarilyDisableControls(),videoElement&&"video"===(null===(_videoPlayback$latest5=videoPlayback.latestCommand)||void 0===_videoPlayback$latest5||null===(_videoPlayback$latest6=_videoPlayback$latest5.command)||void 0===_videoPlayback$latest6?void 0:_videoPlayback$latest6.type)&&videoPlayback.sendCommand({type:"video",currentTimeSeconds:videoElement.currentTime,elementId:videoPlayback.latestCommand.command.elementId,playing:!playing,volume:videoPlayback.latestCommand.command.volume})}})}),(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{isAttached:!0,children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Skip backward 15s",children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Skip backward 15s in video",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ArrowLeftIcon,{}),isDisabled:disableControls,onClick:function onClick(){var _videoPlayback$latest7,_videoPlayback$latest8;temporarilyDisableControls(),videoElement&&"video"===(null===(_videoPlayback$latest7=videoPlayback.latestCommand)||void 0===_videoPlayback$latest7||null===(_videoPlayback$latest8=_videoPlayback$latest7.command)||void 0===_videoPlayback$latest8?void 0:_videoPlayback$latest8.type)&&videoPlayback.sendCommand({type:"video",currentTimeSeconds:Math.max(videoElement.currentTime-15,0),elementId:videoPlayback.latestCommand.command.elementId,playing,volume:videoPlayback.latestCommand.command.volume})}})}),(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Skip forward 15s",children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Skip forward 15s in video",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ArrowRightIcon,{}),isDisabled:disableControls,onClick:function onClick(){var _videoPlayback$latest9,_videoPlayback$latest10;temporarilyDisableControls(),videoElement&&"video"===(null===(_videoPlayback$latest9=videoPlayback.latestCommand)||void 0===_videoPlayback$latest9||null===(_videoPlayback$latest10=_videoPlayback$latest9.command)||void 0===_videoPlayback$latest10?void 0:_videoPlayback$latest10.type)&&videoPlayback.sendCommand({type:"video",currentTimeSeconds:Math.max(videoElement.currentTime+15,0),elementId:videoPlayback.latestCommand.command.elementId,playing,volume:videoPlayback.latestCommand.command.volume})}})})]})]}):void 0,(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{size:"lg",children:(0,jsx_runtime.jsxs)(chakra_ui_tag_esm.Sn,{children:[luxon.nL.fromMillis(1e3*currentTime).toFormat("hh:mm:ss"),isNaN(duration)?"":" / "+luxon.nL.fromMillis(1e3*duration).toFormat("hh:mm:ss")]})}),(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"volume-down",color:"white",w:"max-content",display:"flex",flexDirection:"column",justifyContent:"center"}),(0,jsx_runtime.jsxs)(chakra_ui_slider_esm.iR,{"aria-label":"Volume slider",defaultValue:.5,max:1,min:0,step:.05,w:"4em",maxW:"30%",onChange:function onChange(val){return setVolume(val)},children:[(0,jsx_runtime.jsx)(chakra_ui_slider_esm.Uj,{children:(0,jsx_runtime.jsx)(chakra_ui_slider_esm.Ms,{})}),(0,jsx_runtime.jsx)(chakra_ui_slider_esm.gs,{})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.LZ,{}),autoplay.autoplayBlocked?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Video playback is not enabled. Click for more details.",children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{colorScheme:"red","aria-label":"Video playback is not enabled. Click for more details.",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.WarningIcon,{}),isDisabled:ended||disableControls,onClick:function onClick(){autoplay.setAutoplayAlertDismissed(!1)}})}):void 0,videoPlayback.canControlPlaybackAs.size?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Close video",children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{ml:"auto","aria-label":"Close video",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.CloseIcon,{}),isDisabled:disableControls,onClick:function onClick(){var _videoPlayback$latest11,_videoPlayback$latest12;temporarilyDisableControls(),videoElement&&"video"===(null===(_videoPlayback$latest11=videoPlayback.latestCommand)||void 0===_videoPlayback$latest11||null===(_videoPlayback$latest12=_videoPlayback$latest11.command)||void 0===_videoPlayback$latest12?void 0:_videoPlayback$latest12.type)&&videoPlayback.sendCommand({type:"no-video"})}})}):void 0]})]})}}):void 0]})}function InCall_toConsumableArray(arr){return function InCall_arrayWithoutHoles(arr){if(Array.isArray(arr))return InCall_arrayLikeToArray(arr)}(arr)||function InCall_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||InCall_unsupportedIterableToArray(arr)||function InCall_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function InCall_slicedToArray(arr,i){return function InCall_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function InCall_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||InCall_unsupportedIterableToArray(arr,i)||function InCall_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function InCall_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=InCall_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function InCall_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return InCall_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?InCall_arrayLikeToArray(o,minLen):void 0}}function InCall_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function InCall(){var _videoPlayback$latest,_videoPlayback$latest2,registrant=(0,useCurrentRegistrant.ZP)(),_useVonageRoom=(0,VonageRoomProvider.xI)(),state=_useVonageRoom.state,settings=_useVonageRoom.settings,_useContext=(0,react.useContext)(VonageComputedStateContext),camera=_useContext.camera,connected=_useContext.connected,connections=_useContext.connections,streams=_useContext.streams,screen=_useContext.screen,vonage=_useContext.vonage,_useVonageLayout=useVonageLayout(),_useVonageLayout$layo=_useVonageLayout.layout,setAvailableStreams=_useVonageLayout$layo.setAvailableStreams,refetchLayout=_useVonageLayout$layo.refetchLayout,display=_useVonageLayout.display,userId=(0,Auth.II)(),registrantIdSpecs=(0,react.useMemo)((function(){return connections.map((function(connection){try{var data=JSON.parse(connection.data);return data.registrantId&&(0,validate.Z)(data.registrantId)?{registrant:data.registrantId}:null}catch(e){return console.warn("Couldn't parse registrant ID from Vonage subscriber data",connection.data),null}})).filter((function(x){return!!x}))}),[connections]),registrants=(0,RegistrantsContext.CW)(registrantIdSpecs);(0,react.useEffect)((function(){var _vonage$state$session,result=[];if(vonage.state.type===VonageGlobalState.Yk.Connected&&(null!==(_vonage$state$session=vonage.state.session)&&void 0!==_vonage$state$session&&_vonage$state$session.connection)){var _screen$stream,_camera$stream;if(null!=screen&&screen.stream&&screen.stream.hasVideo)result.push({connectionId:vonage.state.session.connection.connectionId,streamId:null===(_screen$stream=screen.stream)||void 0===_screen$stream?void 0:_screen$stream.streamId,type:"screen",registrantName:registrant.displayName});if(null!=camera&&camera.stream&&camera.stream.hasVideo)result.push({connectionId:vonage.state.session.connection.connectionId,streamId:null==camera||null===(_camera$stream=camera.stream)||void 0===_camera$stream?void 0:_camera$stream.streamId,type:"camera",registrantName:registrant.displayName})}var _step,_iterator=InCall_createForOfIteratorHelper(streams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var stream=_step.value;stream.hasVideo&&function(){var _registrants$find,_stream$videoType,registrantId=void 0;try{var data=JSON.parse(stream.connection.data);registrantId=data.registrantId&&(0,validate.Z)(data.registrantId)?data.registrantId:void 0}catch(_unused){}result.push({connectionId:stream.connection.connectionId,streamId:stream.streamId,registrantName:registrantId?null===(_registrants$find=registrants.find((function(reg){return reg.id===registrantId})))||void 0===_registrants$find?void 0:_registrants$find.displayName:void 0,type:null!==(_stream$videoType=stream.videoType)&&void 0!==_stream$videoType?_stream$videoType:"camera"})}()}}catch(err){_iterator.e(err)}finally{_iterator.f()}setAvailableStreams(result)}),[connections,setAvailableStreams,registrants,streams,userId,vonage.state,null==screen?void 0:screen.stream,null==camera?void 0:camera.stream,registrant.displayName]);var screenPortalNode=react.useMemo((function(){return web.oD()}),[]),cameraPortalNode=react.useMemo((function(){return web.oD()}),[]),_React$useState2=InCall_slicedToArray(react.useState(new Map),2),streamPortalNodes=_React$useState2[0],setStreamPortalNodes=_React$useState2[1],_React$useState4=InCall_slicedToArray(react.useState(new Map),2),connectionPortalNodes=_React$useState4[0],setConnectionPortalNodes=_React$useState4[1],streamActivities=(0,react.useMemo)((function(){return new Map}),[]),viewports=(0,react.useMemo)((function(){var result=[],streamPortalNodesResult=new Map(streamPortalNodes),connectionPortalNodesResult=new Map(connectionPortalNodes);if(vonage.state.type===VonageGlobalState.Yk.Connected){if(vonage.state.session){var connection=vonage.state.session.connection;if(connection){var _camera$stream2,_camera$stream$creati,_camera$stream3,_screen$stream2,_screen$stream$creati,_screen$stream3;if(null!=screen&&screen.stream)result.push({connectionId:connection.connectionId,streamId:null==screen||null===(_screen$stream2=screen.stream)||void 0===_screen$stream2?void 0:_screen$stream2.streamId,associatedIds:null!=camera&&camera.stream?[connection.connectionId,camera.stream.streamId]:[connection.connectionId],type:"screen",joinedAt:null!==(_screen$stream$creati=null==screen||null===(_screen$stream3=screen.stream)||void 0===_screen$stream3?void 0:_screen$stream3.creationTime)&&void 0!==_screen$stream$creati?_screen$stream$creati:connection.creationTime,isSelf:!0,component:screenPortalNode});result.push({connectionId:connection.connectionId,streamId:null==camera||null===(_camera$stream2=camera.stream)||void 0===_camera$stream2?void 0:_camera$stream2.streamId,associatedIds:null!=screen&&screen.stream?[connection.connectionId,screen.stream.streamId]:[connection.connectionId],type:"camera",joinedAt:null!==(_camera$stream$creati=null==camera||null===(_camera$stream3=camera.stream)||void 0===_camera$stream3?void 0:_camera$stream3.creationTime)&&void 0!==_camera$stream$creati?_camera$stream$creati:connection.creationTime,isSelf:!0,component:cameraPortalNode})}}var _step2,_loop=function _loop(stream){var _stream$videoType2,portalNode=streamPortalNodesResult.get(stream.streamId);if(!portalNode){var node=web.oD(),activityRef=react.createRef();streamActivities.set(stream.streamId,activityRef),portalNode={node,element:(0,jsx_runtime.jsx)(web.Nq,{node,children:(0,jsx_runtime.jsx)(CameraViewport,{stream,connection:stream.connection,isTalkingRef:activityRef})},stream.streamId)},streamPortalNodesResult.set(stream.streamId,portalNode)}result.push({connectionId:stream.connection.connectionId,streamId:stream.streamId,associatedIds:[stream.connection.connectionId].concat(InCall_toConsumableArray(streams.filter((function(x){return x.connection.connectionId===stream.connection.connectionId&&x!==stream})).map((function(x){return x.streamId})))),type:null!==(_stream$videoType2=stream.videoType)&&void 0!==_stream$videoType2?_stream$videoType2:"camera",joinedAt:stream.creationTime,isSelf:!1,component:portalNode.node})},_iterator2=InCall_createForOfIteratorHelper(streams);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){_loop(_step2.value)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var _step3,_loop2=function _loop2(_connection){if(userId&&!_connection.data.includes(userId)&&!streams.find((function(stream){return stream.connection.connectionId===_connection.connectionId&&(!stream.videoType||"camera"===stream.videoType)}))){var portalNode=connectionPortalNodesResult.get(_connection.connectionId);if(!portalNode){var node=web.oD();portalNode={node,element:(0,jsx_runtime.jsx)(web.Nq,{node,children:(0,jsx_runtime.jsx)(CameraViewport,{connection:_connection})},_connection.connectionId)},connectionPortalNodesResult.set(_connection.connectionId,portalNode)}result.push({connectionId:_connection.connectionId,associatedIds:[_connection.connectionId].concat(InCall_toConsumableArray(streams.filter((function(x){return x.connection.connectionId===_connection.connectionId})).map((function(x){return x.streamId})))),type:"camera",joinedAt:_connection.creationTime,isSelf:!1,component:portalNode.node})}},_iterator3=InCall_createForOfIteratorHelper(connections);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){_loop2(_step3.value)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}return setStreamPortalNodes(streamPortalNodesResult),setConnectionPortalNodes(connectionPortalNodesResult),result}),[vonage.state,null==screen?void 0:screen.stream,null==camera?void 0:camera.stream,cameraPortalNode,screenPortalNode,streams,streamActivities,connections,userId]);(0,react.useEffect)((function(){var _step4,_loop3=function _loop3(streamId){streams.some((function(stream){return stream.streamId===streamId}))||streamPortalNodes.delete(streamId)},_iterator4=InCall_createForOfIteratorHelper(streamPortalNodes.keys());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){_loop3(_step4.value)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var _step5,_loop4=function _loop4(connectionId){connections.some((function(connection){return connection.connectionId===connectionId}))||connectionPortalNodes.delete(connectionId)},_iterator5=InCall_createForOfIteratorHelper(connectionPortalNodes.keys());try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){_loop4(_step5.value)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}),[streams,connections,streamPortalNodes,connectionPortalNodes]),(0,react.useEffect)((function(){connected&&refetchLayout()}),[connected]);var displayEl=(0,react.useMemo)((function(){switch(display.actualDisplay.type){case DisplayType.Browse:return(0,jsx_runtime.jsx)(Browse,{streamActivities,viewports});case DisplayType.BroadcastLayout:return(0,jsx_runtime.jsx)(Layout,{viewports,allowedToControlLayout:Boolean(settings.canControlRecordingAs.size)})}}),[display.actualDisplay.type,settings.canControlRecordingAs,streamActivities,viewports]),videoPlayback=(0,react.useContext)(VonageVideoPlaybackContext);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[connected?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{flexDirection:"column",h:"100%",w:"100%",zIndex:1,alignItems:"stretch",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{flexDirection:"column",w:"100%",zIndex:1,alignItems:"stretch",flex:1,overflowY:"auto",children:["video"===(null===(_videoPlayback$latest=videoPlayback.latestCommand)||void 0===_videoPlayback$latest||null===(_videoPlayback$latest2=_videoPlayback$latest.command)||void 0===_videoPlayback$latest2?void 0:_videoPlayback$latest2.type)?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flexBasis:0,flexGrow:1.5,flexShrink:1,minH:"10em",w:"100%",p:2,children:(0,jsx_runtime.jsx)(VideoChatVideoPlayer,{})}):void 0,(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{flexDirection:"column",flexBasis:0,flexGrow:1,flexShrink:1,minH:"10em",w:"100%",children:displayEl})]}),(0,jsx_runtime.jsx)(VonageRoomControlBar,{})]}):void 0,InCall_toConsumableArray(streamPortalNodes.values()).map((function(x){return x.element})),InCall_toConsumableArray(connectionPortalNodes.values()).map((function(x){return x.element})),(0,jsx_runtime.jsx)(web.Nq,{node:screenPortalNode,children:(0,jsx_runtime.jsx)(SelfScreenComponent,{connected,state,vonage,registrantId:registrant.id,screen})}),(0,jsx_runtime.jsx)(web.Nq,{node:cameraPortalNode,children:(0,jsx_runtime.jsx)(SelfCameraComponent,{connected,state,vonage,registrantId:registrant.id,isBackstageRoom:settings.isBackstageRoom})})]})}var VonageRoom_templateObject,ahana_fp_lib=__webpack_require__("../node_modules/.pnpm/@ahanapediatrics+ahana-fp@2.6.0/node_modules/@ahanapediatrics/ahana-fp/lib/index.js"),dist=__webpack_require__("../node_modules/.pnpm/@ahanapediatrics+react-volume-meter@5.9.0_1cdbadec2b4667c83f11b0407fa7fc39/node_modules/@ahanapediatrics/react-volume-meter/dist/index.js"),cachedAudioContext=null;function PreJoin(_ref){var cameraPreviewRef=_ref.cameraPreviewRef,state=(0,VonageRoomProvider.xI)().state,cancelJoin=(0,react.useContext)(VonageComputedStateContext).cancelJoin,toast=(0,chakra_ui_toast_esm.pm)(),audioContext=(0,chakra_ui_hooks_esm.Bs)(function getAudioContext(){var AudioContextConstructor=window.AudioContext||window.webkitAudioContext;if(!AudioContextConstructor)return null;if(cachedAudioContext)return cachedAudioContext;try{return cachedAudioContext=new AudioContextConstructor}catch(err){return console.error("Failed to instantiate AudioContext",err),null}}());return(0,react.useEffect)((function(){if(!cameraPreviewRef.current)throw new Error("Failed to start camera: element missing");cameraPreviewRef.current.srcObject=state.cameraStream}),[cameraPreviewRef,state.cameraStream,toast]),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{w:"100%",h:"100%",alignItems:"center",justifyContent:"center",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{position:"relative",my:4,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{position:"absolute",width:"100%",height:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{position:"absolute",width:"100%",height:"100%",bgColor:"black",bgImage:resources.N,bgRepeat:"no-repeat",bgSize:"auto 76%",bgPos:"center bottom",opacity:"0.25"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{position:"absolute",w:"100%",h:"100%",top:"0",left:"0",children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{bgColor:"rgba(0,0,0,0.5)",p:4,fontSize:"lg",color:"white",whiteSpace:"normal",children:"Your camera is not switched on."})})]}),(0,jsx_runtime.jsx)("video",{ref:cameraPreviewRef,autoPlay:!0,style:{border:"1px solid gray",height:"300px",width:"300px",objectFit:"cover",transform:"rotateY(180deg)",opacity:state.cameraIntendedEnabled?"1":"0"}}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Ug,{position:"absolute",bottom:"10px",right:"20px",w:"auto",h:"min-content",children:state.microphoneStream&&state.microphoneStream.getAudioTracks().some((function(track){return track.enabled&&"live"===track.readyState}))?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[audioContext?(0,jsx_runtime.jsx)(dist.VolumeMeter,{audioContext,height:25,width:50,shape:dist.VmShape.VM_FLAT,stream:ahana_fp_lib.Optional.of(state.microphoneStream),blocks:10}):void 0,(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.div,{w:"2rem",h:"2rem",bgColor:"rgba(50,50,50,0.8)",borderRadius:"50%",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"volume-up",fixedWidth:!0,fontSize:"lg",color:"white",__css:{textAlign:"center",display:"block",w:"100%",h:"100%",i:{verticalAlign:"middle"}},borderRadius:"50%"})})]}):(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.div,{w:"2rem",h:"2rem",bgColor:"rgba(50,50,50,0.8)",borderRadius:"50%",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"volume-mute",fixedWidth:!0,fontSize:"lg",color:"white",__css:{textAlign:"center",display:"block",w:"100%",h:"100%",i:{verticalAlign:"middle"}},borderRadius:"50%"})})})]}),(0,jsx_runtime.jsx)(VonageRoomControlBar,{onCancelJoinRoom:cancelJoin})]})}PreJoin.displayName="PreJoin";try{PreJoin.displayName="PreJoin",PreJoin.__docgenInfo={description:"",displayName:"PreJoin",props:{cameraPreviewRef:{defaultValue:null,description:"",name:"cameraPreviewRef",required:!0,type:{name:"RefObject<HTMLVideoElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/PreJoin.tsx#PreJoin"]={docgenInfo:PreJoin.__docgenInfo,name:"PreJoin",path:"src/aspects/Conference/Attend/Room/Vonage/PreJoin.tsx#PreJoin"})}catch(__react_docgen_typescript_loader_error){}function VonageRoomInner(_ref){var stop=_ref.stop,cameraPreviewRef=(0,react.useRef)(null),_useVonageRoom=(0,VonageRoomProvider.xI)(),state=_useVonageRoom.state,dispatch=_useVonageRoom.dispatch,_useContext=(0,react.useContext)(VonageComputedStateContext),connected=_useContext.connected,joining=_useContext.joining,leaveRoom=_useContext.leaveRoom,uiEl=(0,react.useMemo)((function(){return connected?(0,jsx_runtime.jsx)(InCall,{}):(0,jsx_runtime.jsx)(PreJoin,{cameraPreviewRef})}),[connected]);return(0,react.useEffect)((function(){if(stop)leaveRoom().catch((function(e){return console.error("Failed to leave Vonage room",e)})),dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!1,explicitlyDisabled:state.microphoneExplicitlyDisabled,onError:void 0}),dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!1,explicitlyDisabled:state.cameraExplicitlyDisabled,onError:void 0});else if(!connected&&!joining){var _state$cameraStream,_state$microphoneStre;!state.cameraExplicitlyDisabled&&null!==(_state$cameraStream=state.cameraStream)&&void 0!==_state$cameraStream&&_state$cameraStream.getVideoTracks().some((function(t){return"live"===t.readyState}))&&dispatch({type:VonageRoomProvider.XX.SetCameraIntendedState,cameraEnabled:!0,onError:function onError(){dispatch({type:VonageRoomProvider.XX.SetCameraMediaStream,mediaStream:"disabled"})}}),!state.microphoneExplicitlyDisabled&&null!==(_state$microphoneStre=state.microphoneStream)&&void 0!==_state$microphoneStre&&_state$microphoneStre.getAudioTracks().some((function(t){return"live"===t.readyState}))&&dispatch({type:VonageRoomProvider.XX.SetMicrophoneIntendedState,microphoneEnabled:!0,onError:function onError(){dispatch({type:VonageRoomProvider.XX.SetMicrophoneMediaStream,mediaStream:"disabled"})}})}}),[stop]),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{w:"100%",h:"100%",isolation:"isolate",children:[(0,jsx_runtime.jsx)(AutoplayAlert,{connected}),(0,jsx_runtime.jsx)(RecordingAlert,{}),uiEl]})}VonageRoomInner.displayName="VonageRoomInner";try{VonageRoomInner.displayName="VonageRoomInner",VonageRoomInner.__docgenInfo={description:"",displayName:"VonageRoomInner",props:{stop:{defaultValue:null,description:"",name:"stop",required:!0,type:{name:"boolean"}},cancelJoin:{defaultValue:null,description:"",name:"cancelJoin",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VonageRoomInner.tsx#VonageRoomInner"]={docgenInfo:VonageRoomInner.__docgenInfo,name:"VonageRoomInner",path:"src/aspects/Conference/Attend/Room/Vonage/VonageRoomInner.tsx#VonageRoomInner"})}catch(__react_docgen_typescript_loader_error){}function VonageRoom_slicedToArray(arr,i){return function VonageRoom_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VonageRoom_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VonageRoom_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VonageRoom_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VonageRoom_arrayLikeToArray(o,minLen)}(arr,i)||function VonageRoom_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VonageRoom_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function VonageRoom(_ref){var roomId=_ref.roomId,eventId=_ref.eventId,vonageSessionId=_ref.vonageSessionId,getAccessToken=_ref.getAccessToken,disable=_ref.disable,isBackstageRoom=_ref.isBackstageRoom,raiseHandPrejoinEventId=_ref.raiseHandPrejoinEventId,isRaiseHandWaiting=_ref.isRaiseHandWaiting,_ref$requireMicrophon=_ref.requireMicrophoneOrCamera,requireMicrophoneOrCamera=void 0!==_ref$requireMicrophon&&_ref$requireMicrophon,completeJoinRef=_ref.completeJoinRef,completeGetAccessToken=_ref.completeGetAccessToken,onLeave=_ref.onLeave,canControlRecordingAs=_ref.canControlRecordingAs,eventIsFuture=_ref.eventIsFuture,extraLayoutButtons=_ref.extraLayoutButtons,mRegistrant=(0,useCurrentRegistrant.oC)(),location=(0,react_router.TH)(),locationParts=(location.pathname.startsWith("/")?location.pathname.substr(1):location.pathname).split("/"),roomCouldBeInUse="conference"===locationParts[0]&&"room"===locationParts[2],raiseHand=(0,RaiseHandProvider.kH)(),deleteEventParticipant=VonageRoom_slicedToArray((0,graphql.pqN)(),2)[1],onPermissionsProblem=(0,react.useContext)(PermissionInstructionsContext.U).onPermissionsProblem,saveVonageRoomRecording=VonageRoom_slicedToArray((0,graphql.xHv)(),2)[1],onRecordingIdReceived=(0,react.useCallback)((function(recordingId){mRegistrant&&saveVonageRoomRecording({recordingId,registrantId:mRegistrant.id})}),[mRegistrant,saveVonageRoomRecording]),cancelJoin=(0,react.useMemo)((function(){return isBackstageRoom&&raiseHandPrejoinEventId?function(){raiseHandPrejoinEventId&&raiseHand.lower(raiseHandPrejoinEventId)}:void 0}),[isBackstageRoom,raiseHand,raiseHandPrejoinEventId]),roomType=(0,react.useMemo)((function(){return roomId?eventId&&!eventIsFuture?{type:"room-with-event",roomId,eventId}:{type:"room",id:roomId}:eventId?{type:"event",id:eventId}:null}),[eventId,eventIsFuture,roomId]);return mRegistrant?(0,jsx_runtime.jsx)(VonageRoomProvider.Yh,{onPermissionsProblem,isBackstageRoom,canControlRecordingAs,joinRoomButtonText:isBackstageRoom?raiseHandPrejoinEventId?"I'm ready":"Connect to the backstage":void 0,joiningRoomButtonText:void 0,requireMicrophoneOrCamera,completeGetAccessToken,eventIsFuture,eventId:null!=eventId?eventId:void 0,roomId:null!=roomId?roomId:void 0,extraLayoutButtons:null!=extraLayoutButtons?extraLayoutButtons:void 0,children:(0,jsx_runtime.jsx)(ChatProfileModalProvider.Z,{children:(0,jsx_runtime.jsx)(VonageComputedStateProvider,{getAccessToken,vonageSessionId,overrideJoining:!!(isBackstageRoom&&raiseHandPrejoinEventId&&isRaiseHandWaiting)||void 0,beginJoin:isBackstageRoom&&raiseHandPrejoinEventId?function(){raiseHandPrejoinEventId&&raiseHand.raise(raiseHandPrejoinEventId)}:void 0,completeJoinRef,onRoomJoined:isBackstageRoom&&eventId?function(joined){joined||(eventId&&deleteEventParticipant({eventId,registrantId:mRegistrant.id}),null==onLeave||onLeave())}:void 0,cancelJoin,onRecordingIdReceived,children:(0,jsx_runtime.jsx)(VonageLayoutProvider,{vonageSessionId,type:roomType,canControlRecordingAs,children:(0,jsx_runtime.jsx)(AutoplayProvider,{children:(0,jsx_runtime.jsx)(VonageVideoPlaybackProvider,{vonageSessionId,canControlPlaybackAs:canControlRecordingAs,children:(0,jsx_runtime.jsx)(VonageRoomInner,{stop:!roomCouldBeInUse||disable})})})})})})}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}(0,urql_core.Ps)(VonageRoom_templateObject||(VonageRoom_templateObject=function VonageRoom_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    mutation DeleteEventParticipant($eventId: uuid!, $registrantId: uuid!) {\n        delete_schedule_EventProgramPerson(\n            where: {\n                eventId: { _eq: $eventId }\n                person: { registrantId: { _eq: $registrantId } }\n                roleName: { _eq: PARTICIPANT }\n            }\n        ) {\n            returning {\n                id\n            }\n        }\n    }\n\n    mutation SaveVonageRoomRecording($recordingId: uuid!, $registrantId: uuid!) {\n        insert_registrant_SavedVonageRoomRecording_one(\n            object: { recordingId: $recordingId, registrantId: $registrantId }\n            on_conflict: { constraint: SavedVonageRoomRecording_recordingId_registrantId_key, update_columns: [] }\n        ) {\n            id\n            recordingId\n            registrantId\n            isHidden\n        }\n    }\n"])));try{VonageRoom.displayName="VonageRoom",VonageRoom.__docgenInfo={description:"",displayName:"VonageRoom",props:{roomId:{defaultValue:null,description:"",name:"roomId",required:!0,type:{name:"string | null"}},eventId:{defaultValue:null,description:"",name:"eventId",required:!0,type:{name:"string | null"}},vonageSessionId:{defaultValue:null,description:"",name:"vonageSessionId",required:!0,type:{name:"string"}},getAccessToken:{defaultValue:null,description:"",name:"getAccessToken",required:!0,type:{name:"() => Promise<string>"}},disable:{defaultValue:null,description:"",name:"disable",required:!0,type:{name:"boolean"}},isBackstageRoom:{defaultValue:null,description:"",name:"isBackstageRoom",required:!0,type:{name:"boolean"}},raiseHandPrejoinEventId:{defaultValue:null,description:"",name:"raiseHandPrejoinEventId",required:!0,type:{name:"string | null"}},isRaiseHandWaiting:{defaultValue:null,description:"",name:"isRaiseHandWaiting",required:!1,type:{name:"boolean"}},requireMicrophoneOrCamera:{defaultValue:{value:"false"},description:"",name:"requireMicrophoneOrCamera",required:!1,type:{name:"boolean"}},completeJoinRef:{defaultValue:null,description:"",name:"completeJoinRef",required:!1,type:{name:"MutableRefObject<() => Promise<void>>"}},completeGetAccessToken:{defaultValue:null,description:"",name:"completeGetAccessToken",required:!1,type:{name:"CompleteGetAccessToken | null"}},onLeave:{defaultValue:null,description:"",name:"onLeave",required:!1,type:{name:"(() => void)"}},canControlRecordingAs:{defaultValue:null,description:"",name:"canControlRecordingAs",required:!0,type:{name:"Set<RecordingControlReason>"}},layout:{defaultValue:null,description:"",name:"layout",required:!1,type:{name:"VonageBroadcastLayout"}},eventIsFuture:{defaultValue:null,description:"",name:"eventIsFuture",required:!1,type:{name:"boolean"}},extraLayoutButtons:{defaultValue:null,description:"",name:"extraLayoutButtons",required:!1,type:{name:"Element"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Attend/Room/Vonage/VonageRoom.tsx#VonageRoom"]={docgenInfo:VonageRoom.__docgenInfo,name:"VonageRoom",path:"src/aspects/Conference/Attend/Room/Vonage/VonageRoom.tsx#VonageRoom"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/Conference/Attend/Room/VideoChat/images/chrome-permissions.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"static/media/chrome-permissions.737aeca2.png"},"./src/aspects/Conference/Attend/Room/VideoChat/images/chrome-screenshare.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"static/media/chrome-screenshare.9844ffa0.png"},"./src/aspects/Conference/Attend/Room/VideoChat/images/firefox-permissions.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"static/media/firefox-permissions.3138caf6.png"},"./src/aspects/Conference/Attend/Room/VideoChat/images/safari-permissions.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"static/media/safari-permissions.6631699f.png"}}]);